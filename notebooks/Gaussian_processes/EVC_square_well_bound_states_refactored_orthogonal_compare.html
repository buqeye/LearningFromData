
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>EVC for bound-state square well compared to orthogonal &#8212; Learning from data</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.e8e5499552300ddf5d7adccae7cc3b70.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script>window.MathJax = {"tex": {"macros": {"N": ["\\mathbb{N}"], "Z": ["\\mathbb{Z}"], "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"], "alphavec": ["\\boldsymbol{\\alpha}"], "muvec": ["\\boldsymbol{\\mu}"], "phivec": ["\\boldsymbol{\\phi}"], "sigmavec": ["\\boldsymbol{\\sigma}"], "Sigmavec": ["\\boldsymbol{\\Sigma}"], "thetavec": ["\\boldsymbol{\\theta}"], "thetavechat": ["\\widehat\\thetavec"], "avec": ["\\boldsymbol{a}"], "Bvec": ["\\boldsymbol{B}"], "fvec": ["\\boldsymbol{f}"], "mvec": ["\\boldsymbol{m}"], "qvec": ["\\boldsymbol{q}"], "rvec": ["\\boldsymbol{r}"], "uvec": ["\\boldsymbol{u}"], "wvec": ["\\boldsymbol{w}"], "xvec": ["\\boldsymbol{x}"], "yvec": ["\\boldsymbol{y}"], "Lra": ["\\Longrightarrow"], "abar": ["\\overline a"], "Xbar": ["\\overline X"], "alphahat": ["\\widehat\\alpha"], "Hhat": ["\\hat H"], "yth": ["y_{\\text{th}}"], "yexp": ["y_{\\text{exp}}"], "ym": ["y_{\\text{m}}"], "gs": ["{0}"]}}}</script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      <img src="../../_static/8820_icon.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Learning from data</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../about.html">
   About this Jupyter Book
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Course overview
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/Course/overview.html">
   Objectives
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Topics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Basics/basics.html">
   1. Basics of Bayesian statistics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Basics/lecture_01.html">
     1.1. Lecture 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Basics/Exploring_pdfs.html">
     1.2. Exploring PDFs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Basics/simple_sum_product_rule.html">
     1.3. Checking the sum and product rules, and their consequences
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Basics/lecture_02.html">
     1.4. Lecture 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Basics/Bayesian_updating_coinflip_interactive.html">
     1.5. Interactive Bayesian updating: coin flipping example
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Basics/medical_example_by_Bayes.html">
     1.6. Standard medical example by applying Bayesian rules of probability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Basics/radioactive_lighthouse_exercise.html">
     1.7. Radioactive lighthouse problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Basics/lecture_03.html">
     1.8. Lecture 3
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Parameter_estimation/param_est.html">
   2. Bayesian parameter estimation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Parameter_estimation/lecture_04.html">
     2.1. Lecture 4: Parameter estimation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Parameter_estimation/parameter_estimation_Gaussian_noise.html">
     2.2. Parameter estimation example: Gaussian noise and averages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/Assignment_extending_radioactive_lighthouse.html">
     2.3. Assignment: 2D radioactive lighthouse location using MCMC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Parameter_estimation/lecture_05.html">
     2.4. Lecture 5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Parameter_estimation/parameter_estimation_fitting_straight_line_I.html">
     2.5. Parameter estimation example: fitting a straight line
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Parameter_estimation/demo-ModelValidation.html">
     2.6. Linear Regression and Model Validation demonstration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Parameter_estimation/lecture_06.html">
     2.7. Lecture 6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Parameter_estimation/amplitude_in_presence_of_background.html">
     2.8. Amplitude of a signal in the presence of background
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/Assignment_parameter_estimation_followups.html">
     2.9. Assignment: Follow-ups to Parameter Estimation notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Parameter_estimation/exercise_LinearRegression.html">
     2.10. Linear Regression exercise
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Parameter_estimation/linear_algebra_games_I.html">
     2.11. Linear algebra games including SVD for PCA
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../assignments/fluctuation_trend_with_number_of_points_and_data_errors.html">
     2.12. Follow-up: fluctuation trends with # of points and data errors
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/MCMC_sampling_I/MCMC_sampling_I.html">
   3. MCMC sampling I
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/MCMC_sampling_I/lecture_07.html">
     3.1. Lecture 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MCMC_sampling_I/Metropolis_Poisson_example.html">
     3.2. Metropolis-Hasting MCMC sampling of a Poisson distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/MCMC_sampling_I/lecture_08.html">
     3.3. Lecture 8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MCMC_sampling_I/MCMC-random-walk-and-sampling.html">
     3.4. Exercise: Random walk
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Why_Bayes_is_better/bayes_is_better.html">
   4. Why Bayes is better
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Why_Bayes_is_better/lecture_09.html">
     4.1. Lecture 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Why_Bayes_is_better/bayes_billiard.html">
     4.2. A Bayesian Billiard game
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Why_Bayes_is_better/lecture_10.html">
     4.3. Lecture 10
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Why_Bayes_is_better/parameter_estimation_fitting_straight_line_II.html">
     4.4. Parameter estimation example: fitting a straight line II
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Why_Bayes_is_better/lecture_11.html">
     4.5. Lecture 11
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Why_Bayes_is_better/error_propagation_to_functions_of_uncertain_parameters.html">
     4.6. Error propagation: Example 3.6.2 in Sivia
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Basics/visualization_of_CLT.html">
     4.7. Visualization of the Central Limit Theorem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Basics/correlation_intuition.html">
     4.8. Building intuition about correlations (and a bit of Python linear algebra)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Why_Bayes_is_better/lecture_12.html">
     4.9. Lecture 12
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MCMC_sampling_I/MCMC-diagnostics.html">
     4.10. Overview: MCMC Diagnostics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Why_Bayes_is_better/lecture_13.html">
     4.12. Lecture 13
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Why_Bayes_is_better/dealing_with_outliers.html">
     4.13. Dealing with outliers
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Model_selection/model_selection.html">
   5. Model selection
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Model_selection/lecture_14.html">
     5.1. Lecture 14
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Model_selection/lecture_15.html">
     5.2. Lecture 15
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Model_selection/Evidence_for_model_EFT_coefficients.html">
     5.3. Evidence calculation for EFT expansions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Model_selection/lecture_16.html">
     5.4. Lecture 16
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mini-projects/MCMC-parallel-tempering_ptemcee.html">
     5.5. Example: Parallel tempering for multimodal distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mini-projects/MCMC-parallel-tempering_ptemcee_vs_zeus.html">
     5.6. Example: Parallel tempering for multimodal distributions vs. zeus
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/MCMC_sampling_II/MCMC_sampling_II.html">
   6. MCMC sampling II
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/MCMC_sampling_II/lecture_17.html">
     6.1. Lecture 17
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MCMC_sampling_II/chi_squared_tests.html">
     6.2. Quick check of the distribution of normal variables squared
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MCMC_sampling_II/Liouville_theorem_visualization.html">
     6.3. Liouville Theorem Visualization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MCMC_sampling_II/Orbital_eqs_with_different_algorithms.html">
     6.4. Solving orbital equations with different algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/MCMC_sampling_II/lecture_18.html">
     6.5. Lecture 18
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MCMC_sampling_II/PyMC3_intro_updated.html">
     6.6. PyMC3 Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../MCMC_sampling_II/PyMC3_docs_getting_started_updated.html">
     6.7. Getting started with PyMC3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Parameter_estimation/parameter_estimation_Gaussian_noise_compare_samplers.html">
     6.8. Comparing samplers for a simple problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../mini-projects/zeus_multimodal.html">
     6.9. zeus: Sampling from multimodal distributions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Gaussian_processes/gaussian_processes.html">
   7. Gaussian processes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Gaussian_processes/lecture_19.html">
     7.1. Lecture 19
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="demo-GaussianProcesses.html">
     7.2. Gaussian processes demonstration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="GaussianProcesses.html">
     7.3. Learning from data: Gaussian processes
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="Gaussian_processes_exercises.html">
     7.4. Exercise: Gaussian Process models with GPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Gaussian_processes/lecture_20.html">
     7.5. Lecture 20
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Maximum_entropy/max_ent.html">
   8. Assigning probabilities
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Maximum_entropy/lecture_21.html">
     8.1. Lecture 21
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Maximum_entropy/MaxEnt.html">
     8.2. Ignorance pdfs: Indifference and translation groups
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Maximum_entropy/Pdfs_from_MaxEnt.html">
     8.3. MaxEnt for deriving some probability distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Maximum_entropy/MaxEnt_Function_Reconstruction.html">
     8.4. Maximum Entropy for reconstructing a function from its moments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Maximum_entropy/demo-MaxEnt.html">
     8.5. Making figures for Ignorance PDF notebook
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Machine_learning/machine_learning.html">
   9. Machine learning: Bayesian methods
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Machine_learning/lecture_22.html">
     9.1. Lecture 22
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Machine_learning/Bayesian_optimization.html">
     9.2. Bayesian Optimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Machine_learning/lecture_23.html">
     9.3. Lecture 23
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Machine_learning/Neural_networks_explained.html">
     9.4. What Are Neural Networks?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Machine_learning/Forssen_tif285_NeuralNet.html">
     9.5. Neural networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Machine_learning/Forssen_tif285_demo-NeuralNet.html">
     9.6. Neural network classifier demonstration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Machine_learning/Bayesian_neural_networks_tif285.html">
     9.7. Bayesian neural networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/Machine_learning/lecture_24.html">
     9.8. Lecture 24
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Machine_learning/demo-Bayesian_neural_networks_tif285.html">
     9.9. Variational Inference: Bayesian Neural Networks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Machine_learning/Convolutional_neural_network_explained.html">
     9.10. What is a convolutional neural network?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/SVD/svd.html">
   10. PCA, SVD, and all that
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../content/SVD/lecture_25.html">
     10.1. Lecture 25
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../SVD/linear_algebra_games_including_SVD.html">
     10.2. Linear algebra games including SVD for PCA
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Mini-projects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mini-projects/mini-project_I_toy_model_of_EFT.html">
   Mini-project I: Parameter estimation for a toy model of an EFT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mini-projects/model-selection_mini-project-IIa.html">
   Mini-project IIa: Model selection basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mini-projects/model-selection_mini-project-IIb_How_many_lines_ptemcee.html">
   Mini-project IIb: How many lines are there?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mini-projects/mini-project_IIIa_bayesian_optimization.html">
   Mini-project IIIa: Bayesian optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mini-projects/mini-project_IIIb_Bayesian_neural_networks_from_demo.html">
   Mini-project IIIb: Bayesian Neural Networks
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Reference material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/zbibliography.html">
   Bibliography
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/related_topics.html">
   Related topics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/Reference/installing_anaconda.html">
   Using Anaconda
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/Reference/using_github.html">
   Using GitHub
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../content/Reference/python_jupyter.html">
   Python and Jupyter notebooks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Jupyter_Python_intro_01.html">
     Python and Jupyter notebooks: part 01
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../Reference/Jupyter_Python_intro_02.html">
     Python and Jupyter notebooks: part 02
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../content/jb_tests.html">
   Examples: Jupyter jb-book
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Notebook keys
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Basics/simple_sum_product_rule_KEY.html">
   Checking the sum and product rules, and their consequences
   <span style="color: red">
    Key
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Basics/medical_example_by_Bayes_KEY.html">
   Standard medical example by applying Bayesian rules of probability
   <span style="color: red">
    Key
   </span>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Basics/radioactive_lighthouse_exercise_key.html">
   Radioactive lighthouse problem
   <span style="color: red">
    Key
   </span>
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/Gaussian_processes/EVC_square_well_bound_states_refactored_orthogonal_compare.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/furnstahl/Physics-8820"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/furnstahl/Physics-8820/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Gaussian_processes/EVC_square_well_bound_states_refactored_orthogonal_compare.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/furnstahl/Physics-8820/main?urlpath=tree/./LectureNotes/notebooks/Gaussian_processes/EVC_square_well_bound_states_refactored_orthogonal_compare.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ell-0">
   <span class="math notranslate nohighlight">
    \(\ell = 0\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   <span class="math notranslate nohighlight">
    \(\ell &gt; 0\)
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#general-set-up">
   General set up
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#harmonic-oscillator-basis-functions">
   Harmonic oscillator basis functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tests">
   Tests
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-that-the-transcendental-function-is-correct">
     Check that the transcendental function is correct
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#check-the-wave-function-for-continuity-and-normalization">
     Check the wave function for continuity and normalization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-expectation-values">
     Test expectation values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#make-some-tables-and-figures">
     Make some tables and figures
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#more-tests">
     More tests
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="evc-for-bound-state-square-well-compared-to-orthogonal">
<h1>EVC for bound-state square well compared to orthogonal<a class="headerlink" href="#evc-for-bound-state-square-well-compared-to-orthogonal" title="Permalink to this headline">¶</a></h1>
<p>Here we do tests of eigenvector continuation (EVC) for the bound states of a square well.</p>
<p>The particular goal here is to compare an orthogonal basis of the same size to an EVC basis.</p>
<p>In this notebook, we compute the eigenvalues <span class="math notranslate nohighlight">\(E_n\)</span> of the potential with <span class="math notranslate nohighlight">\(V = -V_0\)</span> for <span class="math notranslate nohighlight">\(r&lt;R\)</span> and <span class="math notranslate nohighlight">\(V=0\)</span> for <span class="math notranslate nohighlight">\(r&gt;R\)</span>.  The derivation can be found in any graduate and many undergraduate quantum mechanics texts.</p>
<div class="section" id="ell-0">
<h2><span class="math notranslate nohighlight">\(\ell = 0\)</span><a class="headerlink" href="#ell-0" title="Permalink to this headline">¶</a></h2>
<p>The <span class="math notranslate nohighlight">\(\ell=0\)</span> case is quite simple.  Inside the well, the radial function has the form <span class="math notranslate nohighlight">\(u(r) = A \sin(k r)\)</span>, with <span class="math notranslate nohighlight">\(k\)</span> given by</p>
<div class="math notranslate nohighlight">
\[
k = \sqrt{2 \mu (V_0 + E_n)}/\hbar 
\]</div>
<p>while outside the well the radial function has the form <span class="math notranslate nohighlight">\(u(r) = B e^{-\kappa r}\)</span>, with <span class="math notranslate nohighlight">\(\kappa\)</span> given by</p>
<div class="math notranslate nohighlight">
\[
\kappa = \sqrt{-2 \mu E_n} \hbar
\]</div>
<p>In these definitions, <span class="math notranslate nohighlight">\(V_0 &gt; 0\)</span> and <span class="math notranslate nohighlight">\(E_n &lt; 0\)</span>, <span class="math notranslate nohighlight">\(\mu\)</span> is the reduced mass and <span class="math notranslate nohighlight">\(\hbar\)</span> is Planck’s constant divided by <span class="math notranslate nohighlight">\(2\pi\)</span>.   The eigenvalue condition is found by matching the radial wave function and its derivative (or, equivalently, its logarithmic derivative) at <span class="math notranslate nohighlight">\(r = R\)</span>.  This implies that the function <span class="math notranslate nohighlight">\(f(E_n)\)</span>:</p>
<div class="math notranslate nohighlight">
\[
f(E_n) = \kappa/k + 1/\tan(k R)
\]</div>
<p>is zero at eigenvalues <span class="math notranslate nohighlight">\(E_n\)</span>.  We can plot this function to see graphically where the eigenvalues lie and then use routines from <code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code> to get numerical values.</p>
</div>
<div class="section" id="id1">
<h2><span class="math notranslate nohighlight">\(\ell &gt; 0\)</span><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>For <span class="math notranslate nohighlight">\(\ell &gt; 0\)</span>, the interior solution is a Riccati-Bessel function.</p>
</div>
<div class="section" id="general-set-up">
<h2>General set up<a class="headerlink" href="#general-set-up" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">simps</span><span class="p">,</span> <span class="n">quadrature</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>

<span class="kn">from</span> <span class="nn">scipy.linalg</span> <span class="kn">import</span> <span class="n">eig</span><span class="p">,</span> <span class="n">eigh</span>

<span class="kn">from</span> <span class="nn">integration</span> <span class="kn">import</span> <span class="n">Gaussian_quadrature</span><span class="p">,</span> <span class="n">Gaussian_mesh</span>
<span class="kn">from</span> <span class="nn">square_well</span> <span class="kn">import</span> <span class="n">SquareWell</span><span class="p">,</span> <span class="n">rMeshSW</span><span class="p">,</span> <span class="n">rGaussSW</span>
<span class="kn">from</span> <span class="nn">evc</span> <span class="kn">import</span> <span class="n">SW_matrix_element</span><span class="p">,</span> <span class="n">SW_matrix_element_simps</span><span class="p">,</span> <span class="n">SW_matrix_element_gauss</span>
<span class="kn">from</span> <span class="nn">evc</span> <span class="kn">import</span> <span class="n">EigenvectorContinuationScattering</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig_dir</span> <span class="o">=</span> <span class="s1">&#39;figures_bound_states_ortho/&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graphs</span> <span class="kn">import</span> <span class="n">setup_rc_params</span>
<span class="n">setup_rc_params</span><span class="p">(</span><span class="n">presentation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">FormatStrFormatter</span><span class="p">,</span>
                               <span class="n">AutoMinorLocator</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="harmonic-oscillator-basis-functions">
<h2>Harmonic oscillator basis functions<a class="headerlink" href="#harmonic-oscillator-basis-functions" title="Permalink to this headline">¶</a></h2>
<p>We’ll start <code class="docutils literal notranslate"><span class="pre">nHO</span></code> at 0 and take <code class="docutils literal notranslate"><span class="pre">Nmax</span> <span class="pre">=</span> <span class="pre">2n+l</span></code>.  For <code class="docutils literal notranslate"><span class="pre">l=0</span></code>, <code class="docutils literal notranslate"><span class="pre">Nmax</span> <span class="pre">=</span> <span class="pre">0,2,4,6,...</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">factorial</span><span class="p">,</span> <span class="n">assoc_laguerre</span>

<span class="k">def</span> <span class="nf">bHO</span><span class="p">(</span><span class="n">hbarOmega</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># return the HO length scale b given the oscillator</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">mu</span> <span class="o">*</span> <span class="n">hbarOmega</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">normHO</span><span class="p">(</span><span class="n">nHO</span><span class="p">,</span> <span class="n">lHO</span><span class="p">,</span> <span class="n">bHO</span><span class="p">):</span> 
    <span class="c1"># return the normalization constant for an oscillator with nHO and lHO</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">nHO</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">bHO</span> <span class="o">*</span> <span class="n">gamma</span><span class="p">(</span><span class="n">nHO</span> <span class="o">+</span> <span class="n">lHO</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">phiHO</span><span class="p">(</span><span class="n">nHO</span><span class="p">,</span> <span class="n">lHO</span><span class="p">,</span> <span class="n">bHO</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="c1"># return the normalized HO wave function at r</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">r</span> <span class="o">/</span> <span class="n">bHO</span>
    <span class="n">HO_wf</span> <span class="o">=</span> <span class="n">normHO</span><span class="p">(</span><span class="n">nHO</span><span class="p">,</span> <span class="n">lHO</span><span class="p">,</span> <span class="n">bHO</span><span class="p">)</span> <span class="o">*</span> <span class="n">q</span><span class="o">**</span><span class="p">(</span><span class="n">lHO</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> \
             <span class="o">*</span> <span class="n">assoc_laguerre</span><span class="p">(</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">nHO</span><span class="p">,</span> <span class="n">lHO</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HO_wf</span>
</pre></div>
</div>
</div>
</div>
<p>Check normalization</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">normHO</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7757591265663202
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phiHO</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.7057825422215498
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hbarOmega</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">bHO_a</span> <span class="o">=</span> <span class="n">bHO</span><span class="p">(</span><span class="n">hbarOmega</span><span class="p">)</span>
<span class="n">r_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">10.</span><span class="p">,</span><span class="mf">.002</span><span class="p">)</span>
<span class="n">phiHO_0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">phiHO</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">bHO_a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">r_test</span><span class="p">])</span>
<span class="n">phiHO_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">phiHO</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">bHO_a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">r_test</span><span class="p">])</span>
<span class="n">phiHO_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">phiHO</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">bHO_a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">r_test</span><span class="p">])</span>

<span class="n">norm_0</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">r_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">phiHO_0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">norm_1</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">r_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">phiHO_1</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">norm_2</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">r_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">phiHO_2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">orth_02</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">r_test</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">phiHO_0</span><span class="o">*</span><span class="n">phiHO_1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">norm_0</span><span class="p">,</span> <span class="n">norm_1</span><span class="p">,</span> <span class="n">norm_2</span><span class="p">,</span> <span class="n">orth_02</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0000000078175466 1.0000000117261318 1.00000001465743 9.574423227135348e-09
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the zeros to check.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_test</span><span class="p">,</span> <span class="n">phiHO_0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_test</span><span class="p">,</span> <span class="n">phiHO_1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_test</span><span class="p">,</span> <span class="n">phiHO_2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="c1">#ax.set_ylim(-10, 10)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Checking HO basis&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\phi(r)$&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_18_0.png" src="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_18_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">H_ij_HO</span><span class="p">(</span><span class="n">num_terms</span><span class="p">,</span> <span class="n">V0</span><span class="p">,</span> <span class="n">hbarOmega</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Hamiltonian matrix in the HO basis</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bHO_a</span> <span class="o">=</span> <span class="n">bHO</span><span class="p">(</span><span class="n">hbarOmega</span><span class="p">)</span>
    <span class="n">lHO</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">r_mesh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">10.</span><span class="p">,</span><span class="mf">.002</span><span class="p">)</span>
    <span class="n">num_pts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_mesh</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">num_pts</span><span class="p">)</span>

    <span class="n">integrand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_pts</span><span class="p">)</span>
    <span class="n">H_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_terms</span><span class="p">,</span> <span class="n">num_terms</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_terms</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_terms</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">r_mesh</span><span class="p">):</span>
                <span class="n">phi_j</span> <span class="o">=</span> <span class="n">phiHO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">lHO</span><span class="p">,</span> <span class="n">bHO_a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
                <span class="n">phi_i</span> <span class="o">=</span> <span class="n">phiHO</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">lHO</span><span class="p">,</span> <span class="n">bHO_a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
                <span class="n">Vho</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">hbarOmega</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span>
                <span class="n">EHO</span> <span class="o">=</span> <span class="n">hbarOmega</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">lHO</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
                <span class="n">Vsw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">r</span> <span class="o">&gt;</span> <span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="n">V0</span><span class="p">)</span>
                <span class="n">integrand</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">phi_j</span> <span class="o">*</span> <span class="p">(</span><span class="n">EHO</span> <span class="o">-</span> <span class="n">Vho</span> <span class="o">+</span> <span class="n">Vsw</span><span class="p">)</span> <span class="o">*</span> <span class="n">phi_i</span>
            <span class="n">H_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">r_mesh</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">integrand</span><span class="p">)</span>

    <span class="c1"># check for symmetry</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">H_mat</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="n">H_mat</span><span class="p">)</span><span class="o">.</span><span class="n">H</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Hamiltonian matrix is not symmetric.&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Symmetrizing for now&#39;</span><span class="p">)</span>
        <span class="n">H_mat</span> <span class="o">=</span> <span class="p">(</span><span class="n">H_mat</span> <span class="o">+</span> <span class="n">H_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="c1">#raise ValueError(&#39;expected symmetric or Hermitian matrix&#39;)</span>

    <span class="c1"># check condition number</span>
    <span class="n">H_cond_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">H_mat</span><span class="p">)</span>
    <span class="c1">#print(f&#39;condition number = {np.linalg.cond(H_mat):.4e}&#39;)</span>

    <span class="k">return</span> <span class="n">H_mat</span>        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">H_ij_HO_acc_integrand</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">hbarOmega</span><span class="p">,</span> <span class="n">lHO</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">bHO_a</span> <span class="o">=</span> <span class="n">bHO</span><span class="p">(</span><span class="n">hbarOmega</span><span class="p">)</span>
    <span class="n">phi_j</span> <span class="o">=</span> <span class="n">phiHO</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">lHO</span><span class="p">,</span> <span class="n">bHO_a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">phi_i</span> <span class="o">=</span> <span class="n">phiHO</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">lHO</span><span class="p">,</span> <span class="n">bHO_a</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">Vho</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">mu</span> <span class="o">*</span> <span class="n">hbarOmega</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">EHO</span> <span class="o">=</span> <span class="n">hbarOmega</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="n">lHO</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Vsw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">r</span> <span class="o">&gt;</span> <span class="n">R</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="n">V0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">phi_j</span> <span class="o">*</span> <span class="p">(</span><span class="n">EHO</span> <span class="o">-</span> <span class="n">Vho</span> <span class="o">+</span> <span class="n">Vsw</span><span class="p">)</span> <span class="o">*</span> <span class="n">phi_i</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">H_ij_HO_acc</span><span class="p">(</span><span class="n">num_terms</span><span class="p">,</span> <span class="n">V0</span><span class="p">,</span> <span class="n">hbarOmega</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Hamiltonian matrix in the HO basis with accurate integration</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bHO_a</span> <span class="o">=</span> <span class="n">bHO</span><span class="p">(</span><span class="n">hbarOmega</span><span class="p">)</span>
    <span class="n">lHO</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">R_max</span> <span class="o">=</span> <span class="mf">20.</span>

    <span class="n">H_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_terms</span><span class="p">,</span> <span class="n">num_terms</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_terms</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_terms</span><span class="p">):</span>
            <span class="n">my_tol</span> <span class="o">=</span> <span class="mf">1.e-10</span>
            <span class="c1"># using scipy.integrate.quadrature</span>
            <span class="n">int_in</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quadrature</span><span class="p">(</span><span class="n">H_ij_HO_acc_integrand</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> 
                                     <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">hbarOmega</span><span class="p">),</span> <span class="n">tol</span><span class="o">=</span><span class="n">my_tol</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">my_tol</span><span class="p">)</span>
            <span class="n">int_out</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">quadrature</span><span class="p">(</span><span class="n">H_ij_HO_acc_integrand</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">R_max</span><span class="p">,</span> 
                                     <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">hbarOmega</span><span class="p">),</span> <span class="n">tol</span><span class="o">=</span><span class="n">my_tol</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="n">my_tol</span><span class="p">)</span>
            <span class="n">H_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">int_in</span> <span class="o">+</span> <span class="n">int_out</span>

    <span class="c1"># check for symmetry</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">H_mat</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asmatrix</span><span class="p">(</span><span class="n">H_mat</span><span class="p">)</span><span class="o">.</span><span class="n">H</span><span class="p">):</span>
        <span class="c1">#print(&#39;Hamiltonian matrix is not symmetric.&#39;)</span>
        <span class="c1">#print(&#39;Symmetrizing for now&#39;)</span>
        <span class="n">H_mat</span> <span class="o">=</span> <span class="p">(</span><span class="n">H_mat</span> <span class="o">+</span> <span class="n">H_mat</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="c1">#raise ValueError(&#39;expected symmetric or Hermitian matrix&#39;)</span>

    <span class="c1"># check condition number</span>
    <span class="n">H_cond_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">H_mat</span><span class="p">)</span>
    <span class="c1">#print(f&#39;condition number = {np.linalg.cond(H_mat):.4e}&#39;)</span>

    <span class="k">return</span> <span class="n">H_mat</span>        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V0</span> <span class="o">=</span> <span class="mf">20.</span>

<span class="n">num_terms</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">hbarOmega</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">H_mat_HO</span> <span class="o">=</span> <span class="n">H_ij_HO</span><span class="p">(</span><span class="n">num_terms</span><span class="p">,</span> <span class="n">V0</span><span class="p">,</span> <span class="n">hbarOmega</span><span class="p">)</span>
<span class="n">eig_vals_HO</span><span class="p">,</span> <span class="n">eig_vecs_HO</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">H_mat_HO</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;eigenvalue = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">eig_vals_HO</span><span class="p">)</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5000
Hamiltonian matrix is not symmetric.
Symmetrizing for now
condition number = 1.3317e+01
eigenvalue =  -16.313
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V0</span> <span class="o">=</span> <span class="mf">10.</span>

<span class="n">num_terms</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">hbarOmega</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">H_mat_HO</span> <span class="o">=</span> <span class="n">H_ij_HO_acc</span><span class="p">(</span><span class="n">num_terms</span><span class="p">,</span> <span class="n">V0</span><span class="p">,</span> <span class="n">hbarOmega</span><span class="p">)</span>
<span class="n">eig_vals_HO</span><span class="p">,</span> <span class="n">eig_vecs_HO</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">H_mat_HO</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;eigenvalue = </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">eig_vals_HO</span><span class="p">)</span><span class="si">:</span><span class="s1">12.8f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5000
condition number = 3.2771e+01
eigenvalue =  -6.75740350
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tests">
<h2>Tests<a class="headerlink" href="#tests" title="Permalink to this headline">¶</a></h2>
<p>Set the reduced mass and <span class="math notranslate nohighlight">\(\hbar\)</span> to one. Try some different square wells.</p>
<div class="section" id="check-that-the-transcendental-function-is-correct">
<h3>Check that the transcendental function is correct<a class="headerlink" href="#check-that-the-transcendental-function-is-correct" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make a plot of the zeros of the transcendental function (i.e., find E_n) </span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span> <span class="n">hbar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 

<span class="c1"># Create a square well</span>
<span class="n">R</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span> <span class="n">V0</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">;</span>

<span class="c1"># Specify the mesh</span>
<span class="n">r_max</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">num_pts</span> <span class="o">=</span> <span class="mi">1000</span> 
<span class="n">gauss_pts</span> <span class="o">=</span> <span class="mi">48</span>

<span class="n">sw1</span> <span class="o">=</span> <span class="n">SquareWell</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span> <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span>

<span class="c1"># Start the energy array a bit above -V0 until almost zero</span>
<span class="n">E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">V0</span><span class="o">+</span><span class="mf">.001</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">transcendental_pts</span> <span class="o">=</span> <span class="n">sw1</span><span class="o">.</span><span class="n">f_sw</span><span class="p">(</span><span class="n">E_pts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the zeros to check.</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_pts</span><span class="p">,</span> <span class="n">transcendental_pts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">V0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;zeros of square well transcendental function&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$E$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$f(E)$&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_27_0.png" src="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_27_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_solutions</span><span class="p">(</span><span class="n">sw_params_array</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to step through the pairs of (V0, R) parameters in </span>
<span class="sd">    sw_params_array and find the ground state energy for each.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">for</span> <span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sw_params_array</span><span class="p">:</span>
        <span class="n">sw</span> <span class="o">=</span> <span class="n">SquareWell</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span> <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">sw</span><span class="o">.</span><span class="n">E0</span><span class="p">)</span>
        
<span class="n">sw_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">20.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>  
<span class="n">find_solutions</span><span class="p">(</span><span class="n">sw_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-16.353799211781638
-14.412060528881355
-18.94185232612673
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span> <span class="n">hbar</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> 

<span class="c1"># Create a square well</span>
<span class="n">R</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span> <span class="n">V0</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">;</span>

<span class="c1"># Specify the mesh</span>
<span class="n">r_max</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">num_pts</span> <span class="o">=</span> <span class="mi">1000</span> 
<span class="n">gauss_pts</span> <span class="o">=</span> <span class="mi">48</span>

<span class="n">my_sw</span> <span class="o">=</span> <span class="n">SquareWell</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span> <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span>

<span class="n">Egs_wf</span> <span class="o">=</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">norm_wf_simps</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ground state energy = </span><span class="si">{</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ground state energy = -0.0008951338608253756
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/furnstah/Dropbox/git_rjf/EVC_stuff/EVC_tests/square_well.py:198: RuntimeWarning: invalid value encountered in sqrt
  return np.sqrt(-2. * self.mu * E) / self.hbar
/Users/furnstah/opt/anaconda3/lib/python3.8/site-packages/scipy/optimize/minpack.py:175: RuntimeWarning: The iteration is not making good progress, as measured by the 
  improvement from the last ten iterations.
  warnings.warn(msg, RuntimeWarning)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="check-the-wave-function-for-continuity-and-normalization">
<h3>Check the wave function for continuity and normalization<a class="headerlink" href="#check-the-wave-function-for-continuity-and-normalization" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a plot and check normalization</span>
<span class="n">my_r_pts</span> <span class="o">=</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="o">.</span><span class="n">r_pts</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_r_pts</span><span class="p">,</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_simps</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">gauss_mesh</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_r_pts</span><span class="p">,</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">norm_wf</span><span class="p">(</span><span class="n">my_r_pts</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">my_r_pts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">my_r_pts</span><span class="p">[</span><span class="mi">1500</span><span class="p">])</span>
<span class="c1">#ax.set_ylim(-10, 10)</span>
<span class="c1">#ax.axhline(0.0, color=&#39;red&#39;)</span>
<span class="n">title_string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;Square well wave function&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> \
               <span class="sa">rf</span><span class="s1">&#39;$V_0 = </span><span class="si">{</span><span class="n">my_sw</span><span class="o">.</span><span class="n">V0</span><span class="si">}</span><span class="s1">,\ R = </span><span class="si">{</span><span class="n">my_sw</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1"> \ \Longrightarrow\ E_0 = </span><span class="si">{</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">$&#39;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_string</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$u(r)$&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># check normalization</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;normalization = &#39;</span><span class="p">,</span> <span class="n">simps</span><span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_simps</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">my_r_pts</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;norm split reconstruct = &#39;</span><span class="p">,</span>
      <span class="n">simps</span><span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_simps</span><span class="p">[:</span><span class="n">my_sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="o">.</span><span class="n">num_in_pts</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> 
            <span class="n">my_sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="o">.</span><span class="n">r_in_pts</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">simps</span><span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_simps</span><span class="p">[</span><span class="n">my_sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="o">.</span><span class="n">num_in_pts</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> 
            <span class="n">my_sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="o">.</span><span class="n">r_out_pts</span><span class="p">)</span> 
     <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;norm function =&#39;</span><span class="p">,</span> 
       <span class="n">SW_matrix_element_simps</span><span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_simps</span><span class="p">,</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_simps</span><span class="p">,</span> 
                               <span class="n">my_sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="p">))</span>

<span class="c1"># check normalization with gaussian quadrature</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Now with Gaussian quadrature . . .&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gauss normalization = &#39;</span><span class="p">,</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span><span class="o">**</span><span class="mi">2</span> <span class="o">@</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">gauss_mesh</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;norm function =&#39;</span><span class="p">,</span> 
       <span class="n">SW_matrix_element_gauss</span><span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span><span class="p">,</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span><span class="p">,</span> 
                               <span class="n">my_sw</span><span class="o">.</span><span class="n">gauss_mesh</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> 
                               <span class="n">my_sw</span><span class="o">.</span><span class="n">gauss_mesh</span><span class="o">.</span><span class="n">weights</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>normalization =  1.000000279402407
norm split reconstruct =  1.0
norm function = 1.0

Now with Gaussian quadrature . . .
gauss normalization =  1.0
norm function = 1.0
</pre></div>
</div>
<img alt="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_31_1.png" src="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_31_1.png" />
</div>
</div>
</div>
<div class="section" id="test-expectation-values">
<h3>Test expectation values<a class="headerlink" href="#test-expectation-values" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test the expectation value of the Hamiltonian</span>
<span class="c1"># Compare calculations that don&#39;t account for the discontuity to ones</span>
<span class="c1">#  that do.</span>
<span class="n">my_r_pts</span> <span class="o">=</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="o">.</span><span class="n">r_pts</span>
<span class="n">my_E0_wf</span> <span class="o">=</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_simps</span>
<span class="n">T_expectation</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">my_E0_wf</span> <span class="o">*</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">T_on_E0_wf_simps</span><span class="p">,</span> <span class="n">my_r_pts</span><span class="p">)</span>
<span class="n">T_alt_expectation</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">my_E0_wf</span> <span class="o">*</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">T_on_E0_wf_alt_simps</span><span class="p">,</span> <span class="n">my_r_pts</span><span class="p">)</span>
<span class="n">T_me_expectation</span> <span class="o">=</span> <span class="n">SW_matrix_element_simps</span><span class="p">(</span><span class="n">my_E0_wf</span><span class="p">,</span> 
                                           <span class="n">my_sw</span><span class="o">.</span><span class="n">T_on_E0_wf_alt_simps</span><span class="p">,</span> 
                                           <span class="n">my_sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="p">)</span>
<span class="n">V_expectation</span> <span class="o">=</span> <span class="n">simps</span><span class="p">(</span><span class="n">my_E0_wf</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">Vsw</span><span class="p">(</span><span class="n">my_r_pts</span><span class="p">),</span> <span class="n">my_r_pts</span><span class="p">)</span>
<span class="n">V_me_expectation</span> <span class="o">=</span> <span class="n">SW_matrix_element_simps</span><span class="p">(</span><span class="n">my_E0_wf</span><span class="p">,</span> <span class="n">my_E0_wf</span><span class="p">,</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="p">,</span>
                                           <span class="n">my_sw</span><span class="o">.</span><span class="n">Vsw</span><span class="p">(</span><span class="n">my_r_pts</span><span class="p">))</span>

<span class="n">E0_expectation</span> <span class="o">=</span> <span class="n">T_expectation</span> <span class="o">+</span> <span class="n">V_expectation</span>
<span class="n">E0_me_expectation</span> <span class="o">=</span> <span class="n">T_me_expectation</span> <span class="o">+</span> <span class="n">V_me_expectation</span>
                 
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;actual E0 = </span><span class="si">{</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">, &#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;E0_exp = </span><span class="si">{</span><span class="n">E0_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">, &#39;</span><span class="p">,</span>  
      <span class="sa">f</span><span class="s1">&#39;E0_me_exp = </span><span class="si">{</span><span class="n">E0_me_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">, </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>  
      <span class="sa">f</span><span class="s1">&#39;T_exp = </span><span class="si">{</span><span class="n">T_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">, &#39;</span><span class="p">,</span>          
      <span class="sa">f</span><span class="s1">&#39;T_alt_exp = </span><span class="si">{</span><span class="n">T_alt_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">,</span>          
      <span class="sa">f</span><span class="s1">&#39;T_me_exp = </span><span class="si">{</span><span class="n">T_me_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">, </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>          
      <span class="sa">f</span><span class="s1">&#39;V_exp = </span><span class="si">{</span><span class="n">V_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1"> ,&#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;V_me_exp = </span><span class="si">{</span><span class="n">V_me_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>          
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>actual E0 = -0.000895133861,  E0_exp = -0.000895134111,  E0_me_exp = -0.000895133861, 
 T_exp = 0.087249324287,  T_alt_exp = 0.087249324287, T_me_exp = 0.086877480834, 
 V_exp = -0.088144458398 , V_me_exp = -0.087772614695
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Gaussian quadrature version</span>
<span class="c1"># Test the expectation value of the Hamiltonian</span>
<span class="c1"># Compare calculations that don&#39;t account for the discontuity to ones</span>
<span class="c1">#  that do.</span>
<span class="n">my_nodes</span> <span class="o">=</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">gauss_mesh</span><span class="o">.</span><span class="n">nodes</span>
<span class="n">my_weights</span> <span class="o">=</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">gauss_mesh</span><span class="o">.</span><span class="n">weights</span>
<span class="n">T_expectation</span> <span class="o">=</span> <span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span> <span class="o">*</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">T_on_E0_wf_gauss</span><span class="p">)</span> <span class="o">@</span> <span class="n">my_weights</span>                
<span class="n">T_alt_expectation</span> <span class="o">=</span> <span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span> <span class="o">*</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">T_on_E0_wf_alt_gauss</span><span class="p">)</span> <span class="o">@</span> \
                     <span class="n">my_weights</span>
<span class="n">T_me_expectation</span> <span class="o">=</span> <span class="n">SW_matrix_element_gauss</span><span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span><span class="p">,</span> 
                                           <span class="n">my_sw</span><span class="o">.</span><span class="n">T_on_E0_wf_alt_gauss</span><span class="p">,</span>
                                           <span class="n">my_nodes</span><span class="p">,</span> <span class="n">my_weights</span><span class="p">)</span>
<span class="n">V_expectation</span> <span class="o">=</span> <span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">Vsw</span><span class="p">(</span><span class="n">my_nodes</span><span class="p">))</span> <span class="o">@</span> <span class="n">my_weights</span>
<span class="n">V_me_expectation</span> <span class="o">=</span> <span class="n">SW_matrix_element_gauss</span><span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span><span class="p">,</span> 
                                           <span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span><span class="p">,</span> 
                                           <span class="n">my_nodes</span><span class="p">,</span> <span class="n">my_weights</span><span class="p">,</span>
                                           <span class="n">my_sw</span><span class="o">.</span><span class="n">Vsw</span><span class="p">(</span><span class="n">my_nodes</span><span class="p">))</span>

<span class="n">E0_expectation</span> <span class="o">=</span> <span class="n">T_expectation</span> <span class="o">+</span> <span class="n">V_expectation</span>
<span class="n">E0_me_expectation</span> <span class="o">=</span> <span class="n">T_me_expectation</span> <span class="o">+</span> <span class="n">V_me_expectation</span>
          
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gaussian quadrature check of expectation values&#39;</span><span class="p">)</span>    
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;actual E0 = </span><span class="si">{</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">, &#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;E0_exp = </span><span class="si">{</span><span class="n">E0_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">, &#39;</span><span class="p">,</span>  
      <span class="sa">f</span><span class="s1">&#39;E0_me_exp = </span><span class="si">{</span><span class="n">E0_me_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">, </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>  
      <span class="sa">f</span><span class="s1">&#39;T_exp = </span><span class="si">{</span><span class="n">T_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">, &#39;</span><span class="p">,</span>          
      <span class="sa">f</span><span class="s1">&#39;T_alt_exp = </span><span class="si">{</span><span class="n">T_alt_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">,&#39;</span><span class="p">,</span>          
      <span class="sa">f</span><span class="s1">&#39;T_me_exp = </span><span class="si">{</span><span class="n">T_me_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">, </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span>          
      <span class="sa">f</span><span class="s1">&#39;V_exp = </span><span class="si">{</span><span class="n">V_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1"> ,&#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;V_me_exp = </span><span class="si">{</span><span class="n">V_me_expectation</span><span class="si">:</span><span class="s1">.12f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>          
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Gaussian quadrature check of expectation values
actual E0 = -0.000895133861,  E0_exp = -0.000895133861,  E0_me_exp = -0.000895133861, 
 T_exp = 0.086214332369,  T_alt_exp = 0.086214332369, T_me_exp = 0.086214332369, 
 V_exp = -0.087109466229 , V_me_exp = -0.087109466229
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="make-some-tables-and-figures">
<h3>Make some tables and figures<a class="headerlink" href="#make-some-tables-and-figures" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_y_vs_x</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">semilogy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loglog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generic plotting function: return a figure axis with a plot of y vs. x,</span>
<span class="sd">    with line color and style, title, axis labels, and line label</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>        <span class="c1"># if the axis object doesn&#39;t exist, make one</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">semilogy</span><span class="p">):</span>
        <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> 
                            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">)</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">loglog</span><span class="p">):</span>
        <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> 
                          <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> 
                    <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>    <span class="c1"># if a label if passed, show the legend</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>    <span class="c1"># set a title if one if passed</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">axis_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># set x-axis and y-axis labels if passed  </span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">axis_labels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">ax</span><span class="p">,</span> <span class="n">line</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">start_stop_indices</span><span class="p">(</span><span class="n">t_pts</span><span class="p">,</span> <span class="n">plot_start</span><span class="p">,</span> <span class="n">plot_stop</span><span class="p">):</span>
    <span class="n">start_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">t_pts</span><span class="o">-</span><span class="n">plot_start</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>  <span class="c1"># index in t_pts array </span>
    <span class="n">stop_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">t_pts</span><span class="o">-</span><span class="n">plot_stop</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>  <span class="c1"># index in t_pts array </span>
    <span class="k">return</span> <span class="n">start_index</span><span class="p">,</span> <span class="n">stop_index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_ticks</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">x_major</span><span class="p">,</span> <span class="n">x_minor</span><span class="p">,</span> <span class="n">y_major</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y_minor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
              <span class="n">x_fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">y_fmt</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set up the major ticks at every major, with labels, and minor ticks at minor.</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="c1"># </span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">x_major</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="n">x_fmt</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">x_minor</span><span class="p">))</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">y_major</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">y_major</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="n">y_fmt</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">y_minor</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">y_minor</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make an array of square wells, specified by an array of parameters</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_pts</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">r_max</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="n">gauss_pts</span> <span class="o">=</span> <span class="mi">48</span>

<span class="n">sw_params_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">30.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>  

<span class="n">sw_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">SquareWell</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span>
                       <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span> <span class="k">for</span> 
             <span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sw_params_array</span><span class="p">]</span>

<span class="n">V0_ref_pts</span> <span class="o">=</span> <span class="p">[</span><span class="n">sw</span><span class="o">.</span><span class="n">V0</span> <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sw_array</span><span class="p">]</span>
<span class="n">E0_ref_pts</span> <span class="o">=</span> <span class="p">[</span><span class="n">sw</span><span class="o">.</span><span class="n">E0</span> <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sw_array</span><span class="p">]</span>

<span class="c1"># Make an EVC object</span>
<span class="n">my_evc</span> <span class="o">=</span> <span class="n">EigenvectorContinuationScattering</span><span class="p">(</span><span class="n">sw_array</span><span class="p">)</span>

<span class="c1"># Step through test values</span>
<span class="n">test_R</span> <span class="o">=</span> <span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">R</span>
<span class="n">test_mu</span> <span class="o">=</span> <span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mu</span>

<span class="n">test_V0_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">exact_E_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">EVC_E_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">abs_err_E_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rel_err_E_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_i</span> <span class="o">=</span> <span class="mi">5</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;All potentials have R = </span><span class="si">{</span><span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Results with </span><span class="si">{</span><span class="n">test_i</span><span class="si">}</span><span class="s1"> basis functions with &#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;V0 = </span><span class="si">{</span><span class="p">[</span><span class="n">sw</span><span class="o">.</span><span class="n">V0</span> <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">test_i</span><span class="p">]]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">   V0         exact             EVC        abs err  rel err&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">V0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_V0_pts</span><span class="p">):</span>
    <span class="n">test_theta</span> <span class="o">=</span> <span class="p">[</span><span class="n">V0</span><span class="p">,</span> <span class="n">test_R</span><span class="p">]</span>
    <span class="n">test_sw</span> <span class="o">=</span> <span class="n">SquareWell</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">test_R</span><span class="p">,</span> <span class="n">test_mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> 
                         <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span> <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span>
    <span class="n">exact_E</span> <span class="o">=</span> <span class="n">test_sw</span><span class="o">.</span><span class="n">E0</span>
    <span class="n">exact_E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exact_E_pts</span><span class="p">,</span> <span class="n">exact_E</span><span class="p">)</span>
    <span class="n">EVC_E</span> <span class="o">=</span> <span class="n">my_evc</span><span class="o">.</span><span class="n">find_EVC_gauss</span><span class="p">(</span><span class="n">test_i</span><span class="p">,</span> <span class="n">test_theta</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">EVC_E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EVC_E_pts</span><span class="p">,</span> <span class="n">EVC_E</span><span class="p">)</span>
    <span class="n">abs_err_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">EVC_E</span> <span class="o">-</span> <span class="n">exact_E</span><span class="p">)</span>
    <span class="n">abs_err_E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abs_err_E_pts</span><span class="p">,</span> <span class="n">abs_err_E</span><span class="p">)</span>
    <span class="n">rel_err_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">EVC_E</span> <span class="o">-</span> <span class="n">exact_E</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact_E</span><span class="p">)</span>
    <span class="n">rel_err_E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rel_err_E_pts</span><span class="p">,</span> <span class="n">rel_err_E</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  </span><span class="si">{</span><span class="n">V0</span><span class="si">:</span><span class="s1">4.1f</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">exact_E</span><span class="si">:</span><span class="s1">14.10f</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">EVC_E</span><span class="si">:</span><span class="s1">14.10f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
              <span class="sa">f</span><span class="s1">&#39;  </span><span class="si">{</span><span class="n">abs_err_E</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">rel_err_E</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">&#39;</span>  <span class="p">)</span>
    
<span class="c1"># for i in np.arange(1, len(sw_array)+1):</span>
<span class="c1">#     eigvals = my_evc.find_EVC_gauss(i, test_theta)</span>
<span class="c1">#     print(f&#39;{eigvals}&#39;,</span>
<span class="c1">#           f&#39;  cond. #: N = {my_evc.N_cond_num:.2e}&#39;,</span>
<span class="c1">#           f&#39;  H = {my_evc.H_cond_num:.2e}&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All potentials have R = 1.0
Results with 5 basis functions with  V0 = [30.0, 20.0, 15.0, 10.0, 0.2]

   V0         exact             EVC        abs err  rel err
   1.0    -0.1695966689    -0.4093091904   2.4e-01  1.4e+00
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/furnstah/Dropbox/git_rjf/EVC_stuff/EVC_tests/square_well.py:198: RuntimeWarning: invalid value encountered in sqrt
  return np.sqrt(-2. * self.mu * E) / self.hbar
/Users/furnstah/opt/anaconda3/lib/python3.8/site-packages/scipy/optimize/minpack.py:175: RuntimeWarning: The iteration is not making good progress, as measured by the 
  improvement from the last ten iterations.
  warnings.warn(msg, RuntimeWarning)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   2.0    -0.2035507418    -0.6512616095   4.5e-01  2.2e+00
   3.0    -0.7814787639    -1.0715700567   2.9e-01  3.7e-01
   4.0    -1.5088054389    -1.6807935630   1.7e-01  1.1e-01
   5.0    -2.3120970432    -2.4196648047   1.1e-01  4.7e-02
   6.0    -3.1606841058    -3.2334857083   7.3e-02  2.3e-02
   7.0    -4.0390249043    -4.0917432286   5.3e-02  1.3e-02
   8.0    -4.9382348617    -4.9784396871   4.0e-02  8.1e-03
   9.0    -5.8527947604    -5.8846687968   3.2e-02  5.4e-03
  10.0    -6.7790600214    -6.8050778194   2.6e-02  3.8e-03
  11.0    -7.7145084004    -7.7362253769   2.2e-02  2.8e-03
  12.0    -8.6573282030    -8.6757742073   1.8e-02  2.1e-03
  13.0    -9.6061781292    -9.6220656960   1.6e-02  1.7e-03
  14.0   -10.5600398804   -10.5738805745   1.4e-02  1.3e-03
  15.0   -11.5181238197   -11.5302964900   1.2e-02  1.1e-03
  16.0   -12.4798064255   -12.4905990341   1.1e-02  8.6e-04
  17.0   -13.4445875628   -13.4542238384   9.6e-03  7.2e-04
  18.0   -14.4120605289   -14.4207175491   8.7e-03  6.0e-04
  19.0   -15.3818905772   -15.3897107291   7.8e-03  5.1e-04
  20.0   -16.3537992118   -16.3608985535   7.1e-03  4.3e-04
  21.0   -17.3275524991   -17.3340267467   6.5e-03  3.7e-04
  22.0   -18.3029522320   -18.3088811388   5.9e-03  3.2e-04
  23.0   -19.2798291550   -19.2852797761   5.5e-03  2.8e-04
  24.0   -20.2580377052   -20.2630668704   5.0e-03  2.5e-04
  25.0   -21.2374518801   -21.2421080964   4.7e-03  2.2e-04
  26.0   -22.2179619586   -22.2222868921   4.3e-03  1.9e-04
  27.0   -23.1994718726   -23.2035015169   4.0e-03  1.7e-04
  28.0   -24.1818970819   -24.1856626887   3.8e-03  1.6e-04
  29.0   -25.1651628419   -25.1686916698   3.5e-03  1.4e-04
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#### from graphs import setup_rc_params</span>
<span class="n">setup_rc_params</span><span class="p">(</span><span class="n">presentation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">FormatStrFormatter</span><span class="p">,</span>
                               <span class="n">AutoMinorLocator</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">overall_title</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;Eigenvector continuation for square well &#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\ell=0$ ground state:  &#39;</span> <span class="o">+</span> \
                 <span class="sa">rf</span><span class="s1">&#39; $R = </span><span class="si">{</span><span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">$&#39;</span> 
<span class="c1">#fig.suptitle(overall_title, va=&#39;baseline&#39;)</span>

<span class="n">ax_a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>                  

<span class="c1">#start, stop = start_stop_indices(t_pts, t_start, t_end)    </span>
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">test_V0_pts</span><span class="p">,</span> <span class="n">exact_E_pts</span><span class="p">,</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$V_0$&#39;</span><span class="p">,</span><span class="sa">rf</span><span class="s1">&#39;$E_</span><span class="se">{{</span><span class="s1">\rm gs</span><span class="se">}}</span><span class="s1">$&#39;</span><span class="p">),</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_a</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">test_V0_pts</span><span class="p">,</span> <span class="n">EVC_E_pts</span><span class="p">,</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$V_0$&#39;</span><span class="p">,</span><span class="sa">rf</span><span class="s1">&#39;$E_</span><span class="se">{{</span><span class="s1">\rm gs</span><span class="se">}}</span><span class="s1">$&#39;</span><span class="p">),</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;EVC&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_a</span><span class="p">)</span> 
<span class="n">ax_a</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V0_ref_pts</span><span class="p">[:</span><span class="n">test_i</span><span class="p">],</span> <span class="n">E0_ref_pts</span><span class="p">[:</span><span class="n">test_i</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">set_ticks</span><span class="p">(</span><span class="n">ax_a</span><span class="p">,</span> <span class="n">x_major</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x_minor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_major</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">y_minor</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ax_b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">test_V0_pts</span><span class="p">,</span> <span class="n">abs_err_E_pts</span><span class="p">,</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$V_0$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;error&#39;</span><span class="p">),</span> 
            <span class="n">semilogy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;absolute&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_b</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">test_V0_pts</span><span class="p">,</span> <span class="n">rel_err_E_pts</span><span class="p">,</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$V_0$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;error&#39;</span><span class="p">),</span>
            <span class="n">semilogy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;relative&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_b</span><span class="p">)</span>    
<span class="n">set_ticks</span><span class="p">(</span><span class="n">ax_b</span><span class="p">,</span> <span class="n">x_major</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">x_minor</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">fig_filename</span> <span class="o">=</span> <span class="n">fig_dir</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;EVC_</span><span class="si">{</span><span class="n">test_i</span><span class="si">}</span><span class="s1">.png&#39;</span>
<span class="c1">#fig.savefig(fig_filename, bbox_inches=&#39;tight&#39;)  </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_40_0.png" src="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_40_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sw_array</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;square_well.SquareWell at 0x11aa97460&gt;,
 &lt;square_well.SquareWell at 0x11abc1130&gt;,
 &lt;square_well.SquareWell at 0x11abc1220&gt;,
 &lt;square_well.SquareWell at 0x11abc1310&gt;,
 &lt;square_well.SquareWell at 0x11abc13d0&gt;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make a plot and check normalization</span>
<span class="n">my_r_pts</span> <span class="o">=</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="o">.</span><span class="n">r_pts</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">()</span>
<span class="n">ls</span><span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="s1">&#39;k--&#39;</span> <span class="p">]</span> 
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">my_sw</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sw_array</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_sw</span><span class="o">.</span><span class="n">gauss_mesh</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="n">my_sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span><span class="p">,</span> <span class="n">ls</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="s1">&#39;$V_0 = </span><span class="si">{</span><span class="n">my_sw</span><span class="o">.</span><span class="n">V0</span><span class="si">}</span><span class="s1">,\ E_0 = </span><span class="si">{</span><span class="n">my_sw</span><span class="o">.</span><span class="n">E0</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="c1">#ax.set_ylim(-10, 10)</span>
<span class="c1">#ax.axhline(0.0, color=&#39;red&#39;)</span>
<span class="n">title_string</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;Square well V and WF with $R=1$&#39;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">1</span> <span class="p">,</span> <span class="n">columnspacing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">handlelength</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">handletextpad</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_string</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$r$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$u(r), V$&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_42_0.png" src="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_42_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make an array of square wells, specified by an array of parameters</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_pts</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">r_max</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="n">gauss_pts</span> <span class="o">=</span> <span class="mi">48</span>

<span class="n">sw_params_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">12.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>  

<span class="n">sw_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">SquareWell</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span>
                       <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span> <span class="k">for</span> 
             <span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sw_params_array</span><span class="p">]</span>

<span class="n">V0_ref_pts</span> <span class="o">=</span> <span class="p">[</span><span class="n">sw</span><span class="o">.</span><span class="n">V0</span> <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sw_array</span><span class="p">]</span>
<span class="n">E0_ref_pts</span> <span class="o">=</span> <span class="p">[</span><span class="n">sw</span><span class="o">.</span><span class="n">E0</span> <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sw_array</span><span class="p">]</span>

<span class="c1"># Make an EVC object</span>
<span class="n">my_evc</span> <span class="o">=</span> <span class="n">EigenvectorContinuationScattering</span><span class="p">(</span><span class="n">sw_array</span><span class="p">)</span>

<span class="c1"># Step through test values</span>
<span class="n">test_R</span> <span class="o">=</span> <span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">R</span>
<span class="n">test_mu</span> <span class="o">=</span> <span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mu</span>

<span class="n">test_V0_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">exact_E_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">EVC_E_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">HO_E_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">abs_err_E_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rel_err_E_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">abs_err_HO_E_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">rel_err_HO_E_pts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">test_i</span> <span class="o">=</span> <span class="mi">5</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;All potentials have R = </span><span class="si">{</span><span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Results with </span><span class="si">{</span><span class="n">test_i</span><span class="si">}</span><span class="s1"> basis functions with &#39;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s1">&#39;V0 = </span><span class="si">{</span><span class="p">[</span><span class="n">sw</span><span class="o">.</span><span class="n">V0</span> <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">test_i</span><span class="p">]]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">   V0         exact             EVC        abs err  rel err&#39;</span><span class="p">,</span> \
     <span class="sa">f</span><span class="s1">&#39;      HO basis   abs err   rel err&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">V0</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">test_V0_pts</span><span class="p">):</span>
    <span class="n">test_theta</span> <span class="o">=</span> <span class="p">[</span><span class="n">V0</span><span class="p">,</span> <span class="n">test_R</span><span class="p">]</span>
    <span class="n">test_sw</span> <span class="o">=</span> <span class="n">SquareWell</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">test_R</span><span class="p">,</span> <span class="n">test_mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> 
                         <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span> <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span>
    <span class="n">exact_E</span> <span class="o">=</span> <span class="n">test_sw</span><span class="o">.</span><span class="n">E0</span>
    <span class="n">exact_E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exact_E_pts</span><span class="p">,</span> <span class="n">exact_E</span><span class="p">)</span>
    <span class="n">EVC_E</span> <span class="o">=</span> <span class="n">my_evc</span><span class="o">.</span><span class="n">find_EVC_gauss</span><span class="p">(</span><span class="n">test_i</span><span class="p">,</span> <span class="n">test_theta</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">EVC_E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EVC_E_pts</span><span class="p">,</span> <span class="n">EVC_E</span><span class="p">)</span>
    <span class="n">abs_err_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">EVC_E</span> <span class="o">-</span> <span class="n">exact_E</span><span class="p">)</span>
    <span class="n">abs_err_E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">abs_err_E_pts</span><span class="p">,</span> <span class="n">abs_err_E</span><span class="p">)</span>
    <span class="n">rel_err_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">EVC_E</span> <span class="o">-</span> <span class="n">exact_E</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact_E</span><span class="p">)</span>
    <span class="n">rel_err_E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rel_err_E_pts</span><span class="p">,</span> <span class="n">rel_err_E</span><span class="p">)</span>
    
    <span class="n">num_terms</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">hbarOmega</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="n">H_mat_HO</span> <span class="o">=</span> <span class="n">H_ij_HO_acc</span><span class="p">(</span><span class="n">num_terms</span><span class="p">,</span> <span class="n">V0</span><span class="p">,</span> <span class="n">hbarOmega</span><span class="p">)</span>
    <span class="n">eig_vals_HO</span><span class="p">,</span> <span class="n">eig_vecs_HO</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">H_mat_HO</span><span class="p">)</span>
    <span class="n">HO_E_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">eig_vals_HO</span><span class="p">)</span>
    <span class="n">HO_E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HO_E_pts</span><span class="p">,</span> <span class="n">HO_E_min</span><span class="p">)</span>
    <span class="n">abs_err_HO_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">HO_E_min</span> <span class="o">-</span> <span class="n">exact_E</span><span class="p">)</span>
    <span class="n">abs_err_HO_E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rel_err_HO_E_pts</span><span class="p">,</span> <span class="n">abs_err_HO_E</span><span class="p">)</span>
    <span class="n">rel_err_HO_E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">HO_E_min</span> <span class="o">-</span> <span class="n">exact_E</span><span class="p">)</span><span class="o">/</span><span class="n">exact_E</span><span class="p">)</span>
    <span class="n">rel_err_HO_E_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rel_err_HO_E_pts</span><span class="p">,</span> <span class="n">rel_err_HO_E</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  </span><span class="si">{</span><span class="n">V0</span><span class="si">:</span><span class="s1">4.1f</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">exact_E</span><span class="si">:</span><span class="s1">14.10f</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="n">EVC_E</span><span class="si">:</span><span class="s1">14.10f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
              <span class="sa">f</span><span class="s1">&#39;  </span><span class="si">{</span><span class="n">abs_err_E</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">rel_err_E</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">&#39;</span>  <span class="p">,</span>
              <span class="sa">f</span><span class="s1">&#39;  </span><span class="si">{</span><span class="n">HO_E_min</span><span class="si">:</span><span class="s1">14.10f</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">abs_err_HO_E</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">rel_err_HO_E</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        
        
    
<span class="c1"># for i in np.arange(1, len(sw_array)+1):</span>
<span class="c1">#     eigvals = my_evc.find_EVC_gauss(i, test_theta)</span>
<span class="c1">#     print(f&#39;{eigvals}&#39;,</span>
<span class="c1">#           f&#39;  cond. #: N = {my_evc.N_cond_num:.2e}&#39;,</span>
<span class="c1">#           f&#39;  H = {my_evc.H_cond_num:.2e}&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All potentials have R = 1.0
Results with 5 basis functions with  V0 = [12.0, 10.0, 8.0, 6.0, 4.0]

   V0         exact             EVC        abs err  rel err       HO basis   abs err   rel err
   1.0    -0.1695966689     0.1268937297   3.0e-01  1.7e+00    -0.9320242643  7.6e-01  4.5e+00
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/furnstah/opt/anaconda3/lib/python3.8/site-packages/scipy/integrate/_quadrature.py:245: AccuracyWarning: maxiter (50) exceeded. Latest difference = 2.554559e-02
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   2.0    -0.2035507418    -0.1992041797   4.3e-03  2.1e-02    -1.1811195504  9.8e-01  4.8e+00
   3.0    -0.7814787639    -0.7814352195   4.4e-05  5.6e-05    -1.5170660990  7.4e-01  9.4e-01
   4.0    -1.5088054389    -1.5088054389   1.6e-15  1.0e-15    -1.9646961605  4.6e-01  3.0e-01
   5.0    -2.3120970432    -2.3120970125   3.1e-08  1.3e-08    -2.5351795489  2.2e-01  9.6e-02
   6.0    -3.1606841058    -3.1606841058   4.4e-16  1.4e-16    -3.2170525837  5.6e-02  1.8e-02
   7.0    -4.0390249043    -4.0390249036   6.9e-10  1.7e-10    -3.9846597871  5.4e-02  1.3e-02
   8.0    -4.9382348617    -4.9382348617   2.7e-15  5.4e-16    -4.8123317718  1.3e-01  2.5e-02
   9.0    -5.8527947604    -5.8527947603   1.3e-10  2.3e-11    -5.6808329236  1.7e-01  2.9e-02
  10.0    -6.7790600214    -6.7790600214   8.9e-16  1.3e-16    -6.5773038620  2.0e-01  3.0e-02
  11.0    -7.7145084004    -7.7145084002   1.9e-10  2.4e-11    -7.4934077278  2.2e-01  2.9e-02
  12.0    -8.6573282030    -8.6573282030   1.8e-15  2.1e-16    -8.4237006650  2.3e-01  2.7e-02
  13.0    -9.6061781292    -9.6061781246   4.7e-09  4.9e-10    -9.3645470935  2.4e-01  2.5e-02
  14.0   -10.5600398804   -10.5600398344   4.6e-08  4.4e-09   -10.3134519126  2.5e-01  2.3e-02
  15.0   -11.5181238197   -11.5181236135   2.1e-07  1.8e-08   -11.2686550434  2.5e-01  2.2e-02
  16.0   -12.4798064255   -12.4798057880   6.4e-07  5.1e-08   -12.2288824730  2.5e-01  2.0e-02
  17.0   -13.4445875628   -13.4445859903   1.6e-06  1.2e-07   -13.1931901306  2.5e-01  1.9e-02
  18.0   -14.4120605289   -14.4120572031   3.3e-06  2.3e-07   -14.1608635544  2.5e-01  1.7e-02
  19.0   -15.3818905772   -15.3818842886   6.3e-06  4.1e-07   -15.1313517932  2.5e-01  1.6e-02
  20.0   -16.3537992118   -16.3537882931   1.1e-05  6.7e-07   -16.1042228083  2.5e-01  1.5e-02
  21.0   -17.3275524991   -17.3275347710   1.8e-05  1.0e-06   -17.0791327044  2.5e-01  1.4e-02
  22.0   -18.3029522320   -18.3029249623   2.7e-05  1.5e-06   -18.0558040567  2.5e-01  1.4e-02
  23.0   -19.2798291550   -19.2797890314   4.0e-05  2.1e-06   -19.0340103549  2.5e-01  1.3e-02
  24.0   -20.2580377052   -20.2579808193   5.7e-05  2.8e-06   -20.0135646417  2.4e-01  1.2e-02
  25.0   -21.2374518801   -21.2373737226   7.8e-05  3.7e-06   -20.9943110826  2.4e-01  1.1e-02
  26.0   -22.2179619586   -22.2178574237   1.0e-04  4.7e-06   -21.9761186200  2.4e-01  1.1e-02
  27.0   -23.1994718726   -23.1993352695   1.4e-04  5.9e-06   -22.9588761311  2.4e-01  1.0e-02
  28.0   -24.1818970819   -24.1817221529   1.7e-04  7.2e-06   -23.9424886901  2.4e-01  9.9e-03
  29.0   -25.1651628419   -25.1649427846   2.2e-04  8.7e-06   -24.9268746479  2.4e-01  9.5e-03
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">graphs</span> <span class="kn">import</span> <span class="n">setup_rc_params</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MultipleLocator</span><span class="p">,</span> <span class="n">FormatStrFormatter</span><span class="p">,</span>
                               <span class="n">AutoMinorLocator</span><span class="p">)</span>
<span class="n">setup_rc_params</span><span class="p">(</span><span class="n">presentation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.constrained_layout.use&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">overall_title</span> <span class="o">=</span> <span class="sa">rf</span><span class="s1">&#39;Eigenvector continuation for square well &#39;</span> <span class="o">+</span> \
                <span class="sa">rf</span><span class="s1">&#39; $\ell=0$ ground state:  &#39;</span> <span class="o">+</span> \
                 <span class="sa">rf</span><span class="s1">&#39; $R = </span><span class="si">{</span><span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">$&#39;</span> 
<span class="c1">#fig.suptitle(overall_title, va=&#39;baseline&#39;)</span>

<span class="n">ax_a</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>                  

<span class="c1">#start, stop = start_stop_indices(t_pts, t_start, t_end)    </span>
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">test_V0_pts</span><span class="p">,</span> <span class="n">exact_E_pts</span><span class="p">,</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$V_0$&#39;</span><span class="p">,</span><span class="sa">rf</span><span class="s1">&#39;$E_</span><span class="se">{{</span><span class="s1">\rm gs</span><span class="se">}}</span><span class="s1">$&#39;</span><span class="p">),</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;exact&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_a</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">test_V0_pts</span><span class="p">,</span> <span class="n">EVC_E_pts</span><span class="p">,</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$V_0$&#39;</span><span class="p">,</span><span class="sa">rf</span><span class="s1">&#39;$E_</span><span class="se">{{</span><span class="s1">\rm gs</span><span class="se">}}</span><span class="s1">$&#39;</span><span class="p">),</span> 
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;EVC&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_a</span><span class="p">)</span> 
<span class="n">ax_a</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">V0_ref_pts</span><span class="p">[:</span><span class="n">test_i</span><span class="p">],</span> <span class="n">E0_ref_pts</span><span class="p">[:</span><span class="n">test_i</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">ax_a</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

<span class="c1"># Set up the major ticks at every 10, with labels, and minor ticks at 1</span>
<span class="n">ax_a</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax_a</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">))</span>
<span class="n">ax_a</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>


<span class="n">ax_b</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>                  
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">test_V0_pts</span><span class="p">,</span> <span class="n">abs_err_E_pts</span><span class="p">,</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$V_0$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;error&#39;</span><span class="p">),</span> 
            <span class="n">semilogy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;absolute&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_b</span><span class="p">)</span>    
<span class="n">plot_y_vs_x</span><span class="p">(</span><span class="n">test_V0_pts</span><span class="p">,</span> <span class="n">rel_err_E_pts</span><span class="p">,</span> 
            <span class="n">axis_labels</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$V_0$&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;error&#39;</span><span class="p">),</span>
            <span class="n">semilogy</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;relative&#39;</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_b</span><span class="p">)</span>    

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">fig_filename</span> <span class="o">=</span> <span class="n">fig_dir</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;EVC3_</span><span class="si">{</span><span class="n">test_i</span><span class="si">}</span><span class="s1">.png&#39;</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">fig_filename</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_44_0.png" src="../../_images/EVC_square_well_bound_states_refactored_orthogonal_compare_44_0.png" />
</div>
</div>
</div>
<div class="section" id="more-tests">
<h3>More tests<a class="headerlink" href="#more-tests" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make an array of square wells, specified by an array of parameters</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_pts</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">r_max</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="n">gauss_pts</span> <span class="o">=</span> <span class="mi">48</span>

<span class="c1"># Array elements are [V0, R]</span>
<span class="n">sw_params_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">16.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">14.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">24.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">22.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> 
                            <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">])</span>  
<span class="c1">#sw_params_array = np.array([[20., 1], [12., 1], [20., 2], [16., 4]])  </span>
<span class="c1">#sw_params_array = np.array([[20., 1], [18., 1], [20., 2]])  </span>

<span class="n">sw_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">SquareWell</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span>
                       <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span> <span class="k">for</span> 
             <span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sw_params_array</span><span class="p">]</span>

<span class="c1"># Create an EVC object</span>
<span class="n">my_evc</span> <span class="o">=</span> <span class="n">EigenvectorContinuationScattering</span><span class="p">(</span><span class="n">sw_array</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sw_array</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ground state energy E0 = </span><span class="si">{</span><span class="n">sw</span><span class="o">.</span><span class="n">E0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">Egs_wf</span> <span class="o">=</span> <span class="n">sw</span><span class="o">.</span><span class="n">E0_wf_simps</span>
    <span class="n">Egs_wf_gauss</span> <span class="o">=</span> <span class="n">sw</span><span class="o">.</span><span class="n">E0_wf_gauss</span>
    <span class="c1">#print(len(sw.r_pts), len(Egs_wf))</span>
    <span class="c1">#print(&#39;normalization = &#39;, simps(Egs_wf**2, sw.r_mesh.r_pts))</span>
    <span class="n">norm_simps</span> <span class="o">=</span> <span class="n">SW_matrix_element_simps</span><span class="p">(</span><span class="n">Egs_wf</span><span class="p">,</span> <span class="n">Egs_wf</span><span class="p">,</span> <span class="n">sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="p">)</span>
    <span class="n">norm_gauss</span> <span class="o">=</span> <span class="n">SW_matrix_element_gauss</span><span class="p">(</span><span class="n">Egs_wf_gauss</span><span class="p">,</span> <span class="n">Egs_wf_gauss</span><span class="p">,</span>
                                         <span class="n">sw</span><span class="o">.</span><span class="n">gauss_mesh</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span>
                                         <span class="n">sw</span><span class="o">.</span><span class="n">gauss_mesh</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">norm_quadrature</span> <span class="o">=</span> <span class="n">SW_matrix_element</span><span class="p">(</span><span class="n">sw</span><span class="p">,</span> <span class="n">sw</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;normalization = </span><span class="si">{</span><span class="n">norm_simps</span><span class="si">:</span><span class="s1">.14f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39; gauss = </span><span class="si">{</span><span class="n">norm_gauss</span><span class="si">:</span><span class="s1">.14f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39; quadrature = </span><span class="si">{</span><span class="n">norm_quadrature</span><span class="si">:</span><span class="s1">.14f</span><span class="si">}</span><span class="s1">&#39;</span> 
         <span class="p">)</span>
    <span class="c1">#print(&#39;normalization = &#39;, simps(sw.E0_wf**2, sw.r_mesh.r_pts),&#39;\n&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ground state energy E0 = -12.4798064254845
normalization = 1.00000000000000  gauss = 1.00000000000000  quadrature = 1.00000000000000
ground state energy E0 = -10.560039880413166
normalization = 1.00000000000000  gauss = 1.00000000000000  quadrature = 1.00000000000000
ground state energy E0 = -8.657328203014181
normalization = 1.00000000000000  gauss = 1.00000000000000  quadrature = 0.99999999999999
ground state energy E0 = -20.258037705197633
normalization = 1.00000000000000  gauss = 1.00000000000000  quadrature = 1.00000000000000
ground state energy E0 = -18.302952231956443
normalization = 1.00000000000000  gauss = 1.00000000000000  quadrature = 1.00000000000000
ground state energy E0 = -16.353799211781638
normalization = 1.00000000000000  gauss = 1.00000000000000  quadrature = 1.00000000000000
ground state energy E0 = -14.412060528881355
normalization = 1.00000000000000  gauss = 1.00000000000000  quadrature = 1.00000000000000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_ij</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.        , 0.99971673, 0.99856266, 0.99806187, 0.99874707],
       [0.99971673, 1.        , 0.99955454, 0.99630731, 0.99727854],
       [0.99856266, 0.99955454, 1.        , 0.99332886, 0.99465292],
       [0.99806187, 0.99630731, 0.99332886, 1.        , 0.99992509],
       [0.99874707, 0.99727854, 0.99465292, 0.99992509, 1.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_ij_gauss</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.        , 0.99971672, 0.99856265, 0.99806185, 0.99874706],
       [0.99971672, 1.        , 0.99955454, 0.99630728, 0.99727852],
       [0.99856265, 0.99955454, 1.        , 0.99332881, 0.99465289],
       [0.99806185, 0.99630728, 0.99332881, 1.        , 0.99992509],
       [0.99874706, 0.99727852, 0.99465289, 0.99992509, 1.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_ij</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-16.33883597, -16.32232795, -16.28848868, -16.33719695,
        -16.34268981],
       [-16.32232795, -16.30615691, -16.27272394, -16.31966144,
        -16.32538123],
       [-16.28848868, -16.27272394, -16.23977208, -16.28454017,
        -16.29054791],
       [-16.33719695, -16.31966144, -16.28454017, -16.33845084,
        -16.34333407],
       [-16.34268981, -16.32538123, -16.29054791, -16.34333407,
        -16.34834175]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_ij_gauss</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-16.33303286, -16.31471664, -16.27885252, -16.33719665,
        -16.34140312],
       [-16.31471664, -16.29657338, -16.26092805, -16.31835615,
        -16.32268105],
       [-16.27885252, -16.26092805, -16.22554953, -16.28178619,
        -16.28627472],
       [-16.33719665, -16.31835615, -16.28178619, -16.34271407,
        -16.3466421 ],
       [-16.34140312, -16.32268105, -16.28627472, -16.3466421 ,
        -16.35062341]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make an array of square wells, specified by an array of parameters</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_pts</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">r_max</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="n">gauss_pts</span> <span class="o">=</span> <span class="mi">48</span>

<span class="n">sw_params_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">24.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">22.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>  

<span class="n">sw_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">SquareWell</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span>
                       <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span> <span class="k">for</span> 
             <span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sw_params_array</span><span class="p">]</span>

<span class="c1"># Make an EVC object</span>
<span class="n">my_evc</span> <span class="o">=</span> <span class="n">EigenvectorContinuationScattering</span><span class="p">(</span><span class="n">sw_array</span><span class="p">)</span>

<span class="n">test_V0</span> <span class="o">=</span> <span class="mf">3.</span>
<span class="n">test_R</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">test_mu</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">test_theta</span> <span class="o">=</span> <span class="p">[</span><span class="n">test_V0</span><span class="p">,</span> <span class="n">test_R</span><span class="p">]</span>
<span class="n">test_sw</span> <span class="o">=</span> <span class="n">SquareWell</span><span class="p">(</span><span class="n">test_V0</span><span class="p">,</span> <span class="n">test_R</span><span class="p">,</span> <span class="n">test_mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> 
                     <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span> <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;exact energy = </span><span class="si">{</span><span class="n">test_sw</span><span class="o">.</span><span class="n">E0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Results first for Simpsons rule and then Gauss quadrature&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sw_array</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> i = </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;    R = </span><span class="si">{</span><span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  V0 = </span><span class="si">{</span><span class="p">[</span><span class="n">sw</span><span class="o">.</span><span class="n">V0</span> <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">my_evc</span><span class="o">.</span><span class="n">find_EVC</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">test_theta</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">eigvals</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  cond. #: N = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  H = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1">#print(f&#39;\n gaussian quadrature&#39;)</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">my_evc</span><span class="o">.</span><span class="n">find_EVC_gauss</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">test_theta</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">eigvals</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  cond. #: N = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  H = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>exact energy = -0.7814787638827644
Results first for Simpsons rule and then Gauss quadrature

 i = 1     R = 1.0   V0 = [24.0]
[0.30189188]   cond. #: N = 1.00e+00   H = 1.00e+00
[0.29741138]   cond. #: N = 1.00e+00   H = 1.00e+00

 i = 2     R = 1.0   V0 = [24.0, 22.0]
[-0.46438008  6.70629251]   cond. #: N = 2.67e+04   H = 6.51e+02
[-0.45809118  6.76167937]   cond. #: N = 2.67e+04   H = 6.34e+02

 i = 3     R = 1.0   V0 = [24.0, 22.0, 20.0]
[-0.67156779  4.50090185 14.16295074]   cond. #: N = 8.13e+07   H = 1.49e+06
[-0.67688946  4.49439599 14.33980166]   cond. #: N = 8.13e+07   H = 1.43e+06

 i = 4     R = 1.0   V0 = [24.0, 22.0, 20.0, 18.0]
[-0.74918121  2.6936265   9.36000086 25.28174185]   cond. #: N = 5.96e+10   H = 1.10e+09
[-0.74482146  2.70080677  9.34852972 25.58510323]   cond. #: N = 5.96e+10   H = 1.09e+09

 i = 5     R = 1.0   V0 = [24.0, 22.0, 20.0, 18.0, 16.0]
[-0.76731216  1.79459111  5.85543871 15.34799993 39.21134009]   cond. #: N = 1.57e+13   H = 2.53e+11
[-0.76905687  1.79548543  5.90882389 15.33415673 39.62750703]   cond. #: N = 1.57e+13   H = 2.44e+11
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_ij</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.        , 0.99992509],
       [0.99992509, 1.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_ij_gauss</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.        , 0.99992509],
       [0.99992509, 1.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_ij</span><span class="p">(</span><span class="mi">2</span><span class="p">,[</span><span class="mf">3.</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.30189188, 0.27475401],
       [0.27475401, 0.24851012]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_ij_gauss</span><span class="p">(</span><span class="mi">2</span><span class="p">,[</span><span class="mf">3.</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.29741138, 0.27033951],
       [0.27033951, 0.24417153]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sw_array</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ground state energy E0 = </span><span class="si">{</span><span class="n">sw</span><span class="o">.</span><span class="n">E0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">Egs_wf</span> <span class="o">=</span> <span class="n">sw</span><span class="o">.</span><span class="n">E0_wf_simps</span>
    <span class="c1">#print(len(sw.r_pts), len(Egs_wf))</span>
    <span class="c1">#print(&#39;normalization = &#39;, simps(Egs_wf**2, sw.r_mesh.r_pts))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;normalization = &#39;</span><span class="p">,</span> <span class="n">SW_matrix_element_simps</span><span class="p">(</span><span class="n">Egs_wf</span><span class="p">,</span> <span class="n">Egs_wf</span><span class="p">,</span> <span class="n">sw</span><span class="o">.</span><span class="n">r_mesh</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gauss normalization = &#39;</span><span class="p">,</span> <span class="n">SW_matrix_element_gauss</span><span class="p">(</span><span class="n">Egs_wf_gauss</span><span class="p">,</span> 
                                                            <span class="n">Egs_wf_gauss</span><span class="p">,</span> 
                                                            <span class="n">sw</span><span class="o">.</span><span class="n">gauss_mesh</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span>
                                                            <span class="n">sw</span><span class="o">.</span><span class="n">gauss_mesh</span><span class="o">.</span><span class="n">weights</span>
                                                           <span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1">#print(&#39;normalization = &#39;, simps(sw.E0_wf**2, sw.r_mesh.r_pts),&#39;\n&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ground state energy E0 = -20.258037705197633
normalization =  0.9999999999999997
gauss normalization =  1.0000000000000002


ground state energy E0 = -18.302952231956443
normalization =  1.0000000000000002
gauss normalization =  1.0000000000000002


ground state energy E0 = -16.353799211781638
normalization =  0.9999999999999997
gauss normalization =  1.0000000000000002


ground state energy E0 = -14.412060528881355
normalization =  0.9999999999999993
gauss normalization =  1.0000000000000002


ground state energy E0 = -12.4798064254845
normalization =  0.9999999999999998
gauss normalization =  1.0000000000000002
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make an array of square wells, specified by an array of parameters</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_pts</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">r_max</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="n">gauss_pts</span> <span class="o">=</span> <span class="mi">48</span>

<span class="n">sw_params_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">24.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">22.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">20.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">16.</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>  

<span class="n">sw_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">SquareWell</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span>
                       <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span> <span class="k">for</span> 
             <span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sw_params_array</span><span class="p">]</span>

<span class="c1"># Make an EVC object</span>
<span class="n">my_evc</span> <span class="o">=</span> <span class="n">EigenvectorContinuationScattering</span><span class="p">(</span><span class="n">sw_array</span><span class="p">)</span>

<span class="n">test_V0</span> <span class="o">=</span> <span class="mf">5.</span>
<span class="n">test_R</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">test_mu</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">test_theta</span> <span class="o">=</span> <span class="p">[</span><span class="n">test_V0</span><span class="p">,</span> <span class="n">test_R</span><span class="p">]</span>
<span class="n">test_sw</span> <span class="o">=</span> <span class="n">SquareWell</span><span class="p">(</span><span class="n">test_V0</span><span class="p">,</span> <span class="n">test_R</span><span class="p">,</span> <span class="n">test_mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> 
                     <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span> <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;exact energy = </span><span class="si">{</span><span class="n">test_sw</span><span class="o">.</span><span class="n">E0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Results first for Simpsons rule and then Gauss quadrature&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sw_array</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> i = </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;    R = </span><span class="si">{</span><span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  V0 = </span><span class="si">{</span><span class="p">[</span><span class="n">sw</span><span class="o">.</span><span class="n">V0</span> <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">my_evc</span><span class="o">.</span><span class="n">find_EVC</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">test_theta</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">eigvals</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  cond. #: N = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  H = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1">#print(f&#39;\n gaussian quadrature&#39;)</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">my_evc</span><span class="o">.</span><span class="n">find_EVC_gauss</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">test_theta</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">eigvals</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  cond. #: N = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  H = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>exact energy = -2.3120970431648895
Results first for Simpsons rule and then Gauss quadrature

 i = 1     R = 1.0   V0 = [24.0]
[-1.65011743]   cond. #: N = 1.00e+00   H = 1.00e+00
[-1.66025044]   cond. #: N = 1.00e+00   H = 1.00e+00

 i = 2     R = 1.0   V0 = [24.0, 22.0]
[-2.2075008   5.64063034]   cond. #: N = 2.67e+04   H = 6.01e+03
[-2.19659808  5.79354606]   cond. #: N = 2.67e+04   H = 5.95e+03

 i = 3     R = 1.0   V0 = [24.0, 22.0, 20.0]
[-2.28572236  3.93514778 13.01310343]   cond. #: N = 8.13e+07   H = 1.44e+07
[-2.29157556  3.92440304 13.45539532]   cond. #: N = 8.13e+07   H = 1.43e+07

 i = 4     R = 1.0   V0 = [24.0, 22.0, 20.0, 18.0]
[-2.31495008  2.23349256  8.72979237 24.21477921]   cond. #: N = 5.96e+10   H = 1.02e+10
[-2.30846819  2.275386    8.72615377 24.94386915]   cond. #: N = 5.96e+10   H = 1.01e+10

 i = 5     R = 1.0   V0 = [24.0, 22.0, 20.0, 18.0, 16.0]
[-2.31498937  1.53225461  5.18918833 14.80814986 38.12354908]   cond. #: N = 1.57e+13   H = 2.47e+12
[-2.31153379  1.5276504   5.36490851 14.80434973 39.1469337 ]   cond. #: N = 1.57e+13   H = 2.46e+12
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_ij</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.        , 0.99992509, 0.9996536 , 0.99908617, 0.99806185],
       [0.99992509, 1.        , 0.9999008 , 0.99953403, 0.99874706],
       [0.9996536 , 0.9999008 , 1.        , 0.99986471, 0.99935205],
       [0.99908617, 0.99953403, 0.99986471, 1.        , 0.99980869],
       [0.99806185, 0.99874706, 0.99935205, 0.99980869, 1.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_ij_gauss</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.        , 0.99992509, 0.9996536 , 0.99908617, 0.99806185],
       [0.99992509, 1.        , 0.9999008 , 0.99953403, 0.99874706],
       [0.9996536 , 0.9999008 , 1.        , 0.99986471, 0.99935205],
       [0.99908617, 0.99953403, 0.99986471, 1.        , 0.99980869],
       [0.99806185, 0.99874706, 0.99935205, 0.99980869, 1.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_ij</span><span class="p">(</span><span class="mi">5</span><span class="p">,[</span><span class="mf">24.</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-20.25803771, -20.25707187, -20.25216499, -20.24131203,
        -20.22126306],
       [-20.25707187, -20.25642265, -20.25187253, -20.24142767,
        -20.22185427],
       [-20.25216499, -20.25187253, -20.24772297, -20.23773458,
        -20.2186911 ],
       [-20.24131203, -20.24142767, -20.23773458, -20.22826429,
        -20.20981975],
       [-20.22126306, -20.22185427, -20.2186911 , -20.20981975,
        -20.19206459]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_ij_gauss</span><span class="p">(</span><span class="mi">5</span><span class="p">,[</span><span class="mf">24.</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-20.25803771, -20.25652013, -20.25102029, -20.23952525,
        -20.2187746 ],
       [-20.25652013, -20.25528105, -20.25009618, -20.238963  ,
        -20.21863628],
       [-20.25102029, -20.25009618, -20.24526608, -20.23453873,
        -20.21468536],
       [-20.23952525, -20.238963  , -20.23453873, -20.22427351,
        -20.20495659],
       [-20.2187746 , -20.21863628, -20.21468536, -20.20495659,
        -20.18625929]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make an array of square wells, specified by an array of parameters</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_pts</span> <span class="o">=</span> <span class="mi">4000</span>
<span class="n">r_max</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="n">gauss_pts</span> <span class="o">=</span> <span class="mi">48</span>

<span class="n">sw_params_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">7.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">4.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">8.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>  

<span class="n">sw_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">SquareWell</span><span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span>
                       <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span> <span class="k">for</span> 
             <span class="p">(</span><span class="n">V0</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span> <span class="ow">in</span> <span class="n">sw_params_array</span><span class="p">]</span>

<span class="c1"># Make an EVC object</span>
<span class="n">my_evc</span> <span class="o">=</span> <span class="n">EigenvectorContinuationScattering</span><span class="p">(</span><span class="n">sw_array</span><span class="p">)</span>

<span class="n">test_V0</span> <span class="o">=</span> <span class="mf">3.</span>
<span class="n">test_R</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">test_mu</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="n">test_theta</span> <span class="o">=</span> <span class="p">[</span><span class="n">test_V0</span><span class="p">,</span> <span class="n">test_R</span><span class="p">]</span>
<span class="n">test_sw</span> <span class="o">=</span> <span class="n">SquareWell</span><span class="p">(</span><span class="n">test_V0</span><span class="p">,</span> <span class="n">test_R</span><span class="p">,</span> <span class="n">test_mu</span><span class="p">,</span> <span class="n">num_pts</span><span class="o">=</span><span class="n">num_pts</span><span class="p">,</span> 
                     <span class="n">gauss_pts</span><span class="o">=</span><span class="n">gauss_pts</span><span class="p">,</span> <span class="n">r_max</span><span class="o">=</span><span class="n">r_max</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;exact energy = </span><span class="si">{</span><span class="n">test_sw</span><span class="o">.</span><span class="n">E0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Results first for Simpsons rule and then Gauss quadrature&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sw_array</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> i = </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;    R = </span><span class="si">{</span><span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">R</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  V0 = </span><span class="si">{</span><span class="p">[</span><span class="n">sw</span><span class="o">.</span><span class="n">V0</span> <span class="k">for</span> <span class="n">sw</span> <span class="ow">in</span> <span class="n">sw_array</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">]]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">my_evc</span><span class="o">.</span><span class="n">find_EVC</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">test_theta</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">eigvals</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  cond. #: N = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  H = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1">#print(f&#39;\n gaussian quadrature&#39;)</span>
    <span class="n">eigvals</span> <span class="o">=</span> <span class="n">my_evc</span><span class="o">.</span><span class="n">find_EVC_gauss</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">test_theta</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">eigvals</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  cond. #: N = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
          <span class="sa">f</span><span class="s1">&#39;  H = </span><span class="si">{</span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_cond_num</span><span class="si">:</span><span class="s1">.2e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>exact energy = -0.7814787638827644
Results first for Simpsons rule and then Gauss quadrature

 i = 1     R = 1.0   V0 = [7.0]
[-0.4744397]   cond. #: N = 1.00e+00   H = 1.00e+00
[-0.47939493]   cond. #: N = 1.00e+00   H = 1.00e+00

 i = 2     R = 1.0   V0 = [7.0, 6.0]
[-0.75980523  3.08639653]   cond. #: N = 1.87e+03   H = 2.15e+02
[-0.75791982  3.10044158]   cond. #: N = 1.87e+03   H = 2.19e+02

 i = 3     R = 1.0   V0 = [7.0, 6.0, 5.0]
[-0.7795379   1.25533932  5.45975008]   cond. #: N = 4.61e+05   H = 1.06e+05
[-0.78002261  1.25747858  5.51115373]   cond. #: N = 4.61e+05   H = 1.06e+05

 i = 4     R = 1.0   V0 = [7.0, 6.0, 5.0, 4.0]
[-0.78175839  0.51296682  2.66881868  7.38893021]   cond. #: N = 2.52e+07   H = 7.76e+06
[-0.78144144  0.51162894  2.66893067  7.4841935 ]   cond. #: N = 2.52e+07   H = 7.80e+06

 i = 5     R = 1.0   V0 = [7.0, 6.0, 5.0, 4.0, 8.0]
[-0.78187931  0.35043184  1.60802036  4.8507888  10.91728982]   cond. #: N = 4.13e+09   H = 1.01e+09
[-0.78147208  0.3515364   1.6077766   4.84401265 11.11386098]   cond. #: N = 4.13e+09   H = 1.00e+09
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">N_ij_gauss</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1.        , 0.99892828, 0.99417084, 0.98085107, 0.99933967],
       [0.99892828, 1.        , 0.99808419, 0.98869493, 0.99659405],
       [0.99417084, 0.99808419, 1.        , 0.99603559, 0.98964657],
       [0.98085107, 0.98869493, 0.99603559, 1.        , 0.9733523 ],
       [0.99933967, 0.99659405, 0.98964657, 0.9733523 , 1.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_evc</span><span class="o">.</span><span class="n">H_ij_gauss</span><span class="p">(</span><span class="mi">5</span><span class="p">,[</span><span class="mf">3.</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.47939493, -0.52509835, -0.58175814, -0.65265727, -0.44189309],
       [-0.52509835, -0.56465786, -0.61374484, -0.67514625, -0.49267421],
       [-0.58175814, -0.61374484, -0.65337537, -0.70271689, -0.55552672],
       [-0.65265727, -0.67514625, -0.70271689, -0.73634278, -0.63408849],
       [-0.44189309, -0.49267421, -0.55552672, -0.63408849, -0.40015827]])
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "furnstahl/Physics-8820",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/Gaussian_processes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Dick Furnstahl<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>