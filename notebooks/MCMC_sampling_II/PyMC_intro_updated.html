

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>6.6. PyMC Introduction &#8212; Learning from data</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/myadmonitions.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"N": ["\\mathbb{N}"], "Z": ["\\mathbb{Z}"], "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"], "alphavec": ["\\boldsymbol{\\alpha}"], "muvec": ["\\boldsymbol{\\mu}"], "phivec": ["\\boldsymbol{\\phi}"], "sigmavec": ["\\boldsymbol{\\sigma}"], "Sigmavec": ["\\boldsymbol{\\Sigma}"], "thetavec": ["\\boldsymbol{\\theta}"], "thetavechat": ["\\widehat\\thetavec"], "avec": ["\\boldsymbol{a}"], "Bvec": ["\\boldsymbol{B}"], "fvec": ["\\boldsymbol{f}"], "mvec": ["\\boldsymbol{m}"], "qvec": ["\\boldsymbol{q}"], "rvec": ["\\boldsymbol{r}"], "uvec": ["\\boldsymbol{u}"], "wvec": ["\\boldsymbol{w}"], "xvec": ["\\boldsymbol{x}"], "yvec": ["\\boldsymbol{y}"], "Lra": ["\\Longrightarrow"], "abar": ["\\overline a"], "Xbar": ["\\overline X"], "alphahat": ["\\widehat\\alpha"], "Hhat": ["\\hat H"], "yth": ["y_{\\text{th}}"], "yexp": ["y_{\\text{exp}}"], "ym": ["y_{\\text{m}}"], "gs": ["{0}"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/MCMC_sampling_II/PyMC_intro_updated';</script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.7. Introductory Overview of PyMC" href="getting_started_with_pymc.html" />
    <link rel="prev" title="6.5. Lecture 18" href="../../content/MCMC_sampling_II/lecture_18.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../../about.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/buqeye_logo_web.png" class="logo__image only-light" alt="Learning from data - Home"/>
    <script>document.write(`<img src="../../_static/buqeye_logo_web.png" class="logo__image only-dark" alt="Learning from data - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../about.html">
                    About this Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Course overview</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../content/Course/overview.html">Objectives</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Topics</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Basics/basics.html">1. Basics of Bayesian statistics</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Basics/lecture_01.html">1.1. Lecture 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Basics/Exploring_pdfs.html">1.2. Exploring PDFs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Basics/simple_sum_product_rule.html">1.3. Checking the sum and product rules, and their consequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Basics/lecture_02.html">1.4. Lecture 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Basics/Bayesian_updating_coinflip_interactive.html">1.5. Interactive Bayesian updating: coin flipping example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Basics/medical_example_by_Bayes.html">1.6. Standard medical example by applying Bayesian rules of probability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Basics/lecture_03.html">1.7. Lecture 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Basics/parameter_estimation_Gaussian_noise.html">1.8. Parameter estimation example: Gaussian noise and averages I</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Basics/radioactive_lighthouse_exercise.html">1.9. Radioactive lighthouse problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Basics/lecture_04.html">1.10. Lecture 4: A couple of frequentist connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Basics/visualization_of_CLT.html">1.11. Visualization of the Central Limit Theorem</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Parameter_estimation/param_est.html">2. Bayesian parameter estimation</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Parameter_estimation/lecture_05.html">2.1. Lecture 5: Parameter estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Parameter_estimation/parameter_estimation_fitting_straight_line_I.html">2.2. Parameter estimation example: fitting a straight line</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Parameter_estimation/lecture_06.html">2.3. Lecture 6</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Parameter_estimation/amplitude_in_presence_of_background.html">2.4. Amplitude of a signal in the presence of background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Parameter_estimation/demo-ModelValidation.html">2.5. Linear Regression and Model Validation demonstration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assignments/Assignment_parameter_estimation_followups.html">2.6. Assignment: Follow-ups to Parameter Estimation notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Parameter_estimation/exercise_LinearRegression.html">2.7. Linear Regression exercise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Parameter_estimation/linear_algebra_games_I.html">2.8. Linear algebra games including SVD for PCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assignments/fluctuation_trend_with_number_of_points_and_data_errors.html">2.9. Follow-up: fluctuation trends with # of points and data errors</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/MCMC_sampling_I/MCMC_sampling_I.html">3. MCMC sampling I</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/MCMC_sampling_I/lecture_07.html">3.1. Lecture 7</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MCMC_sampling_I/Metropolis_Poisson_example.html">3.2. Metropolis-Hasting MCMC sampling of a Poisson distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/MCMC_sampling_I/lecture_08.html">3.3. Lecture 8</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MCMC_sampling_I/parameter_estimation_Gaussian_noise-2.html">3.4. Parameter estimation example: Gaussian noise and averages II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MCMC_sampling_I/MCMC-random-walk-and-sampling.html">3.5. Exercise: Random walk</a></li>
<li class="toctree-l2"><a class="reference internal" href="../MCMC_sampling_I/MCMC-diagnostics.html">3.6. Overview: MCMC Diagnostics</a></li>

<li class="toctree-l2"><a class="reference internal" href="../assignments/Assignment_extending_radioactive_lighthouse.html">3.8. Assignment: 2D radioactive lighthouse location using MCMC</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Why_Bayes_is_better/bayes_is_better.html">4. Why Bayes is better</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Why_Bayes_is_better/lecture_09.html">4.1. Lecture 9</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Why_Bayes_is_better/bayes_billiard.html">4.2. A Bayesian Billiard game</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Why_Bayes_is_better/lecture_10.html">4.3. Lecture 10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Why_Bayes_is_better/parameter_estimation_fitting_straight_line_II.html">4.4. Parameter estimation example: fitting a straight line II</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Why_Bayes_is_better/lecture_11.html">4.5. Lecture 11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Why_Bayes_is_better/error_propagation_to_functions_of_uncertain_parameters.html">4.6. Error propagation: Example 3.6.2 in Sivia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Basics/correlation_intuition.html">4.7. Building intuition about correlations (and a bit of Python linear algebra)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Why_Bayes_is_better/lecture_12.html">4.8. Lecture 12</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Why_Bayes_is_better/lecture_13.html">4.9. Lecture 13</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Why_Bayes_is_better/dealing_with_outliers.html">4.10. Dealing with outliers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Model_selection/model_selection.html">5. Model selection</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Model_selection/lecture_14.html">5.1. Lecture 14</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Model_selection/lecture_15.html">5.2. Lecture 15</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Model_selection/Evidence_for_model_EFT_coefficients.html">5.3. Evidence calculation for EFT expansions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Model_selection/lecture_16.html">5.4. Lecture 16</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mini-projects/MCMC-parallel-tempering_ptemcee.html">5.5. Example: Parallel tempering for multimodal distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mini-projects/MCMC-parallel-tempering_ptemcee_vs_zeus.html">5.6. Example: Parallel tempering for multimodal distributions vs. zeus</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../content/MCMC_sampling_II/MCMC_sampling_II.html">6. MCMC sampling II</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../content/MCMC_sampling_II/lecture_17.html">6.1. Lecture 17</a></li>
<li class="toctree-l2"><a class="reference internal" href="chi_squared_tests.html">6.2. Quick check of the distribution of normal variables squared</a></li>
<li class="toctree-l2"><a class="reference internal" href="Liouville_theorem_visualization.html">6.3. Liouville Theorem Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="Orbital_eqs_with_different_algorithms.html">6.4. Solving orbital equations with different algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/MCMC_sampling_II/lecture_18.html">6.5. Lecture 18</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.6. PyMC Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started_with_pymc.html">6.7. Introductory Overview of PyMC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Parameter_estimation/parameter_estimation_Gaussian_noise_compare_samplers.html">6.8. Comparing samplers for a simple problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mini-projects/zeus_multimodal.html">6.9. zeus: Sampling from multimodal distributions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Gaussian_processes/gaussian_processes.html">7. Gaussian processes</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Gaussian_processes/lecture_19.html">7.1. Lecture 19</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gaussian_processes/demo-GaussianProcesses.html">7.2. Gaussian processes demonstration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gaussian_processes/GaussianProcesses.html">7.3. Learning from data: Gaussian processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Gaussian_processes/Gaussian_processes_exercises.html">7.4. Exercise: Gaussian Process models with GPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Gaussian_processes/lecture_20.html">7.5. Lecture 20</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Maximum_entropy/max_ent.html">8. Assigning probabilities</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Maximum_entropy/lecture_21.html">8.1. Lecture 21</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Maximum_entropy/MaxEnt.html">8.2. Ignorance pdfs: Indifference and translation groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Maximum_entropy/Pdfs_from_MaxEnt.html">8.3. MaxEnt for deriving some probability distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Maximum_entropy/MaxEnt_Function_Reconstruction.html">8.4. Maximum Entropy for reconstructing a function from its moments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Maximum_entropy/demo-MaxEnt.html">8.5. Making figures for Ignorance PDF notebook</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Machine_learning/machine_learning.html">9. Machine learning: Bayesian methods</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/Machine_learning/lecture_22.html">9.1. Lecture 22</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Machine_learning/Bayesian_optimization.html">9.2. Bayesian Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Machine_learning/lecture_23.html">9.3. Lecture 23</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Machine_learning/Neural_networks_explained.html">9.4. What Are Neural Networks?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Machine_learning/Forssen_tif285_NeuralNet.html">9.5. Neural networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Machine_learning/Forssen_tif285_demo-NeuralNet.html">9.6. Neural network classifier demonstration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Machine_learning/Bayesian_neural_networks_tif285.html">9.7. Bayesian neural networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Machine_learning/lecture_24.html">9.8. Lecture 24</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Machine_learning/demo-Bayesian_neural_networks_tif285.html">9.9. Variational Inference: Bayesian Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Machine_learning/Convolutional_neural_network_explained.html">9.10. What is a convolutional neural network?</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/SVD/svd.html">10. PCA, SVD, and all that</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../content/SVD/lecture_25.html">10.1. Lecture 25</a></li>
<li class="toctree-l2"><a class="reference internal" href="../SVD/linear_algebra_games_including_SVD.html">10.2. Linear algebra games including SVD for PCA</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Mini-projects</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../mini-projects/mini-project_I_toy_model_of_EFT.html">Mini-project I: Parameter estimation for a toy model of an EFT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mini-projects/model-selection_mini-project-IIa.html">Mini-project IIa: Model selection basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mini-projects/model-selection_mini-project-IIb_How_many_lines_ptemcee.html">Mini-project IIb: How many lines?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mini-projects/mini-project_IIIa_bayesian_optimization.html">Mini-project IIIa: Bayesian optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mini-projects/mini-project_IIIb_Bayesian_neural_networks_from_demo.html">Mini-project IIIb: Bayesian Neural Networks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference material</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../content/zbibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../content/Reference/installing_anaconda.html">Using Anaconda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../content/Reference/using_github.html">Using GitHub</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Reference/python_jupyter.html">Python and Jupyter notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Reference/Jupyter_Python_intro_01.html">Python and Jupyter notebooks: part 01</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Reference/Jupyter_Python_intro_02.html">Python and Jupyter notebooks: part 02</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Reference/Simple_widgets_v1.html">Simple widgets</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../content/jb_tests.html">Examples: Jupyter jb-book</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../content/Related/related_topics.html">Related topics</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../Development/Student_t_distribution_from_Gaussians.html">Student t from Gaussians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../content/Related/qbism.html">QBism</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Notebook keys</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../Basics/simple_sum_product_rule_KEY.html">Checking the sum and product rules, and their consequences <span style="color: red">Key</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Basics/medical_example_by_Bayes_KEY.html">Standard medical example by applying Bayesian rules of probability <span style="color: red">Key</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../Basics/radioactive_lighthouse_exercise_key.html">Radioactive lighthouse problem  <span style="color: red">Key</span></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/buqeye/LearningFromData/main?urlpath=tree/./LectureNotes/notebooks/MCMC_sampling_II/PyMC_intro_updated.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/buqeye/LearningFromData" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/buqeye/LearningFromData/issues/new?title=Issue%20on%20page%20%2Fnotebooks/MCMC_sampling_II/PyMC_intro_updated.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/MCMC_sampling_II/PyMC_intro_updated.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PyMC Introduction</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-setup-of-a-model">Basic setup of a model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling">Sampling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#available-samplers">Available samplers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-sampling-results">Analyze sampling results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostics">Diagnostics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-from-rob-hicks">Examples from Rob Hicks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymc3-implementation">PyMC3 implementation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelation-plots">Autocorrelation plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acceptance-rate">Acceptance rate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inferencedata-object">InferenceData object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gelman-rubin-diagnostic-quoted-verbatim-from-the-hicks-notebook">Gelman Rubin Diagnostic (quoted verbatim from the Hicks notebook)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-exercise">In-class exercise</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pymc-introduction">
<h1><span class="section-number">6.6. </span>PyMC Introduction<a class="headerlink" href="#pymc-introduction" title="Permalink to this heading">#</a></h1>
<p>Last revised 25-Oct-2021 by Dick Furnstahl (<a class="reference external" href="mailto:furnstahl&#46;1&#37;&#52;&#48;osu&#46;edu">furnstahl<span>&#46;</span>1<span>&#64;</span>osu<span>&#46;</span>edu</a>);</p>
<p>Further revisions Dec-2023 by Daniel Phillips for PyMC3-&gt;PyMC</p>
<p>A good starting point for notebooks with PyMC examples is the official documentation site: <a class="reference external" href="https://docs.pymc.io/">https://docs.pymc.io/</a>.  We’ve adapted some examples from that site here and in other notebooks.</p>
<p><strong>Aside.</strong> Here is a good quote from Rob Hicks on HMC and No U-Turn:</p>
<p>“The idea: rather than blindly stumbling around the posterior, use the posterior gradient to skate around the gradient contour. As you skate closer to a drop-off (gradient is steep and probability is lower), potential energy decreases and kinetic energy increases (since energy is always conserved). When this happens the skater is turned back uphill and pushed from the precipice and skates on along a posterior likelihood contour. The No U-Turn sampler keeps skating until the skater tries to turn back towards the original point.”</p>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>

<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">pymc</span> <span class="k">as</span> <span class="nn">pm</span>

<span class="c1"># Recommended: document what PyMC3 version we are using</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Running on PyMC v</span><span class="si">{</span><span class="n">pm</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running on PyMC v5.10.2
</pre></div>
</div>
</div>
</div>
</section>
<section id="basic-setup-of-a-model">
<h2>Basic setup of a model<a class="headerlink" href="#basic-setup-of-a-model" title="Permalink to this heading">#</a></h2>
<p>First we need to create a <em>model</em>, which will be an instance of the Model class.  The model has references to all random variables (RVs) and computes the model log posterior (logp) and its gradients.  We typically instantiate it using a with context.  For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">my_model</span><span class="p">:</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>So <code class="docutils literal notranslate"><span class="pre">my_model</span></code> is an instance of the PyMC Model class, and we have set up a prior for <code class="docutils literal notranslate"><span class="pre">mu</span></code> in the form of a standard normal distribution (i.e., mean = 0 and standard deviation = 1).  The last line sets up the likelihood, also distributed as a normal with observed data taken as 100 random draws from a standard normal distribution.  The standard deviation sigma for the mu posterior is given.  The goal will be to sample the posterior for mu.</p>
</section>
<section id="sampling">
<h2>Sampling<a class="headerlink" href="#sampling" title="Permalink to this heading">#</a></h2>
<p>The main entry point to MCMC sampling algorithms is via the <code class="docutils literal notranslate"><span class="pre">pm.sample()</span></code> function. By default, this function tries to auto-assign the right sampler(s) and auto-initialize if you don’t pass anything.</p>
<p>As you can see, on a continuous model, <code class="docutils literal notranslate"><span class="pre">PyMC</span></code> assigns the NUTS sampler, which is very efficient even for complex models. <code class="docutils literal notranslate"><span class="pre">PyMC</span></code> also runs variational inference (i.e. <code class="docutils literal notranslate"><span class="pre">ADVI</span></code>) to find good starting parameters for the sampler. Here we draw 1000 samples from the posterior and allow the sampler to adjust its parameters in an additional 500 iterations. These 500 samples are discarded by default:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">my_NUTS_model</span><span class="p">:</span>
    <span class="n">avg</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;avg&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="n">avg</span>
    
    <span class="n">obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>

    <span class="n">trace_NUTS</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR (pytensor.graph.rewriting.basic): Rewrite failure due to: constant_folding
ERROR (pytensor.graph.rewriting.basic): node: Cast{float64}(0)
ERROR (pytensor.graph.rewriting.basic): TRACEBACK:
ERROR (pytensor.graph.rewriting.basic): Traceback (most recent call last):
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/graph/rewriting/basic.py&quot;, line 1922, in process_node
    replacements = node_rewriter.transform(fgraph, node)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/graph/rewriting/basic.py&quot;, line 1082, in transform
    return self.fn(fgraph, node)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/tensor/rewriting/basic.py&quot;, line 1105, in constant_folding
    thunk = node.op.make_thunk(node, storage_map, compute_map, no_recycling=[])
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/op.py&quot;, line 119, in make_thunk
    return self.make_c_thunk(node, storage_map, compute_map, no_recycling)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/op.py&quot;, line 84, in make_c_thunk
    outputs = cl.make_thunk(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1209, in make_thunk
    cthunk, module, in_storage, out_storage, error_storage = self.__compile__(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1129, in __compile__
    thunk, module = self.cthunk_factory(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1653, in cthunk_factory
    module = cache.module_from_key(key=key, lnk=self)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/cmodule.py&quot;, line 1231, in module_from_key
    module = lnk.compile_cmodule(location)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1552, in compile_cmodule
    module = c_compiler.compile_str(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/cmodule.py&quot;, line 2640, in compile_str
    raise CompileError(
pytensor.link.c.exceptions.CompileError: Compilation failed (return status=1):
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/clang++ -dynamiclib -g -O3 -fno-math-errno -Wno-unused-label -Wno-unused-variable -Wno-write-strings -Wno-c++11-narrowing -fno-exceptions -fno-unwind-tables -fno-asynchronous-unwind-tables -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -m64 -fPIC -undefined dynamic_lookup -I/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/numpy/core/include -I/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10 -I/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/c_code -L/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib -fvisibility=hidden -o /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpi2h6562a/maf7dfc2b98019ae231490759913de9c7eae2cf26062201cb60a34079dffa7f98.so /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpi2h6562a/mod.cpp
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpi2h6562a/mod.cpp:1:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:27:5: error: &quot;Python.h requires that stdio.h define NULL.&quot;
#   error &quot;Python.h requires that stdio.h define NULL.&quot;
    ^
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpi2h6562a/mod.cpp:1:
In file included from /Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:30:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/string.h:95:102: error: unknown type name &#39;size_t&#39;
inline _LIBCPP_HIDE_FROM_ABI _LIBCPP_PREFERRED_OVERLOAD const void* memchr(const void* __s, int __c, size_t __n) {
                                                                                                     ^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/string.h:98:90: error: unknown type name &#39;size_t&#39;
inline _LIBCPP_HIDE_FROM_ABI _LIBCPP_PREFERRED_OVERLOAD void* memchr(void* __s, int __c, size_t __n) {
                                                                                         ^
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpi2h6562a/mod.cpp:1:
In file included from /Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:34:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:150:34: error: unknown type name &#39;ldiv_t&#39;
inline _LIBCPP_INLINE_VISIBILITY ldiv_t div(long __x, long __y) _NOEXCEPT {
                                 ^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:151:12: error: no member named &#39;ldiv&#39; in the global namespace
  return ::ldiv(__x, __y);
         ~~^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:154:34: error: unknown type name &#39;lldiv_t&#39;
inline _LIBCPP_INLINE_VISIBILITY lldiv_t div(long long __x,
                                 ^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:156:12: error: no member named &#39;lldiv&#39; in the global namespace
  return ::lldiv(__x, __y);
         ~~^
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpi2h6562a/mod.cpp:1:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:36:10: fatal error: &#39;unistd.h&#39; file not found
#include &lt;unistd.h&gt;
         ^~~~~~~~~~
8 errors generated.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You can find the C code in this temporary file: /var/folders/1s/3wbqg65x5k79l5ww8fg25yvh0000gn/T/pytensor_compilation_error_ip7li_2_
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR (pytensor.graph.rewriting.basic): Rewrite failure due to: constant_folding
ERROR (pytensor.graph.rewriting.basic): node: Cast{float64}(0)
ERROR (pytensor.graph.rewriting.basic): TRACEBACK:
ERROR (pytensor.graph.rewriting.basic): Traceback (most recent call last):
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/graph/rewriting/basic.py&quot;, line 1922, in process_node
    replacements = node_rewriter.transform(fgraph, node)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/graph/rewriting/basic.py&quot;, line 1082, in transform
    return self.fn(fgraph, node)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/tensor/rewriting/basic.py&quot;, line 1105, in constant_folding
    thunk = node.op.make_thunk(node, storage_map, compute_map, no_recycling=[])
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/op.py&quot;, line 119, in make_thunk
    return self.make_c_thunk(node, storage_map, compute_map, no_recycling)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/op.py&quot;, line 84, in make_c_thunk
    outputs = cl.make_thunk(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1209, in make_thunk
    cthunk, module, in_storage, out_storage, error_storage = self.__compile__(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1129, in __compile__
    thunk, module = self.cthunk_factory(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1653, in cthunk_factory
    module = cache.module_from_key(key=key, lnk=self)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/cmodule.py&quot;, line 1231, in module_from_key
    module = lnk.compile_cmodule(location)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1552, in compile_cmodule
    module = c_compiler.compile_str(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/cmodule.py&quot;, line 2640, in compile_str
    raise CompileError(
pytensor.link.c.exceptions.CompileError: Compilation failed (return status=1):
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/clang++ -dynamiclib -g -O3 -fno-math-errno -Wno-unused-label -Wno-unused-variable -Wno-write-strings -Wno-c++11-narrowing -fno-exceptions -fno-unwind-tables -fno-asynchronous-unwind-tables -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -m64 -fPIC -undefined dynamic_lookup -I/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/numpy/core/include -I/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10 -I/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/c_code -L/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib -fvisibility=hidden -o /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpsz7rwast/maf7dfc2b98019ae231490759913de9c7eae2cf26062201cb60a34079dffa7f98.so /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpsz7rwast/mod.cpp
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpsz7rwast/mod.cpp:1:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:27:5: error: &quot;Python.h requires that stdio.h define NULL.&quot;
#   error &quot;Python.h requires that stdio.h define NULL.&quot;
    ^
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpsz7rwast/mod.cpp:1:
In file included from /Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:30:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/string.h:95:102: error: unknown type name &#39;size_t&#39;
inline _LIBCPP_HIDE_FROM_ABI _LIBCPP_PREFERRED_OVERLOAD const void* memchr(const void* __s, int __c, size_t __n) {
                                                                                                     ^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/string.h:98:90: error: unknown type name &#39;size_t&#39;
inline _LIBCPP_HIDE_FROM_ABI _LIBCPP_PREFERRED_OVERLOAD void* memchr(void* __s, int __c, size_t __n) {
                                                                                         ^
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpsz7rwast/mod.cpp:1:
In file included from /Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:34:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:150:34: error: unknown type name &#39;ldiv_t&#39;
inline _LIBCPP_INLINE_VISIBILITY ldiv_t div(long __x, long __y) _NOEXCEPT {
                                 ^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:151:12: error: no member named &#39;ldiv&#39; in the global namespace
  return ::ldiv(__x, __y);
         ~~^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:154:34: error: unknown type name &#39;lldiv_t&#39;
inline _LIBCPP_INLINE_VISIBILITY lldiv_t div(long long __x,
                                 ^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:156:12: error: no member named &#39;lldiv&#39; in the global namespace
  return ::lldiv(__x, __y);
         ~~^
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpsz7rwast/mod.cpp:1:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:36:10: fatal error: &#39;unistd.h&#39; file not found
#include &lt;unistd.h&gt;
         ^~~~~~~~~~
8 errors generated.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You can find the C code in this temporary file: /var/folders/1s/3wbqg65x5k79l5ww8fg25yvh0000gn/T/pytensor_compilation_error_y7lebeyp
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ERROR (pytensor.graph.rewriting.basic): Rewrite failure due to: constant_folding
ERROR (pytensor.graph.rewriting.basic): node: Cast{float64}(0)
ERROR (pytensor.graph.rewriting.basic): TRACEBACK:
ERROR (pytensor.graph.rewriting.basic): Traceback (most recent call last):
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/graph/rewriting/basic.py&quot;, line 1922, in process_node
    replacements = node_rewriter.transform(fgraph, node)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/graph/rewriting/basic.py&quot;, line 1082, in transform
    return self.fn(fgraph, node)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/tensor/rewriting/basic.py&quot;, line 1105, in constant_folding
    thunk = node.op.make_thunk(node, storage_map, compute_map, no_recycling=[])
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/op.py&quot;, line 119, in make_thunk
    return self.make_c_thunk(node, storage_map, compute_map, no_recycling)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/op.py&quot;, line 84, in make_c_thunk
    outputs = cl.make_thunk(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1209, in make_thunk
    cthunk, module, in_storage, out_storage, error_storage = self.__compile__(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1129, in __compile__
    thunk, module = self.cthunk_factory(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1653, in cthunk_factory
    module = cache.module_from_key(key=key, lnk=self)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/cmodule.py&quot;, line 1231, in module_from_key
    module = lnk.compile_cmodule(location)
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/basic.py&quot;, line 1552, in compile_cmodule
    module = c_compiler.compile_str(
  File &quot;/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/cmodule.py&quot;, line 2640, in compile_str
    raise CompileError(
pytensor.link.c.exceptions.CompileError: Compilation failed (return status=1):
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/clang++ -dynamiclib -g -O3 -fno-math-errno -Wno-unused-label -Wno-unused-variable -Wno-write-strings -Wno-c++11-narrowing -fno-exceptions -fno-unwind-tables -fno-asynchronous-unwind-tables -DNPY_NO_DEPRECATED_API=NPY_1_7_API_VERSION -m64 -fPIC -undefined dynamic_lookup -I/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/numpy/core/include -I/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10 -I/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/c_code -L/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib -fvisibility=hidden -o /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpcy7a9tlb/maf7dfc2b98019ae231490759913de9c7eae2cf26062201cb60a34079dffa7f98.so /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpcy7a9tlb/mod.cpp
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpcy7a9tlb/mod.cpp:1:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:27:5: error: &quot;Python.h requires that stdio.h define NULL.&quot;
#   error &quot;Python.h requires that stdio.h define NULL.&quot;
    ^
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpcy7a9tlb/mod.cpp:1:
In file included from /Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:30:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/string.h:95:102: error: unknown type name &#39;size_t&#39;
inline _LIBCPP_HIDE_FROM_ABI _LIBCPP_PREFERRED_OVERLOAD const void* memchr(const void* __s, int __c, size_t __n) {
                                                                                                     ^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/string.h:98:90: error: unknown type name &#39;size_t&#39;
inline _LIBCPP_HIDE_FROM_ABI _LIBCPP_PREFERRED_OVERLOAD void* memchr(void* __s, int __c, size_t __n) {
                                                                                         ^
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpcy7a9tlb/mod.cpp:1:
In file included from /Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:34:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:150:34: error: unknown type name &#39;ldiv_t&#39;
inline _LIBCPP_INLINE_VISIBILITY ldiv_t div(long __x, long __y) _NOEXCEPT {
                                 ^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:151:12: error: no member named &#39;ldiv&#39; in the global namespace
  return ::ldiv(__x, __y);
         ~~^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:154:34: error: unknown type name &#39;lldiv_t&#39;
inline _LIBCPP_INLINE_VISIBILITY lldiv_t div(long long __x,
                                 ^
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/bin/../include/c++/v1/stdlib.h:156:12: error: no member named &#39;lldiv&#39; in the global namespace
  return ::lldiv(__x, __y);
         ~~^
In file included from /Users/furnstah/.pytensor/compiledir_macOS-14.2.1-x86_64-i386-64bit-i386-3.10.13-64/tmpcy7a9tlb/mod.cpp:1:
/Users/furnstah/Dropbox/Anaconda/anaconda3/envs/8820-book-env/include/python3.10/Python.h:36:10: fatal error: &#39;unistd.h&#39; file not found
#include &lt;unistd.h&gt;
         ^~~~~~~~~~
8 errors generated.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You can find the C code in this temporary file: /var/folders/1s/3wbqg65x5k79l5ww8fg25yvh0000gn/T/pytensor_compilation_error_qkzoxwg5

You can find the C code in this temporary file: /var/folders/1s/3wbqg65x5k79l5ww8fg25yvh0000gn/T/pytensor_compilation_error_gm6574aj
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">File</span> <span class="o">~/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">link</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="n">lazylinker_c</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">79</span>
<span class="g g-Whitespace">     </span><span class="mi">78</span>         <span class="k">if</span> <span class="n">version</span> <span class="o">!=</span> <span class="n">actual_version</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">79</span>             <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">80</span>                 <span class="s2">&quot;Version check of the existing lazylinker compiled file.&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">81</span>                 <span class="sa">f</span><span class="s2">&quot; Looking for version </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">, but found </span><span class="si">{</span><span class="n">actual_version</span><span class="si">}</span><span class="s2">. &quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">82</span>                 <span class="sa">f</span><span class="s2">&quot;Extra debug information: force_compile=</span><span class="si">{</span><span class="n">force_compile</span><span class="si">}</span><span class="s2">, _need_reload=</span><span class="si">{</span><span class="n">_need_reload</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">83</span>             <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">84</span> <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>

<span class="ne">ImportError</span>: Version check of the existing lazylinker compiled file. Looking for version 0.212, but found None. Extra debug information: force_compile=False, _need_reload=True

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">ImportError</span><span class="g g-Whitespace">                               </span>Traceback (most recent call last)
<span class="n">File</span> <span class="o">~/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">link</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="n">lazylinker_c</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">100</span>
<span class="g g-Whitespace">     </span><span class="mi">99</span>     <span class="k">if</span> <span class="n">version</span> <span class="o">!=</span> <span class="n">actual_version</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">100</span>         <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span>             <span class="s2">&quot;Version check of the existing lazylinker compiled file.&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">102</span>             <span class="sa">f</span><span class="s2">&quot; Looking for version </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">, but found </span><span class="si">{</span><span class="n">actual_version</span><span class="si">}</span><span class="s2">. &quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">103</span>             <span class="sa">f</span><span class="s2">&quot;Extra debug information: force_compile=</span><span class="si">{</span><span class="n">force_compile</span><span class="si">}</span><span class="s2">, _need_reload=</span><span class="si">{</span><span class="n">_need_reload</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">105</span> <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">106</span>     <span class="c1"># It is useless to try to compile if there isn&#39;t any</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span>     <span class="c1"># compiler!  But we still want to try to load it, in case</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>     <span class="c1"># the cache was copied from another computer.</span>

<span class="ne">ImportError</span>: Version check of the existing lazylinker compiled file. Looking for version 0.212, but found None. Extra debug information: force_compile=False, _need_reload=True

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">CompileError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">8</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">model</span> <span class="o">=</span> <span class="n">avg</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="n">trace_NUTS</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pymc/sampling/mcmc.py:689,</span> in <span class="ni">sample</span><span class="nt">(draws, tune, chains, cores, random_seed, progressbar, step, nuts_sampler, initvals, init, jitter_max_retries, n_init, trace, discard_tuned_samples, compute_convergence_checks, keep_warning_stat, return_inferencedata, idata_kwargs, nuts_sampler_kwargs, callback, mp_ctx, model, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">686</span>         <span class="n">auto_nuts_init</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">    </span><span class="mi">688</span> <span class="n">initial_points</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">--&gt; </span><span class="mi">689</span> <span class="n">step</span> <span class="o">=</span> <span class="n">assign_step_methods</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="n">pm</span><span class="o">.</span><span class="n">STEP_METHODS</span><span class="p">,</span> <span class="n">step_kwargs</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">691</span> <span class="k">if</span> <span class="n">nuts_sampler</span> <span class="o">!=</span> <span class="s2">&quot;pymc&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">692</span>     <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">NUTS</span><span class="p">):</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pymc/sampling/mcmc.py:239,</span> in <span class="ni">assign_step_methods</span><span class="nt">(model, step, methods, step_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span>         <span class="n">selected</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">232</span>             <span class="n">methods_list</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">233</span>             <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">method</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="n">rv_var</span><span class="p">,</span> <span class="n">has_gradient</span><span class="o">=</span><span class="n">has_gradient</span><span class="p">:</span> <span class="n">method</span><span class="o">.</span><span class="n">_competence</span><span class="p">(</span>  <span class="c1"># type: ignore</span>
<span class="g g-Whitespace">    </span><span class="mi">234</span>                 <span class="n">var</span><span class="p">,</span> <span class="n">has_gradient</span>
<span class="g g-Whitespace">    </span><span class="mi">235</span>             <span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">236</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">237</span>         <span class="n">selected_steps</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">239</span> <span class="k">return</span> <span class="n">instantiate_steppers</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">selected_steps</span><span class="p">,</span> <span class="n">step_kwargs</span><span class="p">)</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pymc/sampling/mcmc.py:140,</span> in <span class="ni">instantiate_steppers</span><span class="nt">(model, steps, selected_steps, step_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">138</span>         <span class="n">args</span> <span class="o">=</span> <span class="n">step_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">{})</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span>         <span class="n">used_keys</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">140</span>         <span class="n">step</span> <span class="o">=</span> <span class="n">step_class</span><span class="p">(</span><span class="nb">vars</span><span class="o">=</span><span class="nb">vars</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">141</span>         <span class="n">steps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">143</span> <span class="n">unused_args</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">step_kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">used_keys</span><span class="p">)</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pymc/step_methods/hmc/nuts.py:180,</span> in <span class="ni">NUTS.__init__</span><span class="nt">(self, vars, max_treedepth, early_max_treedepth, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">122</span> <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_treedepth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">early_max_treedepth</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">123</span><span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Set up the No-U-Turn sampler.</span>
<span class="g g-Whitespace">    </span><span class="mi">124</span><span class="sd"> </span>
<span class="g g-Whitespace">    </span><span class="mi">125</span><span class="sd">     Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">178</span><span class="sd">     `pm.sample` to the desired number of tuning steps.</span>
<span class="g g-Whitespace">    </span><span class="mi">179</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">180</span>     <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">182</span>     <span class="bp">self</span><span class="o">.</span><span class="n">max_treedepth</span> <span class="o">=</span> <span class="n">max_treedepth</span>
<span class="g g-Whitespace">    </span><span class="mi">183</span>     <span class="bp">self</span><span class="o">.</span><span class="n">early_max_treedepth</span> <span class="o">=</span> <span class="n">early_max_treedepth</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pymc/step_methods/hmc/base_hmc.py:109,</span> in <span class="ni">BaseHMC.__init__</span><span class="nt">(self, vars, scaling, step_scale, is_cov, model, blocked, potential, dtype, Emax, target_accept, gamma, k, t0, adapt_step_size, step_rand, **pytensor_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>     <span class="nb">vars</span> <span class="o">=</span> <span class="n">get_value_vars_from_user_vars</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">109</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">blocked</span><span class="o">=</span><span class="n">blocked</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="o">**</span><span class="n">pytensor_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> <span class="bp">self</span><span class="o">.</span><span class="n">adapt_step_size</span> <span class="o">=</span> <span class="n">adapt_step_size</span>
<span class="g g-Whitespace">    </span><span class="mi">112</span> <span class="bp">self</span><span class="o">.</span><span class="n">Emax</span> <span class="o">=</span> <span class="n">Emax</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pymc/step_methods/arraystep.py:164,</span> in <span class="ni">GradientSharedStep.__init__</span><span class="nt">(self, vars, model, blocked, dtype, logp_dlogp_func, **pytensor_kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span> <span class="n">model</span> <span class="o">=</span> <span class="n">modelcontext</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">163</span> <span class="k">if</span> <span class="n">logp_dlogp_func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">164</span>     <span class="n">func</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">logp_dlogp_function</span><span class="p">(</span><span class="nb">vars</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="o">**</span><span class="n">pytensor_kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">165</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">166</span>     <span class="n">func</span> <span class="o">=</span> <span class="n">logp_dlogp_func</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pymc/model/core.py:612,</span> in <span class="ni">Model.logp_dlogp_function</span><span class="nt">(self, grad_vars, tempered, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">609</span>     <span class="n">costs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">logp</span><span class="p">()]</span>
<span class="g g-Whitespace">    </span><span class="mi">611</span> <span class="n">input_vars</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">graph_inputs</span><span class="p">(</span><span class="n">costs</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">Constant</span><span class="p">)}</span>
<span class="ne">--&gt; </span><span class="mi">612</span> <span class="n">ip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">initial_point</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">613</span> <span class="n">extra_vars_and_values</span> <span class="o">=</span> <span class="p">{</span>
<span class="g g-Whitespace">    </span><span class="mi">614</span>     <span class="n">var</span><span class="p">:</span> <span class="n">ip</span><span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">615</span>     <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">value_vars</span>
<span class="g g-Whitespace">    </span><span class="mi">616</span>     <span class="k">if</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">input_vars</span> <span class="ow">and</span> <span class="n">var</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">grad_vars</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span> <span class="p">}</span>
<span class="g g-Whitespace">    </span><span class="mi">618</span> <span class="k">return</span> <span class="n">ValueGradFunction</span><span class="p">(</span><span class="n">costs</span><span class="p">,</span> <span class="n">grad_vars</span><span class="p">,</span> <span class="n">extra_vars_and_values</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pymc/model/core.py:1069,</span> in <span class="ni">Model.initial_point</span><span class="nt">(self, random_seed)</span>
<span class="g g-Whitespace">   </span><span class="mi">1056</span> <span class="k">def</span> <span class="nf">initial_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">random_seed</span><span class="p">:</span> <span class="n">SeedSequenceSeed</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="g g-Whitespace">   </span><span class="mi">1057</span><span class="w">     </span><span class="sd">&quot;&quot;&quot;Computes the initial point of the model.</span>
<span class="g g-Whitespace">   </span><span class="mi">1058</span><span class="sd"> </span>
<span class="g g-Whitespace">   </span><span class="mi">1059</span><span class="sd">     Parameters</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">1067</span><span class="sd">         Maps names of transformed variables to numeric initial values in the transformed space.</span>
<span class="g g-Whitespace">   </span><span class="mi">1068</span><span class="sd">     &quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1069</span>     <span class="n">fn</span> <span class="o">=</span> <span class="n">make_initial_point_fn</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_transformed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1070</span>     <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">fn</span><span class="p">(</span><span class="n">random_seed</span><span class="p">),</span> <span class="n">model</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pymc/initial_point.py:152,</span> in <span class="ni">make_initial_point_fn</span><span class="nt">(model, overrides, jitter_rvs, default_strategy, return_transformed)</span>
<span class="g g-Whitespace">    </span><span class="mi">149</span> <span class="c1"># Replace original rng shared variables so that we don&#39;t mess with them</span>
<span class="g g-Whitespace">    </span><span class="mi">150</span> <span class="c1"># when calling the final seeded function</span>
<span class="g g-Whitespace">    </span><span class="mi">151</span> <span class="n">initial_values</span> <span class="o">=</span> <span class="n">replace_rng_nodes</span><span class="p">(</span><span class="n">initial_values</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">152</span> <span class="n">func</span> <span class="o">=</span> <span class="n">compile_pymc</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="p">[],</span> <span class="n">outputs</span><span class="o">=</span><span class="n">initial_values</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">pytensor</span><span class="o">.</span><span class="n">compile</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">FAST_COMPILE</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">154</span> <span class="n">varnames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="g g-Whitespace">    </span><span class="mi">155</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">free_RVs</span><span class="p">:</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pymc/pytensorf.py:991,</span> in <span class="ni">compile_pymc</span><span class="nt">(inputs, outputs, random_seed, mode, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">989</span> <span class="n">opt_qry</span> <span class="o">=</span> <span class="n">mode</span><span class="o">.</span><span class="n">provided_optimizer</span><span class="o">.</span><span class="n">including</span><span class="p">(</span><span class="s2">&quot;random_make_inplace&quot;</span><span class="p">,</span> <span class="n">check_parameter_opt</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">990</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">Mode</span><span class="p">(</span><span class="n">linker</span><span class="o">=</span><span class="n">mode</span><span class="o">.</span><span class="n">linker</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">opt_qry</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">991</span> <span class="n">pytensor_function</span> <span class="o">=</span> <span class="n">pytensor</span><span class="o">.</span><span class="n">function</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">992</span>     <span class="n">inputs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">993</span>     <span class="n">outputs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">994</span>     <span class="n">updates</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="n">rng_updates</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;updates&quot;</span><span class="p">,</span> <span class="p">{})},</span>
<span class="g g-Whitespace">    </span><span class="mi">995</span>     <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">996</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">997</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">998</span> <span class="k">return</span> <span class="n">pytensor_function</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/compile/function/__init__.py:315,</span> in <span class="ni">function</span><span class="nt">(inputs, outputs, mode, updates, givens, no_default_updates, accept_inplace, name, rebuild_strict, allow_input_downcast, profile, on_unused_input)</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>     <span class="n">fn</span> <span class="o">=</span> <span class="n">orig_function</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>         <span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">accept_inplace</span><span class="o">=</span><span class="n">accept_inplace</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span>     <span class="c1"># note: pfunc will also call orig_function -- orig_function is</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span>     <span class="c1">#      a choke point that all compilation must pass through</span>
<span class="ne">--&gt; </span><span class="mi">315</span>     <span class="n">fn</span> <span class="o">=</span> <span class="n">pfunc</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span>         <span class="n">params</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">317</span>         <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">318</span>         <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">319</span>         <span class="n">updates</span><span class="o">=</span><span class="n">updates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">320</span>         <span class="n">givens</span><span class="o">=</span><span class="n">givens</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">321</span>         <span class="n">no_default_updates</span><span class="o">=</span><span class="n">no_default_updates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">322</span>         <span class="n">accept_inplace</span><span class="o">=</span><span class="n">accept_inplace</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">323</span>         <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">324</span>         <span class="n">rebuild_strict</span><span class="o">=</span><span class="n">rebuild_strict</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span>         <span class="n">allow_input_downcast</span><span class="o">=</span><span class="n">allow_input_downcast</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>         <span class="n">on_unused_input</span><span class="o">=</span><span class="n">on_unused_input</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">327</span>         <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>         <span class="n">output_keys</span><span class="o">=</span><span class="n">output_keys</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span> <span class="k">return</span> <span class="n">fn</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/compile/function/pfunc.py:469,</span> in <span class="ni">pfunc</span><span class="nt">(params, outputs, mode, updates, givens, no_default_updates, accept_inplace, name, rebuild_strict, allow_input_downcast, profile, on_unused_input, output_keys, fgraph)</span>
<span class="g g-Whitespace">    </span><span class="mi">455</span>     <span class="n">profile</span> <span class="o">=</span> <span class="n">ProfileStats</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">profile</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">457</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">cloned_outputs</span> <span class="o">=</span> <span class="n">construct_pfunc_ins_and_outs</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">458</span>     <span class="n">params</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">459</span>     <span class="n">outputs</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">466</span>     <span class="n">fgraph</span><span class="o">=</span><span class="n">fgraph</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">467</span> <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">469</span> <span class="k">return</span> <span class="n">orig_function</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">470</span>     <span class="n">inputs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">471</span>     <span class="n">cloned_outputs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">472</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">473</span>     <span class="n">accept_inplace</span><span class="o">=</span><span class="n">accept_inplace</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">474</span>     <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">475</span>     <span class="n">profile</span><span class="o">=</span><span class="n">profile</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">476</span>     <span class="n">on_unused_input</span><span class="o">=</span><span class="n">on_unused_input</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">477</span>     <span class="n">output_keys</span><span class="o">=</span><span class="n">output_keys</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">478</span>     <span class="n">fgraph</span><span class="o">=</span><span class="n">fgraph</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">479</span> <span class="p">)</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/compile/function/types.py:1762,</span> in <span class="ni">orig_function</span><span class="nt">(inputs, outputs, mode, accept_inplace, name, profile, on_unused_input, output_keys, fgraph)</span>
<span class="g g-Whitespace">   </span><span class="mi">1750</span>     <span class="n">m</span> <span class="o">=</span> <span class="n">Maker</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1751</span>         <span class="n">inputs</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1752</span>         <span class="n">outputs</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1759</span>         <span class="n">fgraph</span><span class="o">=</span><span class="n">fgraph</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1760</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1761</span>     <span class="k">with</span> <span class="n">config</span><span class="o">.</span><span class="n">change_flags</span><span class="p">(</span><span class="n">compute_test_value</span><span class="o">=</span><span class="s2">&quot;off&quot;</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1762</span>         <span class="n">fn</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1763</span> <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1764</span>     <span class="k">if</span> <span class="n">profile</span> <span class="ow">and</span> <span class="n">fn</span><span class="p">:</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/compile/function/types.py:1654,</span> in <span class="ni">FunctionMaker.create</span><span class="nt">(self, input_storage, storage_map)</span>
<span class="g g-Whitespace">   </span><span class="mi">1651</span> <span class="n">start_import_time</span> <span class="o">=</span> <span class="n">pytensor</span><span class="o">.</span><span class="n">link</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">cmodule</span><span class="o">.</span><span class="n">import_time</span>
<span class="g g-Whitespace">   </span><span class="mi">1653</span> <span class="k">with</span> <span class="n">config</span><span class="o">.</span><span class="n">change_flags</span><span class="p">(</span><span class="n">traceback__limit</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">traceback__compile_limit</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1654</span>     <span class="n">_fn</span><span class="p">,</span> <span class="n">_i</span><span class="p">,</span> <span class="n">_o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linker</span><span class="o">.</span><span class="n">make_thunk</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1655</span>         <span class="n">input_storage</span><span class="o">=</span><span class="n">input_storage_lists</span><span class="p">,</span> <span class="n">storage_map</span><span class="o">=</span><span class="n">storage_map</span>
<span class="g g-Whitespace">   </span><span class="mi">1656</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1658</span> <span class="n">end_linker</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1660</span> <span class="n">linker_time</span> <span class="o">=</span> <span class="n">end_linker</span> <span class="o">-</span> <span class="n">start_linker</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/basic.py:245,</span> in <span class="ni">LocalLinker.make_thunk</span><span class="nt">(self, input_storage, output_storage, storage_map, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">238</span> <span class="k">def</span> <span class="nf">make_thunk</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">239</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">240</span>     <span class="n">input_storage</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;InputStorageType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">243</span>     <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">244</span> <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;BasicThunkType&quot;</span><span class="p">,</span> <span class="s2">&quot;InputStorageType&quot;</span><span class="p">,</span> <span class="s2">&quot;OutputStorageType&quot;</span><span class="p">]:</span>
<span class="ne">--&gt; </span><span class="mi">245</span>     <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_all</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">246</span>         <span class="n">input_storage</span><span class="o">=</span><span class="n">input_storage</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">247</span>         <span class="n">output_storage</span><span class="o">=</span><span class="n">output_storage</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">248</span>         <span class="n">storage_map</span><span class="o">=</span><span class="n">storage_map</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">249</span>     <span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/vm.py:1289,</span> in <span class="ni">VMLinker.make_all</span><span class="nt">(self, profiler, input_storage, output_storage, storage_map)</span>
<span class="g g-Whitespace">   </span><span class="mi">1286</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1287</span>     <span class="n">post_thunk_clear</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1289</span> <span class="n">vm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_vm</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1290</span>     <span class="n">order</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1291</span>     <span class="n">thunks</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1292</span>     <span class="n">input_storage</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1293</span>     <span class="n">output_storage</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1294</span>     <span class="n">storage_map</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1295</span>     <span class="n">post_thunk_clear</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1296</span>     <span class="n">computed</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1297</span>     <span class="n">compute_map</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1298</span>     <span class="bp">self</span><span class="o">.</span><span class="n">updated_vars</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1299</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1301</span> <span class="n">vm</span><span class="o">.</span><span class="n">storage_map</span> <span class="o">=</span> <span class="n">storage_map</span>
<span class="g g-Whitespace">   </span><span class="mi">1302</span> <span class="n">vm</span><span class="o">.</span><span class="n">compute_map</span> <span class="o">=</span> <span class="n">compute_map</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/vm.py:1012,</span> in <span class="ni">VMLinker.make_vm</span><span class="nt">(self, nodes, thunks, input_storage, output_storage, storage_map, post_thunk_clear, computed, compute_map, updated_vars)</span>
<span class="g g-Whitespace">   </span><span class="mi">1009</span> <span class="n">pre_call_clear</span> <span class="o">=</span> <span class="p">[</span><span class="n">storage_map</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">no_recycling</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1011</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1012</span>     <span class="kn">from</span> <span class="nn">pytensor.link.c.cvm</span> <span class="kn">import</span> <span class="n">CVM</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span> <span class="k">except</span> <span class="p">(</span><span class="n">MissingGXX</span><span class="p">,</span> <span class="ne">ImportError</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="n">CVM</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">link</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="n">cvm</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">13</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">config</span><span class="o">.</span><span class="n">cxx</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="k">raise</span> <span class="n">MissingGXX</span><span class="p">(</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>         <span class="s2">&quot;lazylinker will not be imported if pytensor.config.cxx is not set.&quot;</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span>     <span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">13</span> <span class="kn">from</span> <span class="nn">pytensor.link.c.lazylinker_c</span> <span class="kn">import</span> <span class="n">CLazyLinker</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="k">class</span> <span class="nc">CVM</span><span class="p">(</span><span class="n">CLazyLinker</span><span class="p">,</span> <span class="n">VM</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fgraph</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

<span class="n">File</span> <span class="o">~/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">link</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="n">lazylinker_c</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">143</span>
<span class="g g-Whitespace">    </span><span class="mi">140</span>         <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">142</span> <span class="n">args</span> <span class="o">=</span> <span class="n">GCC_compiler</span><span class="o">.</span><span class="n">compile_args</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">143</span> <span class="n">GCC_compiler</span><span class="o">.</span><span class="n">compile_str</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">preargs</span><span class="o">=</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">144</span> <span class="c1"># Save version into the __init__.py file.</span>
<span class="g g-Whitespace">    </span><span class="mi">145</span> <span class="n">init_py</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="s2">&quot;__init__.py&quot;</span><span class="p">)</span>

<span class="nn">File ~/Dropbox/Anaconda/anaconda3/envs/8820-book-env/lib/python3.10/site-packages/pytensor/link/c/cmodule.py:2640,</span> in <span class="ni">GCC_compiler.compile_str</span><span class="nt">(module_name, src_code, location, include_dirs, lib_dirs, libs, preargs, py_module, hide_symbols)</span>
<span class="g g-Whitespace">   </span><span class="mi">2632</span>                 <span class="nb">print</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2633</span>                     <span class="s2">&quot;Check if package python-dev or python-devel is installed.&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2634</span>                 <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2636</span>     <span class="c1"># We replace &#39;\n&#39; by &#39;. &#39; in the error message because when Python</span>
<span class="g g-Whitespace">   </span><span class="mi">2637</span>     <span class="c1"># prints the exception, having &#39;\n&#39; in the text makes it more</span>
<span class="g g-Whitespace">   </span><span class="mi">2638</span>     <span class="c1"># difficult to read.</span>
<span class="g g-Whitespace">   </span><span class="mi">2639</span>     <span class="c1"># compile_stderr = compile_stderr.replace(&quot;\n&quot;, &quot;. &quot;)</span>
<span class="ne">-&gt; </span><span class="mi">2640</span>     <span class="k">raise</span> <span class="n">CompileError</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2641</span>         <span class="sa">f</span><span class="s2">&quot;Compilation failed (return status=</span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">):</span><span class="se">\n</span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">compile_stderr</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">2642</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2643</span> <span class="k">elif</span> <span class="n">config</span><span class="o">.</span><span class="n">cmodule__compilation_warning</span> <span class="ow">and</span> <span class="n">compile_stderr</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2644</span>     <span class="c1"># Print errors just below the command line.</span>
<span class="g g-Whitespace">   </span><span class="mi">2645</span>     <span class="nb">print</span><span class="p">(</span><span class="n">compile_stderr</span><span class="p">)</span>

<span class="ne">CompileError</span>: Compilation failed (return status=1):
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">clang</span><span class="o">++</span> <span class="o">-</span><span class="n">dynamiclib</span> <span class="o">-</span><span class="n">g</span> <span class="o">-</span><span class="n">Wno</span><span class="o">-</span><span class="n">c</span><span class="o">++</span><span class="mi">11</span><span class="o">-</span><span class="n">narrowing</span> <span class="o">-</span><span class="n">fno</span><span class="o">-</span><span class="n">exceptions</span> <span class="o">-</span><span class="n">fno</span><span class="o">-</span><span class="n">unwind</span><span class="o">-</span><span class="n">tables</span> <span class="o">-</span><span class="n">fno</span><span class="o">-</span><span class="n">asynchronous</span><span class="o">-</span><span class="n">unwind</span><span class="o">-</span><span class="n">tables</span> <span class="o">-</span><span class="n">DNPY_NO_DEPRECATED_API</span><span class="o">=</span><span class="n">NPY_1_7_API_VERSION</span> <span class="o">-</span><span class="n">m64</span> <span class="o">-</span><span class="n">fPIC</span> <span class="o">-</span><span class="n">undefined</span> <span class="n">dynamic_lookup</span> <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">numpy</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">include</span> <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span> <span class="o">-</span><span class="n">I</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">link</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="n">c_code</span> <span class="o">-</span><span class="n">L</span><span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">lib</span> <span class="o">-</span><span class="n">fvisibility</span><span class="o">=</span><span class="n">hidden</span> <span class="o">-</span><span class="n">o</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/.</span><span class="n">pytensor</span><span class="o">/</span><span class="n">compiledir_macOS</span><span class="o">-</span><span class="mf">14.2.1</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mi">64</span><span class="n">bit</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mf">3.10.13</span><span class="o">-</span><span class="mi">64</span><span class="o">/</span><span class="n">lazylinker_ext</span><span class="o">/</span><span class="n">lazylinker_ext</span><span class="o">.</span><span class="n">so</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/.</span><span class="n">pytensor</span><span class="o">/</span><span class="n">compiledir_macOS</span><span class="o">-</span><span class="mf">14.2.1</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mi">64</span><span class="n">bit</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mf">3.10.13</span><span class="o">-</span><span class="mi">64</span><span class="o">/</span><span class="n">lazylinker_ext</span><span class="o">/</span><span class="n">mod</span><span class="o">.</span><span class="n">cpp</span>
<span class="n">In</span> <span class="n">file</span> <span class="n">included</span> <span class="kn">from</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/.</span><span class="n">pytensor</span><span class="o">/</span><span class="n">compiledir_macOS</span><span class="o">-</span><span class="mf">14.2.1</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mi">64</span><span class="n">bit</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mf">3.10.13</span><span class="o">-</span><span class="mi">64</span><span class="o">/</span><span class="n">lazylinker_ext</span><span class="o">/</span><span class="n">mod</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span>
<span class="n">In</span> <span class="n">file</span> <span class="n">included</span> <span class="kn">from</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">link</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="n">c_code</span><span class="o">/</span><span class="n">pytensor_mod_helper</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">Python</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="s2">&quot;Python.h requires that stdio.h define NULL.&quot;</span>
<span class="c1">#   error &quot;Python.h requires that stdio.h define NULL.&quot;</span>
    <span class="o">^</span>
<span class="n">In</span> <span class="n">file</span> <span class="n">included</span> <span class="kn">from</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/.</span><span class="n">pytensor</span><span class="o">/</span><span class="n">compiledir_macOS</span><span class="o">-</span><span class="mf">14.2.1</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mi">64</span><span class="n">bit</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mf">3.10.13</span><span class="o">-</span><span class="mi">64</span><span class="o">/</span><span class="n">lazylinker_ext</span><span class="o">/</span><span class="n">mod</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span>
<span class="n">In</span> <span class="n">file</span> <span class="n">included</span> <span class="kn">from</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">link</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="n">c_code</span><span class="o">/</span><span class="n">pytensor_mod_helper</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span>
<span class="n">In</span> <span class="n">file</span> <span class="n">included</span> <span class="kn">from</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">Python</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="nb">bin</span><span class="o">/../</span><span class="n">include</span><span class="o">/</span><span class="n">c</span><span class="o">++/</span><span class="n">v1</span><span class="o">/</span><span class="n">string</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">95</span><span class="p">:</span><span class="mi">102</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">unknown</span> <span class="nb">type</span> <span class="n">name</span> <span class="s1">&#39;size_t&#39;</span>
<span class="n">inline</span> <span class="n">_LIBCPP_HIDE_FROM_ABI</span> <span class="n">_LIBCPP_PREFERRED_OVERLOAD</span> <span class="n">const</span> <span class="n">void</span><span class="o">*</span> <span class="n">memchr</span><span class="p">(</span><span class="n">const</span> <span class="n">void</span><span class="o">*</span> <span class="n">__s</span><span class="p">,</span> <span class="nb">int</span> <span class="n">__c</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">__n</span><span class="p">)</span> <span class="p">{</span>
                                                                                                     <span class="o">^</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="nb">bin</span><span class="o">/../</span><span class="n">include</span><span class="o">/</span><span class="n">c</span><span class="o">++/</span><span class="n">v1</span><span class="o">/</span><span class="n">string</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">98</span><span class="p">:</span><span class="mi">90</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">unknown</span> <span class="nb">type</span> <span class="n">name</span> <span class="s1">&#39;size_t&#39;</span>
<span class="n">inline</span> <span class="n">_LIBCPP_HIDE_FROM_ABI</span> <span class="n">_LIBCPP_PREFERRED_OVERLOAD</span> <span class="n">void</span><span class="o">*</span> <span class="n">memchr</span><span class="p">(</span><span class="n">void</span><span class="o">*</span> <span class="n">__s</span><span class="p">,</span> <span class="nb">int</span> <span class="n">__c</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">__n</span><span class="p">)</span> <span class="p">{</span>
                                                                                         <span class="o">^</span>
<span class="n">In</span> <span class="n">file</span> <span class="n">included</span> <span class="kn">from</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/.</span><span class="n">pytensor</span><span class="o">/</span><span class="n">compiledir_macOS</span><span class="o">-</span><span class="mf">14.2.1</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mi">64</span><span class="n">bit</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mf">3.10.13</span><span class="o">-</span><span class="mi">64</span><span class="o">/</span><span class="n">lazylinker_ext</span><span class="o">/</span><span class="n">mod</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span>
<span class="n">In</span> <span class="n">file</span> <span class="n">included</span> <span class="kn">from</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">link</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="n">c_code</span><span class="o">/</span><span class="n">pytensor_mod_helper</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span>
<span class="n">In</span> <span class="n">file</span> <span class="n">included</span> <span class="kn">from</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">Python</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="nb">bin</span><span class="o">/../</span><span class="n">include</span><span class="o">/</span><span class="n">c</span><span class="o">++/</span><span class="n">v1</span><span class="o">/</span><span class="n">stdlib</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">150</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">unknown</span> <span class="nb">type</span> <span class="n">name</span> <span class="s1">&#39;ldiv_t&#39;</span>
<span class="n">inline</span> <span class="n">_LIBCPP_INLINE_VISIBILITY</span> <span class="n">ldiv_t</span> <span class="n">div</span><span class="p">(</span><span class="n">long</span> <span class="n">__x</span><span class="p">,</span> <span class="n">long</span> <span class="n">__y</span><span class="p">)</span> <span class="n">_NOEXCEPT</span> <span class="p">{</span>
                                 <span class="o">^</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="nb">bin</span><span class="o">/../</span><span class="n">include</span><span class="o">/</span><span class="n">c</span><span class="o">++/</span><span class="n">v1</span><span class="o">/</span><span class="n">stdlib</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">151</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">no</span> <span class="n">member</span> <span class="n">named</span> <span class="s1">&#39;ldiv&#39;</span> <span class="ow">in</span> <span class="n">the</span> <span class="k">global</span> <span class="n">namespace</span>
  <span class="k">return</span> <span class="p">::</span><span class="n">ldiv</span><span class="p">(</span><span class="n">__x</span><span class="p">,</span> <span class="n">__y</span><span class="p">);</span>
         <span class="o">~~^</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="nb">bin</span><span class="o">/../</span><span class="n">include</span><span class="o">/</span><span class="n">c</span><span class="o">++/</span><span class="n">v1</span><span class="o">/</span><span class="n">stdlib</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">154</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">unknown</span> <span class="nb">type</span> <span class="n">name</span> <span class="s1">&#39;lldiv_t&#39;</span>
<span class="n">inline</span> <span class="n">_LIBCPP_INLINE_VISIBILITY</span> <span class="n">lldiv_t</span> <span class="n">div</span><span class="p">(</span><span class="n">long</span> <span class="n">long</span> <span class="n">__x</span><span class="p">,</span>
                                 <span class="o">^</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="nb">bin</span><span class="o">/../</span><span class="n">include</span><span class="o">/</span><span class="n">c</span><span class="o">++/</span><span class="n">v1</span><span class="o">/</span><span class="n">stdlib</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">156</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">no</span> <span class="n">member</span> <span class="n">named</span> <span class="s1">&#39;lldiv&#39;</span> <span class="ow">in</span> <span class="n">the</span> <span class="k">global</span> <span class="n">namespace</span>
  <span class="k">return</span> <span class="p">::</span><span class="n">lldiv</span><span class="p">(</span><span class="n">__x</span><span class="p">,</span> <span class="n">__y</span><span class="p">);</span>
         <span class="o">~~^</span>
<span class="n">In</span> <span class="n">file</span> <span class="n">included</span> <span class="kn">from</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/.</span><span class="n">pytensor</span><span class="o">/</span><span class="n">compiledir_macOS</span><span class="o">-</span><span class="mf">14.2.1</span><span class="o">-</span><span class="n">x86_64</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mi">64</span><span class="n">bit</span><span class="o">-</span><span class="n">i386</span><span class="o">-</span><span class="mf">3.10.13</span><span class="o">-</span><span class="mi">64</span><span class="o">/</span><span class="n">lazylinker_ext</span><span class="o">/</span><span class="n">mod</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span>
<span class="n">In</span> <span class="n">file</span> <span class="n">included</span> <span class="kn">from</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pytensor</span><span class="o">/</span><span class="n">link</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="n">c_code</span><span class="o">/</span><span class="n">pytensor_mod_helper</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span>
<span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">furnstah</span><span class="o">/</span><span class="n">Dropbox</span><span class="o">/</span><span class="n">Anaconda</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="mi">8820</span><span class="o">-</span><span class="n">book</span><span class="o">-</span><span class="n">env</span><span class="o">/</span><span class="n">include</span><span class="o">/</span><span class="n">python3</span><span class="mf">.10</span><span class="o">/</span><span class="n">Python</span><span class="o">.</span><span class="n">h</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span> <span class="n">fatal</span> <span class="n">error</span><span class="p">:</span> <span class="s1">&#39;unistd.h&#39;</span> <span class="n">file</span> <span class="ow">not</span> <span class="n">found</span>
<span class="c1">#include &lt;unistd.h&gt;</span>
         <span class="o">^~~~~~~~~~</span>
<span class="mi">8</span> <span class="n">errors</span> <span class="n">generated</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">my_NUTS_model</span><span class="p">:</span>    
    <span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace_NUTS</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">with</span> <span class="n">my_NUTS_model</span><span class="p">:</span>    
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace_NUTS</span><span class="p">);</span>

<span class="ne">NameError</span>: name &#39;trace_NUTS&#39; is not defined
</pre></div>
</div>
</div>
</div>
<section id="available-samplers">
<h3>Available samplers<a class="headerlink" href="#available-samplers" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">PyMC</span></code> offers a variety of samplers, found in pm.step_methods:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">isupper</span><span class="p">(),</span> <span class="nb">dir</span><span class="p">(</span><span class="n">pm</span><span class="o">.</span><span class="n">step_methods</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;BinaryGibbsMetropolis&#39;,
 &#39;BinaryMetropolis&#39;,
 &#39;CategoricalGibbsMetropolis&#39;,
 &#39;CauchyProposal&#39;,
 &#39;CompoundStep&#39;,
 &#39;DEMetropolis&#39;,
 &#39;DEMetropolisZ&#39;,
 &#39;HamiltonianMC&#39;,
 &#39;LaplaceProposal&#39;,
 &#39;Metropolis&#39;,
 &#39;MultivariateNormalProposal&#39;,
 &#39;NUTS&#39;,
 &#39;NormalProposal&#39;,
 &#39;PoissonProposal&#39;,
 &#39;STEP_METHODS&#39;,
 &#39;Slice&#39;,
 &#39;UniformProposal&#39;]
</pre></div>
</div>
</div>
</div>
<p>Commonly used step-methods besides NUTS include Metropolis and Slice. The claim is that for almost all continuous models, <code class="docutils literal notranslate"><span class="pre">NUTS</span></code> should be preferred. There are hard-to-sample models for which NUTS will be very slow causing many users to use Metropolis instead. This practice, however, is rarely successful. NUTS is fast on simple models but can be slow if the model is very complex or it is badly initialized. In the case of a complex model that is hard for NUTS, Metropolis, while faster, will have a very low effective sample size or not converge properly at all. A better approach is to instead try to improve initialization of NUTS, or reparameterize the model.</p>
<p>For completeness, other sampling methods can be passed to sample.  Here is an example (Metropolis-Hastings):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">my_Metropolis_model</span><span class="p">:</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>

    <span class="n">step</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Metropolis</span><span class="p">()</span>
    <span class="n">trace_MH</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace_MH</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiprocess sampling (2 chains in 2 jobs)
Metropolis: [mu]
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='4000' class='' max='4000' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [4000/4000 00:00&lt;00:00 Sampling 2 chains, 0 divergences]
    </div>
    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 2 chains for 1_000 tune and 1_000 draw iterations (2_000 + 2_000 draws total) took 11 seconds.
We recommend running at least 4 chains for robust computation of convergence diagnostics
</pre></div>
</div>
<img alt="../../_images/ab77d5a422e792e105fd0c186091e4c1ae8a7ee292e8aad10b31cf23f2753145.png" src="../../_images/ab77d5a422e792e105fd0c186091e4c1ae8a7ee292e8aad10b31cf23f2753145.png" />
</div>
</div>
</section>
<section id="analyze-sampling-results">
<h3>Analyze sampling results<a class="headerlink" href="#analyze-sampling-results" title="Permalink to this heading">#</a></h3>
<p>The most common used plot to analyze sampling results is the so-called trace-plot, now invoked with a arViz <code class="docutils literal notranslate"><span class="pre">plot_trace</span></code> command:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">my_NUTS_model</span><span class="p">:</span>    
    <span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace_NUTS</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/10ea2458b553bb251be33c5e4ac246ac159c70178cc4ae5492fcff103c5c2b0e.png" src="../../_images/10ea2458b553bb251be33c5e4ac246ac159c70178cc4ae5492fcff103c5c2b0e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">HalfNormal</span><span class="p">(</span><span class="s1">&#39;sd&#39;</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sd</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>

    <span class="n">step1</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Metropolis</span><span class="p">(</span><span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">mu</span><span class="p">])</span>
    <span class="n">step2</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Slice</span><span class="p">(</span><span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="n">sd</span><span class="p">])</span>
    <span class="n">trace_2_samplers</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="p">[</span><span class="n">step1</span><span class="p">,</span> <span class="n">step2</span><span class="p">],</span> <span class="n">cores</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> 
                                 <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace_2_samplers</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiprocess sampling (4 chains in 4 jobs)
CompoundStep
&gt;Metropolis: [mu]
&gt;Slice: [sd]
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='44000' class='' max='44000' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [44000/44000 00:18&lt;00:00 Sampling 4 chains, 0 divergences]
    </div>
    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 4 chains for 1_000 tune and 10_000 draw iterations (4_000 + 40_000 draws total) took 36 seconds.
</pre></div>
</div>
<img alt="../../_images/ff7e3e104f881ee7fcf35bfb63da3a7bb6823ac1676051ba8ab6567c61e26464.png" src="../../_images/ff7e3e104f881ee7fcf35bfb63da3a7bb6823ac1676051ba8ab6567c61e26464.png" />
</div>
</div>
</section>
<section id="diagnostics">
<h3>Diagnostics<a class="headerlink" href="#diagnostics" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace_2_samplers</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mu</th>
      <td>-0.006</td>
      <td>0.099</td>
      <td>-0.185</td>
      <td>0.183</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>6232.0</td>
      <td>6291.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>sd</th>
      <td>0.981</td>
      <td>0.071</td>
      <td>0.853</td>
      <td>1.116</td>
      <td>0.000</td>
      <td>0.000</td>
      <td>37253.0</td>
      <td>28329.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">my_Metropolis_model</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace_MH</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mu</th>
      <td>0.043</td>
      <td>0.096</td>
      <td>-0.144</td>
      <td>0.215</td>
      <td>0.005</td>
      <td>0.005</td>
      <td>340.0</td>
      <td>338.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">my_Metropolis_model</span><span class="p">:</span>
    <span class="n">az</span><span class="o">.</span><span class="n">plot_forest</span><span class="p">(</span><span class="n">trace_MH</span><span class="p">,</span> <span class="n">r_hat</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6ad6bb78774db4a1a0d16db3a48f8141915544bb6269788e77599b62c121bdb0.png" src="../../_images/6ad6bb78774db4a1a0d16db3a48f8141915544bb6269788e77599b62c121bdb0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">my_Metropolis_model</span><span class="p">:</span>
    <span class="n">pm</span><span class="o">.</span><span class="n">plot_posterior</span><span class="p">(</span><span class="n">trace_MH</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b02a9084a60d69389c8ab15060b954f2686dc71ca2b62f867102f9d152a78aa8.png" src="../../_images/b02a9084a60d69389c8ab15060b954f2686dc71ca2b62f867102f9d152a78aa8.png" />
</div>
</div>
</section>
</section>
<section id="examples-from-rob-hicks">
<h2>Examples from Rob Hicks<a class="headerlink" href="#examples-from-rob-hicks" title="Permalink to this heading">#</a></h2>
<p>See <a class="reference external" href="https://rlhick.people.wm.edu/stories/bayesian_7.html">https://rlhick.people.wm.edu/stories/bayesian_7.html</a>.  We also have a notebook from his Bayesian 8 “story”.</p>
<p>We start with a very simple one parameter model and then move to slightly more complicated settings:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.</span>  <span class="c1"># standard deviation</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">10.</span>    <span class="c1"># mean</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># 10**6</span>

<span class="c1"># sample from a normal distribution</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>  

<span class="c1"># plot a histogram of the sampled data</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fe0965d319afa469802fb801ec307430a867a87bdbbe85846163f2f806f0f35a.png" src="../../_images/fe0965d319afa469802fb801ec307430a867a87bdbbe85846163f2f806f0f35a.png" />
</div>
</div>
<p>Run the previous cell a few times to see the fluctuations.  Crank up the number of samples to <code class="docutils literal notranslate"><span class="pre">10**6</span></code> to see a smoother histogram.</p>
<section id="pymc3-implementation">
<h3>PyMC3 implementation<a class="headerlink" href="#pymc3-implementation" title="Permalink to this heading">#</a></h3>
<p>We instantiate a Model with a descriptions of priors and the likelihood. Here, <code class="docutils literal notranslate"><span class="pre">mu</span></code> is defined to be a random variable (we want to sample this variable by generating a Markov chain) and we provide a prior distribution with associated hyper-parameters for it. The likelihood function is chosen to be Normal, with one parameter to be estimated (mu), and we use known <span class="math notranslate nohighlight">\(\sigma\)</span> (denoted as <code class="docutils literal notranslate"><span class="pre">sigma</span></code>). Our “dependent variable” is given by <code class="docutils literal notranslate"><span class="pre">observed=data</span></code>, where <code class="docutils literal notranslate"><span class="pre">data</span></code> is generated above and shown in the histogram. So we our implementing Bayes theorem in the form:</p>
<div class="amsmath math notranslate nohighlight" id="equation-7b0fe7ca-5fb2-4757-b426-7cce3d2cf2bb">
<span class="eqno">(6.2)<a class="headerlink" href="#equation-7b0fe7ca-5fb2-4757-b426-7cce3d2cf2bb" title="Permalink to this equation">#</a></span>\[\begin{align}
   \newcommand{\Pr}{\textrm{pr}} 
   \newcommand{\data}{\textbf{data}}
   \Pr(\mu | \sigma, \data) \propto \Pr(\data | \mu, \sigma) \times \Pr(\mu |\mu^0_\mu, \sigma^0_\mu)
\end{align}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters for the prior on mu</span>
<span class="n">mu_prior</span> <span class="o">=</span> <span class="mf">8.</span>
<span class="n">sigma_prior</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># Note this is our prior on the std of mu</span>

<span class="c1"># Could do this instead as:</span>
<span class="c1">#   basic_model = pm3.Model()</span>
<span class="c1">#   with basic_model:</span>

<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">basic_model</span><span class="p">:</span>  

    <span class="c1"># Prior for unknown model parameters (mean and sd of the normal pdf)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;Mean of Data&#39;</span><span class="p">,</span> <span class="n">mu_prior</span><span class="p">,</span> <span class="n">sigma_prior</span><span class="p">)</span>
    
    <span class="c1"># Likelihood (sampling distribution) of observations</span>
    <span class="n">data_in</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;Y_obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next we define how the Markov chain will be constructed. The example we are following set <code class="docutils literal notranslate"><span class="pre">startvals</span></code> to be the MAP and used a Metropolis step method.  There always seems to be a complaint with the latest pyMC3 about using find_MAP to start the sampler.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chain_length</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="k">with</span> <span class="n">basic_model</span><span class="p">:</span>
    <span class="c1"># obtain starting values via MAP (maximum a posteriori)</span>
    <span class="n">startvals</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">find_MAP</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">basic_model</span><span class="p">)</span>  <span class="c1"># model here is optional</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">startvals</span><span class="p">)</span>
    
    <span class="c1"># instantiate sampler</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Metropolis</span><span class="p">()</span>   <span class="c1"># Metropolis-Hastings</span>

    <span class="c1"># draw 10000 posterior samples for each chain (4 chains by default?)</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">draws</span><span class="o">=</span><span class="n">chain_length</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">startvals</span><span class="p">,</span> 
                      <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00&lt;00:00 logp = -285.09, ||grad|| = 30.059]
    </div>
    </div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Mean of Data&#39;: array(10.60129962)}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/hx/5v7xk5xj21xgghnqjznp90100000gt/T/ipykernel_39165/2949430162.py:12: FutureWarning: The `start` kwarg was renamed to `initvals` and can now do more. Please check the docstring.
  trace = pm.sample(draws=chain_length, step=step, start=startvals,
Multiprocess sampling (2 chains in 2 jobs)
Metropolis: [Mean of Data]
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='22000' class='' max='22000' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [22000/22000 00:04&lt;00:00 Sampling 2 chains, 0 divergences]
    </div>
    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 2 chains for 1_000 tune and 10_000 draw iterations (2_000 + 20_000 draws total) took 16 seconds.
We recommend running at least 4 chains for robust computation of convergence diagnostics
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the two chains</span>
<span class="k">with</span> <span class="n">basic_model</span><span class="p">:</span>
    <span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5205e9a24d5cb5fbf0b632bed4b6d31a4a86c7a89e943a3ae37184f0f4f18281.png" src="../../_images/5205e9a24d5cb5fbf0b632bed4b6d31a4a86c7a89e943a3ae37184f0f4f18281.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Summary information on the Markov chains</span>
<span class="k">with</span> <span class="n">basic_model</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">az</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace</span><span class="p">))</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hdi_3%</th>
      <th>hdi_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Mean of Data</th>
      <td>10.599</td>
      <td>0.287</td>
      <td>10.072</td>
      <td>11.142</td>
      <td>0.004</td>
      <td>0.003</td>
      <td>4300.0</td>
      <td>4571.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Remember that what we are generating is a posterior for the mean given the data and our (assumed) knowledge of the standard deviation.</p>
<p>So for the summary info we get the mean and standard deviation (sd) of the distribution, with an estimate of the Monte Carlo error. What does hpd stand for?  “Highest posterior density”  2.5 and 97.5 are percentages, so one talks of a 95% hpd interval in this case.</p>
<p>From an answer online: “You create the parameter trace plots to make sure that your a priori distribution is well calibrated which is indicated by your parameters having sufficient state changes as the MCMC algorithm runs.”</p>
<p>“All the results are contained in the trace variable. This is a pymc results object. It contains some information that we might want to extract at times. Note that this data structure changed between pymc3 and pymc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">basic_model</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
            <div>
              <div class='xr-header'>
                <div class="xr-obj-type">arviz.InferenceData</div>
              </div>
              <ul class="xr-sections group-sections">
              
            <li class = "xr-section-item">
                  <input id="idata_posteriorf6ca5fc2-9835-4093-ba4d-ddbcb4e28e76" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_posteriorf6ca5fc2-9835-4093-ba4d-ddbcb4e28e76" class = "xr-section-summary">posterior</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:       (chain: 2, draw: 10000)
Coordinates:
  * chain         (chain) int64 0 1
  * draw          (draw) int64 0 1 2 3 4 5 6 ... 9994 9995 9996 9997 9998 9999
Data variables:
    Mean of Data  (chain, draw) float64 10.88 10.92 10.92 ... 10.18 10.18 10.78
Attributes:
    created_at:                 2023-12-05T01:48:37.785763
    arviz_version:              0.16.1
    inference_library:          pymc
    inference_library_version:  5.6.1
    sampling_time:              16.231638193130493
    tuning_steps:               1000</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-74645f05-840e-4dc8-aae6-ddee716857ce' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-74645f05-840e-4dc8-aae6-ddee716857ce' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>chain</span>: 2</li><li><span class='xr-has-index'>draw</span>: 10000</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b5e54920-dc9d-4c87-b676-39fc19928355' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b5e54920-dc9d-4c87-b676-39fc19928355' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>chain</span></div><div class='xr-var-dims'>(chain)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-bd96e5de-62b1-40b5-a658-cefa10ef7814' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bd96e5de-62b1-40b5-a658-cefa10ef7814' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4b3c627b-621f-4e7a-a606-a595f91bbe51' class='xr-var-data-in' type='checkbox'><label for='data-4b3c627b-621f-4e7a-a606-a595f91bbe51' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>draw</span></div><div class='xr-var-dims'>(draw)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 ... 9996 9997 9998 9999</div><input id='attrs-208e280c-8c16-4027-b42a-b4f318397aa6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-208e280c-8c16-4027-b42a-b4f318397aa6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-99c904df-1a86-4f22-b630-1fc82f988612' class='xr-var-data-in' type='checkbox'><label for='data-99c904df-1a86-4f22-b630-1fc82f988612' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   0,    1,    2, ..., 9997, 9998, 9999])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1124fee6-14d8-40e5-b399-2486d385c71f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1124fee6-14d8-40e5-b399-2486d385c71f' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Mean of Data</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>10.88 10.92 10.92 ... 10.18 10.78</div><input id='attrs-f0d09648-b38b-464a-b3f4-ac0f0d5ecb04' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f0d09648-b38b-464a-b3f4-ac0f0d5ecb04' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bcb6c2ca-6a2a-4be1-9db9-c65cfb6a896f' class='xr-var-data-in' type='checkbox'><label for='data-bcb6c2ca-6a2a-4be1-9db9-c65cfb6a896f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[10.88124886, 10.91942995, 10.91942995, ..., 10.46022048,
        10.72147661, 10.48548261],
       [10.45766225, 10.25142058, 10.25142058, ..., 10.1791021 ,
        10.1791021 , 10.78392081]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-51478308-2e95-41ea-ab0b-193634a8ac0a' class='xr-section-summary-in' type='checkbox'  ><label for='section-51478308-2e95-41ea-ab0b-193634a8ac0a' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>chain</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-5e1ca5e4-325c-4633-b608-7cc8b744abf8' class='xr-index-data-in' type='checkbox'/><label for='index-5e1ca5e4-325c-4633-b608-7cc8b744abf8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;chain&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>draw</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6f1c09ca-cef2-4cec-bf34-ff7b239df538' class='xr-index-data-in' type='checkbox'/><label for='index-6f1c09ca-cef2-4cec-bf34-ff7b239df538' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,
       ...
       9990, 9991, 9992, 9993, 9994, 9995, 9996, 9997, 9998, 9999],
      dtype=&#x27;int64&#x27;, name=&#x27;draw&#x27;, length=10000))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c1282604-6a75-4b85-9b21-837c25b00076' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c1282604-6a75-4b85-9b21-837c25b00076' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>created_at :</span></dt><dd>2023-12-05T01:48:37.785763</dd><dt><span>arviz_version :</span></dt><dd>0.16.1</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.6.1</dd><dt><span>sampling_time :</span></dt><dd>16.231638193130493</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class = "xr-section-item">
                  <input id="idata_sample_statsf1b3ff4d-a60c-48cf-845b-e65bf732775b" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_sample_statsf1b3ff4d-a60c-48cf-845b-e65bf732775b" class = "xr-section-summary">sample_stats</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:   (chain: 2, draw: 10000)
Coordinates:
  * chain     (chain) int64 0 1
  * draw      (draw) int64 0 1 2 3 4 5 6 ... 9993 9994 9995 9996 9997 9998 9999
Data variables:
    accept    (chain, draw) float64 1.148 0.8764 0.02083 ... 2.687e-07 2.31
    scaling   (chain, draw) float64 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0
    accepted  (chain, draw) float64 1.0 1.0 0.0 1.0 1.0 ... 1.0 1.0 1.0 0.0 1.0
Attributes:
    created_at:                 2023-12-05T01:48:37.791571
    arviz_version:              0.16.1
    inference_library:          pymc
    inference_library_version:  5.6.1
    sampling_time:              16.231638193130493
    tuning_steps:               1000</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a6a0e49d-25b8-4469-9c3c-835fbdf612f6' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a6a0e49d-25b8-4469-9c3c-835fbdf612f6' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>chain</span>: 2</li><li><span class='xr-has-index'>draw</span>: 10000</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5dcf8329-08cb-4db6-ab48-b53f1b5ad215' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5dcf8329-08cb-4db6-ab48-b53f1b5ad215' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>chain</span></div><div class='xr-var-dims'>(chain)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-271ecaa3-16d0-46ef-8b0b-4b7911e2933b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-271ecaa3-16d0-46ef-8b0b-4b7911e2933b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b1a18c31-7e4d-42be-9fe6-22e2c27919e4' class='xr-var-data-in' type='checkbox'><label for='data-b1a18c31-7e4d-42be-9fe6-22e2c27919e4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>draw</span></div><div class='xr-var-dims'>(draw)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 ... 9996 9997 9998 9999</div><input id='attrs-db7e9208-1233-4288-9c90-37375c875b6d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-db7e9208-1233-4288-9c90-37375c875b6d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2369f58e-8a39-4e73-92d3-2187f9f890ad' class='xr-var-data-in' type='checkbox'><label for='data-2369f58e-8a39-4e73-92d3-2187f9f890ad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   0,    1,    2, ..., 9997, 9998, 9999])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a76e5974-4392-471a-b2ab-bbe90525147f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a76e5974-4392-471a-b2ab-bbe90525147f' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>accept</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.148 0.8764 ... 2.687e-07 2.31</div><input id='attrs-4c029a92-f82e-462c-b712-df494bc0cc6e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4c029a92-f82e-462c-b712-df494bc0cc6e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-30be27fa-9fa5-40de-a72d-523518cf3189' class='xr-var-data-in' type='checkbox'><label for='data-30be27fa-9fa5-40de-a72d-523518cf3189' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.14765436e+00, 8.76395786e-01, 2.08272562e-02, ...,
        2.07706399e-08, 1.03205440e+00, 1.00596263e+00],
       [9.96031280e-01, 5.55390790e-01, 3.37033638e-01, ...,
        4.13984289e-01, 2.68675356e-07, 2.30989356e+00]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>scaling</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0</div><input id='attrs-c59b92c1-5991-4737-81e8-4b10a3278c93' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c59b92c1-5991-4737-81e8-4b10a3278c93' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5c7d752b-2814-4f6c-9546-034d5e6b2890' class='xr-var-data-in' type='checkbox'><label for='data-5c7d752b-2814-4f6c-9546-034d5e6b2890' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1., 1., 1., ..., 1., 1., 1.],
       [1., 1., 1., ..., 1., 1., 1.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>accepted</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 1.0 0.0 1.0 ... 1.0 1.0 0.0 1.0</div><input id='attrs-0647b204-1cbb-4821-abde-d701f7dd2514' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0647b204-1cbb-4821-abde-d701f7dd2514' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-35cb0ee9-018f-49c5-b70f-e3e378205cb3' class='xr-var-data-in' type='checkbox'><label for='data-35cb0ee9-018f-49c5-b70f-e3e378205cb3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1., 1., 0., ..., 0., 1., 1.],
       [1., 1., 0., ..., 1., 0., 1.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-37039d73-b59c-4de1-b527-fe6ea8d01827' class='xr-section-summary-in' type='checkbox'  ><label for='section-37039d73-b59c-4de1-b527-fe6ea8d01827' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>chain</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-20fe4983-5a3f-4f12-8cdb-295a4a61befa' class='xr-index-data-in' type='checkbox'/><label for='index-20fe4983-5a3f-4f12-8cdb-295a4a61befa' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;chain&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>draw</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-69da44ac-0642-4353-8624-5551b1879a65' class='xr-index-data-in' type='checkbox'/><label for='index-69da44ac-0642-4353-8624-5551b1879a65' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,
       ...
       9990, 9991, 9992, 9993, 9994, 9995, 9996, 9997, 9998, 9999],
      dtype=&#x27;int64&#x27;, name=&#x27;draw&#x27;, length=10000))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-08e182c7-48e8-4cb4-9a69-cc25d1765ae8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-08e182c7-48e8-4cb4-9a69-cc25d1765ae8' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>created_at :</span></dt><dd>2023-12-05T01:48:37.791571</dd><dt><span>arviz_version :</span></dt><dd>0.16.1</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.6.1</dd><dt><span>sampling_time :</span></dt><dd>16.231638193130493</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
            <li class = "xr-section-item">
                  <input id="idata_observed_data360917a6-6e4f-4158-b5e0-a46d7db2cba0" class="xr-section-summary-in" type="checkbox">
                  <label for="idata_observed_data360917a6-6e4f-4158-b5e0-a46d7db2cba0" class = "xr-section-summary">observed_data</label>
                  <div class="xr-section-inline-details"></div>
                  <div class="xr-section-details">
                      <ul id="xr-dataset-coord-list" class="xr-var-list">
                          <div style="padding-left:2rem;"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (Y_obs_dim_0: 100)
Coordinates:
  * Y_obs_dim_0  (Y_obs_dim_0) int64 0 1 2 3 4 5 6 7 ... 92 93 94 95 96 97 98 99
Data variables:
    Y_obs        (Y_obs_dim_0) float64 11.96 6.825 12.11 ... 14.32 16.44 15.95
Attributes:
    created_at:                 2023-12-05T01:48:37.795912
    arviz_version:              0.16.1
    inference_library:          pymc
    inference_library_version:  5.6.1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-fe46cb18-7390-49e4-8a7e-21b61f2d876a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fe46cb18-7390-49e4-8a7e-21b61f2d876a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>Y_obs_dim_0</span>: 100</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-12cf8a79-dca9-40a9-9974-673e29bbac63' class='xr-section-summary-in' type='checkbox'  checked><label for='section-12cf8a79-dca9-40a9-9974-673e29bbac63' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Y_obs_dim_0</span></div><div class='xr-var-dims'>(Y_obs_dim_0)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 94 95 96 97 98 99</div><input id='attrs-be0b49fc-19c3-4f0a-b42d-6cf4f2bc2bba' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-be0b49fc-19c3-4f0a-b42d-6cf4f2bc2bba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c69aa904-583e-480a-aed6-69b13b65feed' class='xr-var-data-in' type='checkbox'><label for='data-c69aa904-583e-480a-aed6-69b13b65feed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
       90, 91, 92, 93, 94, 95, 96, 97, 98, 99])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-abddbe91-69f2-4c87-84d2-1b7376045104' class='xr-section-summary-in' type='checkbox'  checked><label for='section-abddbe91-69f2-4c87-84d2-1b7376045104' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>Y_obs</span></div><div class='xr-var-dims'>(Y_obs_dim_0)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>11.96 6.825 12.11 ... 16.44 15.95</div><input id='attrs-94eaa484-eef0-482a-9909-222501f37deb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-94eaa484-eef0-482a-9909-222501f37deb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3241ff75-719d-4d8b-8010-1f4dae60b814' class='xr-var-data-in' type='checkbox'><label for='data-3241ff75-719d-4d8b-8010-1f4dae60b814' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([11.9606275 ,  6.82515325, 12.11371113, 13.62396907, 14.48617515,
        8.86492079, 14.29179152, 11.70072943,  9.94361784,  9.21327859,
       13.11884239, 10.92847702, 10.04318608, 11.63206815, 13.96405102,
        9.83592791, 10.42523225,  8.93653103, 12.01441423, 13.01062495,
       11.28497418,  8.33406992,  6.73340498,  8.03619822, 11.03213041,
       10.54566972, 12.18874669, 11.60289068, 10.21818827,  6.64723729,
        8.78596716, 13.4570507 ,  9.78870004, 12.80351594,  9.43756485,
        9.72252506,  7.07353222, 10.47902809,  5.35770481,  9.75017819,
       10.37532901, 12.40725205, 15.77949756, 12.82569263,  6.75684921,
       10.96170056, 12.41448234, 10.93391247, 13.14721662, 10.6589825 ,
        4.91047906, 17.21997454, 11.50465029, 11.22263676, 12.8879201 ,
       17.08797582, 10.48277692,  9.92688274,  7.56947113, 10.2140631 ,
        7.25110327, 12.14960556,  6.78100235,  9.58936615,  7.90292693,
       13.69950323, 10.26728489,  8.38859876,  9.46410507, 10.44614315,
       13.79464964,  5.21259045, 12.55186217,  9.05131219,  7.88309638,
       10.64603278, 12.05126517, 13.29161235,  9.10981379,  5.90031518,
        7.68821811,  9.28015681, 13.59565694, 10.54322194,  9.17467038,
       10.92564621,  5.55781391,  8.51301322, 17.23401033,  9.68970117,
       11.17826693,  9.64492744, 13.79085928, 10.1742385 , 14.91100352,
        9.20134899,  7.78711118, 14.32164215, 16.43842534, 15.95268655])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-314f104b-b9b5-47f1-a44c-6f43f8ee8d6f' class='xr-section-summary-in' type='checkbox'  ><label for='section-314f104b-b9b5-47f1-a44c-6f43f8ee8d6f' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>Y_obs_dim_0</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7de37ed2-cb46-4e72-9639-a56d9a648c00' class='xr-index-data-in' type='checkbox'/><label for='index-7de37ed2-cb46-4e72-9639-a56d9a648c00' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
       90, 91, 92, 93, 94, 95, 96, 97, 98, 99],
      dtype=&#x27;int64&#x27;, name=&#x27;Y_obs_dim_0&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-29390341-2ec7-4093-8c1c-eceedff5a848' class='xr-section-summary-in' type='checkbox'  checked><label for='section-29390341-2ec7-4093-8c1c-eceedff5a848' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>created_at :</span></dt><dd>2023-12-05T01:48:37.795912</dd><dt><span>arviz_version :</span></dt><dd>0.16.1</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.6.1</dd></dl></div></li></ul></div></div><br></div>
                      </ul>
                  </div>
            </li>
            
              </ul>
            </div>
            <style> /* CSS stylesheet for displaying InferenceData objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-sections.group-sections {
  grid-template-columns: auto;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt, dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
.xr-wrap{width:700px!important;} </style></div></div>
</div>
<p>This was set up when we initiated our model (in specifying the prior for mu).  With the variable names, we can extract chain values for each variable using trace.posterior[‘<Varname>’].</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trace</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;Mean of Data&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;Mean of Data&#x27; (chain: 2, draw: 10000)&gt;
array([[10.88124886, 10.91942995, 10.91942995, ..., 10.46022048,
        10.72147661, 10.48548261],
       [10.45766225, 10.25142058, 10.25142058, ..., 10.1791021 ,
        10.1791021 , 10.78392081]])
Coordinates:
  * chain    (chain) int64 0 1
  * draw     (draw) int64 0 1 2 3 4 5 6 7 ... 9993 9994 9995 9996 9997 9998 9999</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'Mean of Data'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>chain</span>: 2</li><li><span class='xr-has-index'>draw</span>: 10000</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e03198e3-343e-4ff3-9e44-c93cd3b9c562' class='xr-array-in' type='checkbox' checked><label for='section-e03198e3-343e-4ff3-9e44-c93cd3b9c562' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>10.88 10.92 10.92 10.69 10.42 10.62 ... 10.71 10.44 10.18 10.18 10.78</span></div><div class='xr-array-data'><pre>array([[10.88124886, 10.91942995, 10.91942995, ..., 10.46022048,
        10.72147661, 10.48548261],
       [10.45766225, 10.25142058, 10.25142058, ..., 10.1791021 ,
        10.1791021 , 10.78392081]])</pre></div></div></li><li class='xr-section-item'><input id='section-a5d8fe99-9e1f-4a6f-b439-d3ce72d6ee2f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a5d8fe99-9e1f-4a6f-b439-d3ce72d6ee2f' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>chain</span></div><div class='xr-var-dims'>(chain)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-8662e6cf-b6de-4306-b7cb-894d3e506a2f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8662e6cf-b6de-4306-b7cb-894d3e506a2f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-79eba54a-8699-491d-b70d-32da183504e2' class='xr-var-data-in' type='checkbox'><label for='data-79eba54a-8699-491d-b70d-32da183504e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>draw</span></div><div class='xr-var-dims'>(draw)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 ... 9996 9997 9998 9999</div><input id='attrs-04e95c5d-c7cf-4a98-a564-435f78a1b09b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-04e95c5d-c7cf-4a98-a564-435f78a1b09b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-51b5411c-b150-44c7-b58e-185d8d0b98b2' class='xr-var-data-in' type='checkbox'><label for='data-51b5411c-b150-44c7-b58e-185d8d0b98b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   0,    1,    2, ..., 9997, 9998, 9999])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1de81434-e362-4a59-b2f0-9bbdd560458c' class='xr-section-summary-in' type='checkbox'  ><label for='section-1de81434-e362-4a59-b2f0-9bbdd560458c' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>chain</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a0cd5b9c-b622-4da8-843e-3af671926bb0' class='xr-index-data-in' type='checkbox'/><label for='index-a0cd5b9c-b622-4da8-843e-3af671926bb0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;chain&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>draw</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-26469dca-7bb4-4b43-9695-db52993b3163' class='xr-index-data-in' type='checkbox'/><label for='index-26469dca-7bb4-4b43-9695-db52993b3163' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,
       ...
       9990, 9991, 9992, 9993, 9994, 9995, 9996, 9997, 9998, 9999],
      dtype=&#x27;int64&#x27;, name=&#x27;draw&#x27;, length=10000))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-66daaffb-2457-43ef-ace0-8c4bd6cf3c81' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-66daaffb-2457-43ef-ace0-8c4bd6cf3c81' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Is this one chain or both chains?  Check the length!  Looks like both.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;Mean of Data&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;Mean of Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
(2, 10000)
</pre></div>
</div>
</div>
</div>
<p>Now for diagnostics.</p>
</section>
<section id="autocorrelation-plots">
<h3>Autocorrelation plots<a class="headerlink" href="#autocorrelation-plots" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">basic_model</span><span class="p">:</span>
    <span class="n">az</span><span class="o">.</span><span class="n">plot_autocorr</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/98ec9a977afc9d14480d4a829d3239e6bf25f733a68711a2aeeb72de1e2b623a.png" src="../../_images/98ec9a977afc9d14480d4a829d3239e6bf25f733a68711a2aeeb72de1e2b623a.png" />
</div>
</div>
<p>What do we see here?  An autocorrelation time around 10 or so.</p>
</section>
<section id="acceptance-rate">
<h3>Acceptance rate<a class="headerlink" href="#acceptance-rate" title="Permalink to this heading">#</a></h3>
<p>First we have to flatten the samples to make it easier to compute the acceptance rate. But we can only flatten after we have converted to a  regular array from a “Dataarray”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">samples</span><span class="o">=</span><span class="n">trace</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;Mean of Data&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">accept</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">samples</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">accept</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Acceptance Rate: &quot;</span><span class="p">,</span> <span class="n">accept</span><span class="o">/</span><span class="n">samples</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6712
Acceptance Rate:  0.3356
</pre></div>
</div>
</div>
</div>
<p>That looks like we have to work harder than one might have expected.  It is taking the array of results and comparing each point to the previous one and including it in the sum if it is different.  So if there wasn’t an acceptance, then the point remains the same.  The ratio to the full length is the acceptance rate.  Maybe we should define a function here instead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">acceptance_rate</span><span class="p">(</span><span class="n">trace_array</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate how many times the entry in the trace array changed compared</span>
<span class="sd">       to the total length.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">changed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">trace_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">trace_array</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">total_length</span> <span class="o">=</span> <span class="n">trace_array</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">changed</span> <span class="o">/</span> <span class="n">total_length</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acceptance_rate</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3356
</pre></div>
</div>
</div>
</div>
</section>
<section id="inferencedata-object">
<h3>InferenceData object<a class="headerlink" href="#inferencedata-object" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters for the prior on mu</span>
<span class="n">mu_prior</span> <span class="o">=</span> <span class="mf">8.</span>
<span class="n">sigma_prior</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># Note this is our prior on the std of mu</span>

<span class="c1"># Could do this instead as:</span>
<span class="c1">#   basic_model = pm3.Model()</span>
<span class="c1">#   with basic_model:</span>

<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">basic_model_alt</span><span class="p">:</span>  

    <span class="c1"># Prior for unknown model parameters (mean and sd of the normal pdf)</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;Mean of Data&#39;</span><span class="p">,</span> <span class="n">mu_prior</span><span class="p">,</span> <span class="n">sigma_prior</span><span class="p">)</span>
    
    <span class="c1"># Likelihood (sampling distribution) of observations</span>
    <span class="n">data_in</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;Y_obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chain_length</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="k">with</span> <span class="n">basic_model_alt</span><span class="p">:</span>
    <span class="c1"># obtain starting values via MAP (maximum a posteriori)</span>
    <span class="n">startvals</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">find_MAP</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">basic_model</span><span class="p">)</span>  <span class="c1"># model here is optional</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">startvals</span><span class="p">)</span>
    
    <span class="c1"># instantiate sampler</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Metropolis</span><span class="p">()</span>   <span class="c1"># Metropolis-Hastings</span>

    <span class="c1"># draw 10000 posterior samples for each chain (4 chains by default?)</span>
    <span class="n">trace_inferencedata</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">draws</span><span class="o">=</span><span class="n">chain_length</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">startvals</span><span class="p">,</span> 
                                    <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00&lt;00:00 logp = -285.09, ||grad|| = 30.059]
    </div>
    </div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Mean of Data&#39;: array(10.60129962)}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/hx/5v7xk5xj21xgghnqjznp90100000gt/T/ipykernel_39165/1454651347.py:12: FutureWarning: The `start` kwarg was renamed to `initvals` and can now do more. Please check the docstring.
  trace_inferencedata = pm.sample(draws=chain_length, step=step, start=startvals,
Multiprocess sampling (2 chains in 2 jobs)
Metropolis: [Mean of Data]
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='22000' class='' max='22000' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [22000/22000 00:04&lt;00:00 Sampling 2 chains, 0 divergences]
    </div>
    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 2 chains for 1_000 tune and 10_000 draw iterations (2_000 + 20_000 draws total) took 18 seconds.
We recommend running at least 4 chains for robust computation of convergence diagnostics
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">basic_model_alt</span><span class="p">:</span>
    <span class="n">display</span><span class="p">(</span><span class="n">trace_inferencedata</span><span class="o">.</span><span class="n">sample_stats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:   (chain: 2, draw: 10000)
Coordinates:
  * chain     (chain) int64 0 1
  * draw      (draw) int64 0 1 2 3 4 5 6 ... 9993 9994 9995 9996 9997 9998 9999
Data variables:
    accept    (chain, draw) float64 0.1032 0.8638 1.113 ... 0.5767 2.57 0.146
    scaling   (chain, draw) float64 1.0 1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0 1.0
    accepted  (chain, draw) float64 0.0 0.0 1.0 1.0 0.0 ... 1.0 1.0 1.0 1.0 0.0
Attributes:
    created_at:                 2023-12-05T01:55:44.506257
    arviz_version:              0.16.1
    inference_library:          pymc
    inference_library_version:  5.6.1
    sampling_time:              17.62691307067871
    tuning_steps:               1000</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-024d3b13-78ff-4ca3-a929-47a0741e099d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-024d3b13-78ff-4ca3-a929-47a0741e099d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>chain</span>: 2</li><li><span class='xr-has-index'>draw</span>: 10000</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-c9d2c619-8a7c-4b04-9467-399c94ee0fea' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c9d2c619-8a7c-4b04-9467-399c94ee0fea' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>chain</span></div><div class='xr-var-dims'>(chain)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-9e1c5b4e-ac21-4350-afdf-c5014d3909b6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9e1c5b4e-ac21-4350-afdf-c5014d3909b6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d83d165e-5ab8-4ecd-831f-45928a749734' class='xr-var-data-in' type='checkbox'><label for='data-d83d165e-5ab8-4ecd-831f-45928a749734' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>draw</span></div><div class='xr-var-dims'>(draw)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 ... 9996 9997 9998 9999</div><input id='attrs-0cad6f02-b765-44f8-8806-78a5a91ac885' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0cad6f02-b765-44f8-8806-78a5a91ac885' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9f8dbb85-3f4c-418c-b534-824a46a9b9af' class='xr-var-data-in' type='checkbox'><label for='data-9f8dbb85-3f4c-418c-b534-824a46a9b9af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([   0,    1,    2, ..., 9997, 9998, 9999])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8ea25b20-20a1-449b-a0e6-5b6d0e667caa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8ea25b20-20a1-449b-a0e6-5b6d0e667caa' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>accept</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.1032 0.8638 1.113 ... 2.57 0.146</div><input id='attrs-318d5460-248f-4a87-8656-19eb40daf4fc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-318d5460-248f-4a87-8656-19eb40daf4fc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d079b3bf-10ec-45da-8aa2-a046fe23348a' class='xr-var-data-in' type='checkbox'><label for='data-d079b3bf-10ec-45da-8aa2-a046fe23348a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1.03176278e-01, 8.63817387e-01, 1.11313477e+00, ...,
        1.31579606e+00, 5.13341912e-20, 1.39113281e-21],
       [2.17335788e+00, 2.24968966e-04, 2.94942428e-02, ...,
        5.76670073e-01, 2.57008684e+00, 1.46019349e-01]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>scaling</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0</div><input id='attrs-9157be01-e126-41fa-9580-132e5b09489d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9157be01-e126-41fa-9580-132e5b09489d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-767c1f81-420b-4b34-b48c-0fcc3e17cd03' class='xr-var-data-in' type='checkbox'><label for='data-767c1f81-420b-4b34-b48c-0fcc3e17cd03' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[1., 1., 1., ..., 1., 1., 1.],
       [1., 1., 1., ..., 1., 1., 1.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>accepted</span></div><div class='xr-var-dims'>(chain, draw)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 1.0 1.0 ... 1.0 1.0 1.0 0.0</div><input id='attrs-643ba3ef-3715-4812-bd23-ea1f1752aff7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-643ba3ef-3715-4812-bd23-ea1f1752aff7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6ffa42a5-1e41-4db4-aa0c-37e8d816e942' class='xr-var-data-in' type='checkbox'><label for='data-6ffa42a5-1e41-4db4-aa0c-37e8d816e942' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[0., 0., 1., ..., 1., 0., 0.],
       [1., 0., 0., ..., 1., 1., 0.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1d35cf07-c862-4b04-ad11-454ac3d1d52d' class='xr-section-summary-in' type='checkbox'  ><label for='section-1d35cf07-c862-4b04-ad11-454ac3d1d52d' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>chain</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c5c8a0e7-ced7-4424-833a-2286893bef4d' class='xr-index-data-in' type='checkbox'/><label for='index-c5c8a0e7-ced7-4424-833a-2286893bef4d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;chain&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>draw</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0e5604cc-23ea-4d93-8fc9-84f2d4abf1d5' class='xr-index-data-in' type='checkbox'/><label for='index-0e5604cc-23ea-4d93-8fc9-84f2d4abf1d5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,
       ...
       9990, 9991, 9992, 9993, 9994, 9995, 9996, 9997, 9998, 9999],
      dtype=&#x27;int64&#x27;, name=&#x27;draw&#x27;, length=10000))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-050348d7-2e04-4e92-bd0e-4ce527b90710' class='xr-section-summary-in' type='checkbox'  checked><label for='section-050348d7-2e04-4e92-bd0e-4ce527b90710' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>created_at :</span></dt><dd>2023-12-05T01:55:44.506257</dd><dt><span>arviz_version :</span></dt><dd>0.16.1</dd><dt><span>inference_library :</span></dt><dd>pymc</dd><dt><span>inference_library_version :</span></dt><dd>5.6.1</dd><dt><span>sampling_time :</span></dt><dd>17.62691307067871</dd><dt><span>tuning_steps :</span></dt><dd>1000</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="gelman-rubin-diagnostic-quoted-verbatim-from-the-hicks-notebook">
<h3>Gelman Rubin Diagnostic (quoted verbatim from the Hicks notebook)<a class="headerlink" href="#gelman-rubin-diagnostic-quoted-verbatim-from-the-hicks-notebook" title="Permalink to this heading">#</a></h3>
<p>If our MH MCMC Chain reaches a stationary distribution, and we repeat the excercise multiple times, then we can examine if the posterior for each chain converges to the same place in the distribution of the parameter space.</p>
<p>Steps:</p>
<ol class="arabic simple">
<li><p>Run <span class="math notranslate nohighlight">\(M&gt;1\)</span> Chains of length <span class="math notranslate nohighlight">\(2 \times N\)</span>.</p></li>
<li><p>Discard the first <span class="math notranslate nohighlight">\(N\)</span> draws of each chain, leaving <span class="math notranslate nohighlight">\(N\)</span> iterations in the chain.</p></li>
<li><p>Calculate the within and between chain variance.</p>
<ul class="simple">
<li><p>Within chain variance:
<span class="math notranslate nohighlight">\(W = \frac{1}{M}\sum_{j=1}^M s_j^2 \)</span>
where <span class="math notranslate nohighlight">\(s_j^2\)</span> is the variance of each chain (after throwing out the first <span class="math notranslate nohighlight">\(N\)</span> draws).</p></li>
<li><p>Between chain variance:
<span class="math notranslate nohighlight">\(B = \frac{N}{M-1} \sum_{j=1}^M (\bar{\theta_j} - \bar{\bar{\theta}})^2\)</span>
where <span class="math notranslate nohighlight">\(\bar{\bar{\theta}}\)</span> is the mean of each of the M means.</p></li>
</ul>
</li>
<li><p>Calculate the estimated variance of <span class="math notranslate nohighlight">\(\theta\)</span> as the weighted sum of between and within chain variance.
<span class="math notranslate nohighlight">\(\hat{var}(\theta) = \left ( 1 - \frac{1}{N}\right ) W + \frac{1}{N}B\)</span></p></li>
<li><p>Calculate the potential scale reduction factor.
<span class="math notranslate nohighlight">\(\hat{R} = \sqrt{\frac{\hat{var}(\theta)}{W}}\)</span></p></li>
</ol>
<p>We want this number to be close to 1.  Why?  This would indicate that the between chain variance is small.  This makes sense, if between chain variance is small, that means both chains are mixing around the stationary distribution.  Gelmen and Rubin show that when <span class="math notranslate nohighlight">\(\hat{R}\)</span> is greater than 1.1 or 1.2, we need longer burn-in.</p>
<p>Trying without <code class="docutils literal notranslate"><span class="pre">find_MAP</span></code>, i.e., not specifying <code class="docutils literal notranslate"><span class="pre">start</span></code> in <code class="docutils literal notranslate"><span class="pre">pm.sample</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chain_length</span> <span class="o">=</span> <span class="mi">100000</span> 

<span class="k">with</span> <span class="n">basic_model</span><span class="p">:</span>
    <span class="c1"># obtain starting values via MAP</span>
    <span class="c1">#startvals = pm.find_MAP(model=basic_model)</span>
    <span class="c1">#print(startvals)</span>
    <span class="c1"># instantiate sampler</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Metropolis</span><span class="p">()</span> 

    <span class="c1"># draw 5000 posterior samples</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">chain_length</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multiprocess sampling (2 chains in 2 jobs)
Metropolis: [Mean of Data]
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='202000' class='' max='202000' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [202000/202000 00:32&lt;00:00 Sampling 2 chains, 0 divergences]
    </div>
    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 2 chains for 1_000 tune and 100_000 draw iterations (2_000 + 200_000 draws total) took 43 seconds.
We recommend running at least 4 chains for robust computation of convergence diagnostics
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the two chains</span>
<span class="k">with</span> <span class="n">basic_model</span><span class="p">:</span>
    <span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5cccdd8947b38553ffcf9a909ef72b65b5507b3ccd1285bcac3bfb07771c4f32.png" src="../../_images/5cccdd8947b38553ffcf9a909ef72b65b5507b3ccd1285bcac3bfb07771c4f32.png" />
</div>
</div>
<p>“The diagnostics we have discussed are all univariate (they work perfectly when there is only 1 parameter to estimate). Other diagnostics have been derived for the multivariate case, but these are useful only when using Gibbs Samplers or other specialized versions of Metropolis-Hastings.</p>
<p>So most people examine univariate diagnostics for each variable, examine autocorrelation plots, acceptance rates and try to argue chain convergence based on that- unless they are using Gibbs or other specialized samplers.”</p>
</section>
<section id="in-class-exercise">
<h3>In-class exercise<a class="headerlink" href="#in-class-exercise" title="Permalink to this heading">#</a></h3>
<p>Let’s try to modify the code below to estimate sigma as well as the mean (first three cells are original code, copied from above):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.</span>  <span class="c1"># standard deviation</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">10.</span>    <span class="c1"># mean</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># 10**6</span>

<span class="c1"># sample from a normal distribution</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>  


<span class="c1"># plot a histogram of the sampled data</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e8f7d6dfde6b46f8d1b6f83d76921edd50fc79d4b230688269f6c6ec79db5e30.png" src="../../_images/e8f7d6dfde6b46f8d1b6f83d76921edd50fc79d4b230688269f6c6ec79db5e30.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters for the prior on mu</span>
<span class="n">mu_mean_prior</span> <span class="o">=</span> <span class="mf">8.</span>
<span class="n">mu_sd_prior</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># Note this is our prior on the std of mu</span>

<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">basic_model</span><span class="p">:</span>

    <span class="c1"># Priors for unknown model parameters</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;Mean of Data&#39;</span><span class="p">,</span> <span class="n">mu_mean_prior</span><span class="p">,</span> <span class="n">mu_sd_prior</span><span class="p">)</span>
    
    <span class="c1"># Likelihood (sampling distribution) of observations</span>
    <span class="n">data_in</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;Y_obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chain_length</span> <span class="o">=</span> <span class="mi">10000</span> 

<span class="k">with</span> <span class="n">basic_model</span><span class="p">:</span>
    <span class="c1"># obtain starting values via MAP</span>
    <span class="n">startvals</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">find_MAP</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">basic_model</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">startvals</span><span class="p">)</span>
    <span class="c1"># instantiate sampler</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Metropolis</span><span class="p">()</span> 

    <span class="c1"># draw 10000 posterior samples</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">chain_length</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">startvals</span><span class="p">,</span>
                      <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='3' class='' max='3' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [3/3 00:00&lt;00:00 logp = -284.33, ||grad|| = 25.851]
    </div>
    </div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Mean of Data&#39;: array(10.23709794)}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/hx/5v7xk5xj21xgghnqjznp90100000gt/T/ipykernel_39165/1249115293.py:11: FutureWarning: The `start` kwarg was renamed to `initvals` and can now do more. Please check the docstring.
  trace = pm.sample(chain_length, step=step, start=startvals,
Multiprocess sampling (2 chains in 2 jobs)
Metropolis: [Mean of Data]
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='22000' class='' max='22000' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [22000/22000 00:04&lt;00:00 Sampling 2 chains, 0 divergences]
    </div>
    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 2 chains for 1_000 tune and 10_000 draw iterations (2_000 + 20_000 draws total) took 15 seconds.
We recommend running at least 4 chains for robust computation of convergence diagnostics
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NOTE: currently there is an issue with geweke. Try again in the future.</span>
<span class="c1"># score=pm.geweke(trace, first=0.1, last=0.5, intervals=20)</span>
<span class="c1"># plt.scatter(score[0][&#39;Mean of Data&#39;][:,0],score[0][&#39;Mean of Data&#39;][:,1], </span>
<span class="c1">#             marker = &#39;o&#39;, s=100)</span>
<span class="c1"># plt.axhline(-1.98, c=&#39;r&#39;)</span>
<span class="c1"># plt.axhline(1.98, c=&#39;r&#39;)</span>
<span class="c1"># plt.ylim(-2.5,2.5)</span>
<span class="c1"># plt.xlim(0-10,.5*trace[&#39;Mean of Data&#39;].shape[0]/2+10)</span>
<span class="c1"># my_title = &#39;Geweke Plot Comparing first 10% and Slices of the Last 50%&#39; +\</span>
<span class="c1">#            &#39; of Chain\nDifference in Mean Z score&#39;</span>
<span class="c1"># plt.title(my_title)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
<p>Ok, we’re trying it! (New code starts here.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">3.</span>  <span class="c1"># standard deviation</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">10.</span>    <span class="c1"># mean</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># 100 # 10**6</span>

<span class="c1"># sample from a normal distribution</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>  


<span class="c1"># plot a histogram of the sampled data</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">num_bins</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/87d012aa581cb341da0a117df1f4c9bd9d5750ae5f4e2617e0889f265f8e3606.png" src="../../_images/87d012aa581cb341da0a117df1f4c9bd9d5750ae5f4e2617e0889f265f8e3606.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># parameters for the prior on mu</span>
<span class="n">mu_mean_prior</span> <span class="o">=</span> <span class="mf">8.</span>
<span class="n">mu_sd_prior</span> <span class="o">=</span> <span class="mf">1.5</span>  <span class="c1"># Note this is our prior on the std of mu</span>

<span class="n">sigma_mean_prior</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">sigma_sd_prior</span> <span class="o">=</span> <span class="mf">1.</span>

<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">two_param_model</span><span class="p">:</span>

    <span class="c1"># Priors for unknown model parameters</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;Mean of Data&#39;</span><span class="p">,</span> <span class="n">mu_mean_prior</span><span class="p">,</span> <span class="n">mu_sd_prior</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;SD of Data&#39;</span><span class="p">,</span> <span class="n">sigma_mean_prior</span><span class="p">,</span> <span class="n">sigma_sd_prior</span><span class="p">)</span>
    
    <span class="c1"># Likelihood (sampling distribution) of observations</span>
    <span class="n">data_in</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s1">&#39;Y_obs&#39;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chain_length</span> <span class="o">=</span> <span class="mi">10000</span> 

<span class="k">with</span> <span class="n">two_param_model</span><span class="p">:</span>
    <span class="c1"># obtain starting values via MAP</span>
    <span class="n">startvals</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">find_MAP</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">two_param_model</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">startvals</span><span class="p">)</span>
    <span class="c1"># instantiate sampler</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Metropolis</span><span class="p">()</span> 

    <span class="c1"># draw 10000 posterior samples</span>
    <span class="n">trace_two_param</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">chain_length</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">startvals</span><span class="p">,</span>
                                <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='13' class='' max='13' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [13/13 00:00&lt;00:00 logp = -2,529.3, ||grad|| = 0.052102]
    </div>
    </div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Mean of Data&#39;: array(10.14426089), &#39;SD of Data&#39;: array(3.01034701)}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/hx/5v7xk5xj21xgghnqjznp90100000gt/T/ipykernel_39165/2453781259.py:11: FutureWarning: The `start` kwarg was renamed to `initvals` and can now do more. Please check the docstring.
  trace_two_param = pm.sample(chain_length, step=step, start=startvals,
Multiprocess sampling (2 chains in 2 jobs)
CompoundStep
&gt;Metropolis: [Mean of Data]
&gt;Metropolis: [SD of Data]
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
WARNING (pytensor.tensor.blas): Using NumPy C-API based implementation for BLAS functions.
</pre></div>
</div>
<div class="output text_html">
<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div><div class="output text_html">
    <div>
      <progress value='22000' class='' max='22000' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [22000/22000 00:06&lt;00:00 Sampling 2 chains, 0 divergences]
    </div>
    </div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sampling 2 chains for 1_000 tune and 10_000 draw iterations (2_000 + 20_000 draws total) took 15 seconds.
We recommend running at least 4 chains for robust computation of convergence diagnostics
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">two_param_model</span><span class="p">:</span>
    <span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">trace_two_param</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">5</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/209e840d371952f6e841df4b62a19663429a3fc288b8db1a82704f349be3448e.png" src="../../_images/209e840d371952f6e841df4b62a19663429a3fc288b8db1a82704f349be3448e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NOTE: currently there is an issue with geweke. Try again in the future.</span>
<span class="c1"># score=pm.geweke(trace_two_param, first=0.1, last=0.5, intervals=20)</span>
<span class="c1"># plt.scatter(score[0][&#39;Mean of Data&#39;][:,0],score[0][&#39;Mean of Data&#39;][:,1], </span>
<span class="c1">#             marker = &#39;o&#39;, s=100)</span>
<span class="c1"># plt.axhline(-1.98, c=&#39;r&#39;)</span>
<span class="c1"># plt.axhline(1.98, c=&#39;r&#39;)</span>
<span class="c1"># plt.ylim(-2.5,2.5)</span>
<span class="c1"># plt.xlim(0-10,.5*trace[&#39;Mean of Data&#39;].shape[0]/2+10)</span>
<span class="c1"># my_title = &#39;Geweke Plot Comparing first 10% and Slices of the Last 50%&#39; +\</span>
<span class="c1">#            &#39; of Chain\nDifference in Mean Z score&#39;</span>
<span class="c1"># plt.title(my_title)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NOTE: currently there is an issue with geweke. Try again in the future.</span>
<span class="c1"># score=pm.geweke(trace_two_param, first=0.1, last=0.5, intervals=20)</span>
<span class="c1"># plt.scatter(score[0][&#39;SD of Data&#39;][:,0],score[0][&#39;SD of Data&#39;][:,1], marker = &#39;o&#39;, s=100)</span>
<span class="c1"># plt.axhline(-1.98, c=&#39;r&#39;)</span>
<span class="c1"># plt.axhline(1.98, c=&#39;r&#39;)</span>
<span class="c1"># plt.ylim(-2.5,2.5)</span>
<span class="c1"># #plt.xlim(0-10,.5*trace[&#39;SD of Data&#39;].shape[0]/2+10)</span>
<span class="c1"># plt.title(&#39;Geweke Plot Comparing first 10% and Slices of the Last 50% of Chain\nDifference in SD Z score&#39;)</span>
<span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "buqeye/LearningFromData",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/MCMC_sampling_II"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../../content/MCMC_sampling_II/lecture_18.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6.5. </span>Lecture 18</p>
      </div>
    </a>
    <a class="right-next"
       href="getting_started_with_pymc.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.7. </span>Introductory Overview of PyMC</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-setup-of-a-model">Basic setup of a model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling">Sampling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#available-samplers">Available samplers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analyze-sampling-results">Analyze sampling results</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostics">Diagnostics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples-from-rob-hicks">Examples from Rob Hicks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pymc3-implementation">PyMC3 implementation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#autocorrelation-plots">Autocorrelation plots</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#acceptance-rate">Acceptance rate</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inferencedata-object">InferenceData object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gelman-rubin-diagnostic-quoted-verbatim-from-the-hicks-notebook">Gelman Rubin Diagnostic (quoted verbatim from the Hicks notebook)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#in-class-exercise">In-class exercise</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dick Furnstahl and Daniel Phillips
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>